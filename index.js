import{createRef,useContext,createContext,useState,useEffect,useRef,Fragment,isValidElement}from"react";import $ from"jquery";import AIOPopup from"aio-popup";import Prism from"prismjs";import{Get2Digit,AIODate,GetClient,EventHandler,Swip,DragClass,AddToAttrs,Storage,ExportToExcel,getEventAttrs,svgArc,HasClass,FilePreview,DownloadFile,GetPrecisionCount,GetArray,Validation,GetSvg,JSXToHTML}from"aio-utils";import{divIcon}from"leaflet";import{Circle,LayersControl,MapContainer,Marker,Polyline,Rectangle,TileLayer,useMapEvents}from"react-leaflet";import"leaflet/dist/leaflet.css";import axios from"axios";import"./index.css";import{jsx as _jsx}from"react/jsx-runtime";import{jsxs as _jsxs}from"react/jsx-runtime";import{Fragment as _Fragment}from"react/jsx-runtime";import{createElement as _createElement}from"react";let AICTX=createContext({}),AIOInput=e=>{let t=e.type,n=e.round,i=e.value;if("text"===t?"string"!=typeof i&&(i=""):"number"===t&&"number"!=typeof i&&(i=void 0),"spinner"===t)t="range",n&&"number"==typeof n||(n=1);else if("slider"===t)t="range",n=0;else if("range"===t)return null;let o=new Storage("aio-input-storage").getModel()||{},r={...e,type:t,round:n,value:i,...o};return"text"===t&&r.fetchOptions?_jsx(SuggestionInput,{...r}):_jsx(AIOINPUT,{...r})};export default AIOInput;let SuggestionInput=e=>{let[t,n]=useState([]),[i,o]=useState("");async function r(t){if(o(t),!t){n([]);return}let i=e.fetchOptions?await e.fetchOptions(t):[];n(i)}return _jsx(AIOInput,{...e,value:i,options:t,option:{...e.option,onClick(t){let n=GetOptionProps({rootProps:e,key:"text",optionDetails:t});r(n),e.onChange&&e.onChange(n,t.option)}},fetchOptions:void 0,onChange(t){r(t),e.onChange&&e.onChange(t)}})};function AIOINPUT(e){let[t]=useState(getTypes(e)),[n]=useState(new AIODate),{type:i,value:o,onChange:r,attrs:a={},rtl:l}=e=getDefaultProps(e,t),[u]=useState(createRef()),[s]=useState("aiobutton"+Math.round(1e7*Math.random())),[c]=useState(h),[d,p]=useState();function f(){let{validations:t,lang:n="en",label:i,reportError:r=()=>{}}=e;if(!t)return;let a;a="function"==typeof t?t(o):new Validation({value:o,title:(i||"").replace(/\*/g,""),lang:n,validations:t}).validate(),r(a),p(a)}function h(){if(!t.isDropdown)return!1;let n="aio-input-popover";return n+=` aio-input-popover-${l?"rtl":"ltr"}`,t.hasOption&&(n+=" aio-input-dropdown"),"time"===i&&(n+=" aio-input-time-popover"),t=>{let i={...e.popover||{}},{type:o,multiple:r}=e,{body:a,limitTo:l,header:u,setAttrs:c=()=>({}),position:d="popover"}=i,p=$(t.current),f=-1!==["text","number","textarea"].indexOf(o)||"select"===o&&!!r||!!i.fitHorizontal;return{position:d,fitHorizontal:f,limitTo:l,header:u,onClose:()=>N(!1),body:e=>a?a(e):"date"===o?_jsx(Calendar,{onClose:e.close}):"time"===o?_jsx(TimePopover,{onClose:e.close}):_jsx(Options,{}),pageSelector:".aio-input-backdrop."+s,getTarget:()=>p,setAttrs(e){let t=c(e);return"modal"===e?AddToAttrs(t,{className:n}):"backdrop"===e?AddToAttrs(t,{className:"aio-input-backdrop "+s}):void 0}}}}useEffect(()=>{f()},[e.value]);let[m]=useState(g(AIOPopup));function g(t){return new t({rtl:e.rtl})}let[v,y]=useState(!!e.open),[_,b]=useState(!1);function x(e){b(void 0===e?!_:e)}let[C]=useState(new DragClass({callback(t,n){if("function"==typeof e.onSwap){let{fromIndex:i}=t,{options:o,toIndex:r}=n,a=C.reOrder(o,i,r);e.onSwap(a,o[i],o[r])}}}));function N(e){!!e!=!!m.getModals().length&&(y(!!e),e?m.addModal(e):(m.removeModal(),setTimeout(()=>$(u.current).focus(),0)))}function k(t,n){"checkbox"===i?r&&r(!o,t):!1!==c?N(c(n)):"function"==typeof e.onClick?e.onClick(t):a.onClick&&a.onClick()}function w(n){let{attrs:a={},onClick:l,close:u}=n;if(l)l(n.details);else if(a.onClick)a.onClick(n);else if(r){if(t.isInput);else if("tree"===i);else if("file"===i);else if(t.isMultiple){let{multiple:s}=e,c;for(c=-1===o.indexOf(n.value)?o.concat(n.value):o.filter(e=>e!==n.value);"number"==typeof s&&c.length>s;)c=c.slice(1,c.length);r(c,n.details)}else n.value!==e.value?r(n.value,n.details):!0===e.deSelect?r(void 0,n.details):"function"==typeof e.deSelect&&e.deSelect()}u&&N(!1)}function A(){let n=[];if("date"===i){if(!e.multiple)return{optionsList:[],optionsDic:{}};n=[...e.value]}else n="function"==typeof e.options?e.options():e.options?e.options:[];return GetOptions({rootProps:e,types:t,options:n})}function T(){return{error:d,options:A(),rootProps:{...e,value:o},datauniqid:s,touch:"ontouchstart"in document.documentElement,DragOptions:C,open:v,click:k,optionClick:w,types:t,showPassword:_,setShowPassword:x,DATE:n}}function P(){let{round:t,vertical:n}=e;return t?"aio-input-range-round":n?"aio-input-range-vertical":"aio-input-range-horizontal"}let D={spinner:()=>null,slider:()=>null,acardion:()=>_jsx(Acardion,{}),tree:()=>_jsx(Tree,{}),tags:()=>_jsx(Layout,{properties:{text:_jsx(Tags,{})}}),list:()=>_jsx(List,{}),file:()=>_jsx(File,{}),select:()=>_jsx(Select,{}),table:()=>_jsx(Table,{}),checkbox:()=>_jsx(Layout,{}),button:()=>_jsx(Layout,{}),range:()=>_jsx(Layout,{properties:{text:_jsx(Range,{}),className:P()}}),radio:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),tabs:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),buttons:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),date:()=>_jsx(DateInput,{}),time:()=>_jsx(Layout,{properties:{text:getTimeText(e)}}),image:()=>_jsx(Layout,{properties:{text:_jsx(Image,{})}}),text:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),password:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),textarea:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),number:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),color:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}})};return i&&D[i]?_jsxs(AICTX.Provider,{value:T(),children:[D[i](),m.render()]},s):null}function TimePopover(e){let{DATE:t,rootProps:n}=useContext(AICTX),{jalali:i,onChange:o,size:r=12}=n,{onClose:a}=e,[l,u]=useState(getTimeByUnit(n)),[s]=useState(l.year?l.year-10:void 0),[c]=useState(l.year?l.year+10:void 0);function d(e){u({...l,...e})}function p(e){return i?({year:"سال",month:"ماه",day:"روز",hour:"ساعت",minute:"دقیقه",second:"ثانیه",Submit:"ثبت",Now:"اکنون"})[e]:e}function f(e){let{year:n,month:i,day:o}=l;if("year"===e&&s&&c)return GetArray(c-s+1,e=>({text:e+s,value:e+s}));if("day"===e&&o){let r=n&&i?t.getMonthDaysLength([n,i]):31;return o>r&&d({day:1}),GetArray(r,e=>({text:e+1,value:e+1}))}return"month"===e?GetArray(12,e=>({text:e+1,value:e+1})):GetArray("hour"===e?24:60,e=>({text:e,value:e}))}function h(e){if("number"!=typeof l[e])return null;let t=f(e),n={type:"list",value:l[e],options:t,size:2.5*r,onChange:t=>d({[e]:t})};return _jsxs("div",{className:"aio-input-time-popover-item",children:[_jsx("div",{className:"aio-input-time-popover-item-title",children:p(e)}),_jsx(AIOInput,{...n}),_jsx("div",{className:"aio-input-time-popover-highlight"})]})}function m(){o&&o(l),a()}function g(){u(getTimeByUnit(n,!0))}return _jsxs("div",{className:"aio-input-time-popover-content aio-input-theme-bg1 aio-input-theme-color0",style:{fontSize:r},children:[_jsxs("div",{className:"aio-input-time-popover-body",children:[h("year")," ",h("month")," ",h("day")," ",h("hour")," ",h("minute")," ",h("second")]}),_jsxs("div",{className:"aio-input-time-popover-footer",children:[_jsx("button",{onClick:m,children:p("Submit")}),!1!==n.now&&_jsx("button",{onClick:()=>g(),children:p("Now")})]})]})}function Image(){let{rootProps:e}=useContext(AICTX),[t]=useState(new AIOPopup),{value:n,attrs:i,onChange:o,disabled:r,placeholder:a,preview:l,deSelect:u,imageAttrs:s={}}=e,[c,d]=useState(),p=createRef();function f(e,t){try{let n=new FileReader;n.onload=function(){c!==n.result&&(d(n.result),t&&t(n.result))},n.readAsDataURL(e)}catch{}}function h(e){e.stopPropagation(),e.preventDefault(),m()}function m(){t.addModal({position:"center",header:{title:"",onClose:()=>t.removeModal()},body:()=>_jsx("div",{className:"aio-input-image-preview-popup",children:_jsx("img",{src:$(p.current).attr("src"),alt:a})})})}useEffect(()=>{n&&null!==n?"object"==typeof n?f(n):"string"==typeof n&&c!==n&&d(n):c!==n&&d("")});let g=c?_jsxs(_Fragment,{children:[_jsx("img",{ref:p,src:c,alt:a,style:{objectFit:"contain",cursor:o?void 0:"default"},onClick:o?void 0:h,height:"100%",...s}),!!u&&_jsx("div",{onClick(e){e.stopPropagation(),e.preventDefault(),"function"==typeof u?u():o&&o("")},className:"aio-input-image-remove",children:I("mdiClose",1)}),l&&!!o&&_jsx("div",{onClick:e=>h(e),className:"aio-input-image-preview",children:I("mdiImage",1)}),t.render()]}):_jsx("span",{...i,className:"aio-input-image-placeholder",children:a||"placeholder"});if(!o)return g;let v={disabled:r,justify:!0,text:g,attrs:{style:{width:"100%",height:"100%",padding:0}},onChange:e=>f(e,e=>{o&&o(e)})};return _jsx(AIFile,{...v})}function File(){return _jsxs("div",{className:"aio-input-file-container",children:[_jsx(Layout,{}),_jsx(FileItems,{})]})}function InputFile(){let{rootProps:e,types:t}=useContext(AICTX),{value:n=[],onChange:i=()=>{},disabled:o,multiple:r,inputAttrs:a}=e;function l(e){let o=e.target.files,a;if(t.isMultiple){let l=(a=[...n]).map(({name:e})=>e);for(let u=0;u<o.length;u++){let s=o[u];-1===l.indexOf(s.name)&&a.push({name:s.name,size:s.size,file:s})}if("number"==typeof r)for(;a.length>r;)a=a.slice(1,a.length)}else a=o.length?o[0]:void 0;i(a)}let u;return _jsx("input",{...{disabled:!0===o,type:"file",style:{display:"none"},multiple:t.isMultiple,onChange:e=>l(e),...a}})}function FileItems(){let{rootProps:e}=useContext(AICTX),{value:t,rtl:n}=e,i=[];if(Array.isArray(t))i=t;else{if(!t)return null;i=[t]}if(!i.length)return null;let o=i.map((e,t)=>_jsx(FileItem,{file:e,index:t},t));return _jsx("div",{className:"aio-input-files",style:{direction:n?"rtl":"ltr"},children:o})}let FileItem=e=>{let{rootProps:t,types:n}=useContext(AICTX),{onChange:i=()=>{},value:o=[]}=t,{file:r,index:a}=e;function l(e){let t=e.name||"untitle",n=e.size||0,i=20;try{let o,r,a=t.lastIndexOf("."),l=t.slice(0,a),u=t.slice(a+1,t.length);o=l.length>i?l.slice(0,Math.floor(i/2))+"..."+l.slice(l.length-Math.floor(i/2),l.length)+"."+u:t;let s=n;if(!s)return{minName:o,sizeString:!1};let c=s/1073741824,d=s/1048576,p=s/1024;return r=c>=1?c.toFixed(2)+" GB":d>=1?d.toFixed(2)+" MB":p>=1?p.toFixed(2)+" KB":s+" byte",{minName:o,sizeString:r}}catch{return{minName:"untitle",sizeString:!1}}}async function u(e,n){if(e.stopPropagation(),e.preventDefault(),"function"==typeof t.onRemove){let r=await t.onRemove({row:o[n],rowIndex:n});if(!1===r)return}let a=[];for(let l=0;l<o.length;l++)l!==n&&a.push(o[l]);i(a)}function s(){DownloadFile(r)}function c(){let e;return(t.preview&&(e=FilePreview(r,{onClick:()=>s()})),e&&null!==e)?e:_jsx("div",{className:"aio-input-file-item-icon",onClick:()=>s(),children:I("mdiAttachment",.8)})}let{minName:d,sizeString:p}=l(r),{optionsList:f}=GetOptions({rootProps:t,types:n,options:[{minName:d,sizeString:p,index:a}],defaultOptionProps:{subtext:()=>p,text:()=>d,before:()=>c(),after:()=>_jsx("div",{className:"aio-input-file-item-icon",onClick:e=>u(e,a),children:I("mdiClose",.7)})}});return _jsx(Layout,{option:f[0]})};function Select(){let{rootProps:e,types:t,options:n}=useContext(AICTX),{value:i,hideTags:o}=e,r=Array.isArray(i)?[...i]:void 0!==i?[i]:[];function a(){if(!r.length)return;let e=n.optionsDic["a"+r[0]];if(e)return e.text}return t.isMultiple?_jsxs("div",{className:"aio-input-multiselect-container",children:[_jsx(Layout,{}),!o&&!!r.length&&_jsx(Tags,{})]}):_jsx(Layout,{properties:{text:e.text||a()}})}function DateInput(){let{rootProps:e,types:t}=useContext(AICTX),{value:n,hideTags:i}=e,o=Array.isArray(n)?[...n]:void 0!==n?[n]:[];function r(){let{value:t,unit:n=Def("date-unit"),text:i,pattern:o,jalali:r,placeholder:a}=e;if(t){i=void 0!==o?o:i;let l=new AIODate,u=l.convertToArray(t),[s,c=1,d=1,p=0]=u;u=[s,c,d,p];let f="{}",h=l.getSplitter(t);return i&&("string"==typeof i||"number"==typeof i)?f=i.toString():"month"===n?f=`{year}${h}{month}`:"day"===n?f=`{year}${h}{month}${h}{day}`:"hour"===n&&(f=`{year}${h}{month}${h}{day} - {hour} : 00`),_jsx("div",{style:{direction:"ltr"},children:l.getDateByPattern(u,f)})}return a||(r?"انتخاب تاریخ":"Select Date")}return t.isMultiple?_jsxs("div",{className:"aio-input-multiselect-container",children:[_jsx(Layout,{properties:{text:e.text||"Select Dates"}}),!i&&!!o.length&&_jsx(Tags,{})]}):_jsx(Layout,{properties:{text:r()}})}let Tags=()=>{let{rootProps:e,options:t}=useContext(AICTX),{value:n=[],rtl:i,disabled:o,onChange:r=()=>{}}=e,a=n.map((n,i)=>{let o=t.optionsDic["a"+n];return void 0===o?null:_jsx(Tag,{onClose:()=>r(e.value.filter(e=>e!==n)),attrs:o.tagAttrs,before:o.tagBefore,after:o.tagAfter,text:o.text,disabled:o.disabled},i)});return a.length?_jsx("div",{className:`aio-input-tags-container aio-input-scroll${i?" rtl":""}${o?" disabled":""}`,children:a}):null},Tag=e=>{let{attrs:t,before:n=I("mdiCircleMedium",.7),after:i,text:o,disabled:r,onClose:a=()=>{}}=e,l=r?void 0:a,u="aio-input-tag",s=AddToAttrs(t,{className:[u+" aio-input-main-bg",r?"disabled":void 0]});return _jsxs("div",{...s,children:[_jsx("div",{className:`${u}-icon`,children:n}),_jsx("div",{className:`${u}-text`,children:o}),void 0!==i&&_jsx("div",{className:`${u}-icon`,children:i}),_jsx("div",{className:`${u}-icon`,onClick:l,children:I("mdiClose",.7)})]})};function Input(){let{rootProps:e,types:t,showPassword:n,options:i}=useContext(AICTX),{type:o,delay:r=500}=e,{min:a,max:l,swip:u,onChange:s,blurChange:c,maxLength:d=1/0,justNumber:p,filter:f=[],disabled:h,placeholder:m,inputAttrs:g,spin:v=!0,justify:y}=e,[_]=useState(createRef()),[b]=useState({atimeout:void 0,btimeout:void 0,clicked:!1}),[x]=useState(`ac${Math.round(1e5*Math.random())}`),[C,N]=useState(e.value||""),k=useRef(C);function w(){"number"===o&&u&&new Swip({speedY:u,reverseY:!0,minY:a,maxY:l,dom:()=>$(_.current),start(){let e=+k.current;return[0,e=isNaN(e)?0:e]},move(e){let{y:t}=e.change||{y:0};void 0!==a&&t<a&&(t=a),void 0!==l&&t>l&&(t=l),D(t,s)}})}function A(){let t=e.value;if("number"===o){if(""===t)return;!isNaN(+t)&&(t=+t,"number"==typeof a&&t<a?t=a:"number"==typeof l&&t>l&&(t=l))}return t}function T(){clearTimeout(b.atimeout),b.atimeout=setTimeout(()=>{let e=A();e!==C&&N(e)},r)}function P(e){try{e=e.toString();let t="";for(let n=0;n<e.length;n++){let i={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};t+=i[e[n]]||e[n]}e=t}catch{}return e}function D(n,i){if(t.hasKeyboard&&n){if(n=P(n),("text"===o||"textarea"===o||"password"===o)&&p){let a=(n=n.toString())[n.length-1];(" "===a||isNaN(+a))&&(Array.isArray(p)?-1===p.indexOf(a)&&(n=n.slice(0,n.length-1)):n=n.slice(0,n.length-1))}if(("text"===o||"textarea"===o||"password"===o)&&f.length){let l=(n=n.toString())[n.length-1];for(let u=0;u<f.length;u++){let s=f[u].toString();if("symbol"===s){if(/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/.test(l)){n=n.slice(0,n.length-1);break}}else if("number"===s){if(!isNaN(+l)){n=n.slice(0,n.length-1);break}}else if("string"===s){if(isNaN(+l)){n=n.slice(0,n.length-1);break}}else if(s===l){n=n.slice(0,n.length-1);break}}}("text"===o||"textarea"===o||"password"===o)&&n.toString().length>d&&(n=n.toString().slice(0,d));try{"number"===o&&n.toString().length>d&&(n=+n.toString().slice(0,d))}catch{}}"number"===e.type&&(n=""!==n?+n:void 0),N(n),!c&&i&&(clearTimeout(b.btimeout),b.btimeout=setTimeout(()=>i(n),r))}function O(){!1!==e.autoHighlight&&!b.clicked&&(b.clicked=!0,$(_.current).focus().select())}function M(e){b.clicked=!1,c&&e&&e(C)}function R(){let t={...AddToAttrs(g,{className:v?void 0:"no-spin",style:y?{textAlign:"center"}:void 0}),value:C,type:o,ref:_,disabled:h,placeholder:m,list:e.options?x:void 0,onClick:e=>O(),onChange:s?e=>D(e.target.value,s):void 0,onBlur:()=>M(s)};return"password"===o&&n&&(t={...t,type:"text",style:{...t.style,textAlign:"center"}}),!0===p&&(t.pattern="d*",t.inputMode="numeric"),t}k.current=C,useEffect(()=>{w()},[]),useEffect(()=>{T()},[e.value]);let L=R();return L.onChange?"color"===o?_jsxs("label",{style:{width:"100%",height:"100%",background:C},children:[_jsx("input",{...L,style:{opacity:0},opacity:!0,rgba:!0,cmyk:!0,hsla:!0}),!!i.optionsList.length&&_jsx("datalist",{id:x,children:i.optionsList.map(e=>_jsx("option",{value:e.value}))})]}):"textarea"===o?_jsx("textarea",{...L}):_jsx("input",{...L}):C}function Options(){let{rootProps:e,types:t,options:n}=useContext(AICTX),[i,o]=useState(""),[r]=useState(createRef()),[a]=useState();function l(n){return"tabs"===e.type||"buttons"===e.type||t.isInput||!e.search||""===i&&n.length<10?null:_jsxs("div",{className:"aio-input-search",children:[_jsx("input",{type:"text",value:i,placeholder:e.search,onChange:e=>o(e.target.value)}),_jsx("div",{className:"aio-input-search-icon",onClick(){o("")},children:I(i?"mdiClose":"mdiMagnify",.8)})]})}function u(e){return e.map((e,t)=>i&&(void 0===e.text||""===e.text||null===e.text||-1===e.text.indexOf(i))?null:_createElement(Layout,{option:e,index:t,searchValue:i,key:t}))}function s(e){e.keyCode}if(useEffect(()=>{try{setTimeout(()=>$(r.current).focus(),30)}catch{}},[]),!n.optionsList.length)return null;let c=u(n.optionsList),d=`aio-input-options aio-input-scroll aio-input-${e.type}-options`;return t.isDropdown&&(d+=" aio-input-dropdown-options"),_jsxs("div",{className:"aio-input-options-container",ref:r,tabIndex:0,onKeyDown:e=>s(e),children:[l(n.optionsList),_jsx("div",{className:d,children:c})]})}let Layout=e=>{let{rootProps:t,datauniqid:n,types:i,touch:o,DragOptions:r,click:a,optionClick:l,open:u,showPassword:s,setShowPassword:c,error:d}=useContext(AICTX),{option:p,index:f,toggle:h,indent:m}=e,{type:g,rtl:$}=t,[v]=useState(createRef()),[y,_]=useState();function b(){let e;if(void 0!==p?(e=`aio-input-option aio-input-${g}-option`,i.isMultiple&&(e+=` aio-input-${g}-multiple-option`),i.isDropdown&&(e+=" aio-input-dropdown-option"),!0===p.details.active&&(e+=" active","tabs"===g&&(e+=" aio-input-main-color"),"buttons"===g&&(e+=" aio-input-main-bg"))):(e=`aio-input aio-input-${g}${o?" aio-input-touch":""}`,i.isInput&&(e+=" aio-input-input"),t.justify&&(e+=" aio-input-justify"),d&&(e+=" has-error"),e+=$?" aio-input-rtl":" aio-input-ltr"),m&&(e+=` aio-input-indent-${m.size}`),"tree"===g){let r=t.size||Def("tree-size");(r=12*Math.round(r/12))<24&&(r=24),r>120&&(r=120),e+=` aio-input-size-${r}`}return!0===j.disabled&&(e+=" disabled"),j.className&&(e+=" "+j.className),e+=" "+n}function x(e){let t=`aio-input-${e}`;return p?t+=` aio-input-${g}-option-${e}`:t+=` aio-input-${g}-${e}`,t}function C(){let{text:e,placeholder:t,subtext:n,justify:o}=j;if(void 0===e&&void 0!==t&&(e=_jsx("div",{className:"aio-input-placeholder",children:t})),void 0===e)return _jsx("div",{style:{flex:1}});{let r=e=>({className:`${x(e)}${o&&!i.isInput?" aio-input-value-justify":""}`});return n?_jsxs("div",{className:`aio-input-content aio-input-${g}-content${o&&!i.isInput?" aio-input-content-justify":""}`,children:[_jsx("div",{...r("value"),children:e}),_jsx("div",{...r("subtext"),children:n})]}):_jsx("div",{...r("value"),children:e})}}function N(e){let t=e.keyCode;console.log(t),13===t&&a(e,v)}function k(){return j.draggable?_jsx("svg",{viewBox:"8 4 10 13",role:"presentation",style:{width:12,height:"1.8rem"},children:_jsx("path",{d:"M9,3H11V5H9V3M13,3H15V5H13V3M9,7H11V9H9V7M13,7H15V9H13V7M9,11H11V13H9V11M13,11H15V13H13V11M9,15H11V17H9V15M13,15H15V17H13V15M9,19H11V21H9V19M13,19H15V21H13V19Z",style:{fill:"currentcolor"}})}):null}function w(){if(!i.isDropdown||p||i.isInput&&!t.options)return null;let{caret:e}=t;return!1===e?null:_jsx("div",{className:"aio-input-caret",children:void 0===e?I("mdiChevronDown",.8):e})}function A(){let{checkIcon:e,checked:n}=j;if(void 0===n)return null;let{multiple:i}=t;return Array.isArray(e)?e[n?1:0]:i||"radio"!==g?_jsx("div",{className:"aio-input-check-0 aio-input-main-color"+(n?" checked":""),style:{...e,background:"none"},children:n&&_jsx("div",{className:"aio-input-main-bg"})}):_jsx("div",{className:"aio-input-check-out aio-input-main-color"+(n?" checked":""),style:{...e,background:"none"},children:n&&_jsx("div",{className:"aio-input-check-in aio-input-main-bg",style:{background:e.background}})})}function T(e){let n;if("after"===e&&"password"===g&&t.preview)n=_jsx("div",{className:"aio-input-password-preview",onClick:()=>c(),children:I(s?"mdiEyeOff":"mdiEye",.8)});else{let i=j[e];n="function"==typeof i?i():i}return void 0===n?null:_jsx("div",{className:x(e),children:n})}function P(){let{loading:e}=j,t;return e?(t=!0===e?I("mdiLoading",.8,{spin:.8}):e,_jsx("div",{className:x("loading"),children:t})):null}function D(){let{attrs:n,disabled:i,draggable:o,style:s}=j,c;u&&!p&&-1!==["text","number","textarea"].indexOf(g)&&(c=1e5);let d;i||(d=void 0===p?e=>{e.stopPropagation(),a(e,v)}:t=>{t.stopPropagation(),t.preventDefault(),(e.properties||{}).onClick?e.properties.onClick():l(p)}),n=AddToAttrs(n,{className:b(),style:{...s,zIndex:c}});let h={tabIndex:p?void 0:0,onKeyDown:N,...n,onClick:d,ref:v,disabled:i},m="function"==typeof t.options?t.options():t.options||[];return o&&(h={...h,...r.getDragAttrs({fromIndex:f||0}),...r.getDropAttrs({options:m,toIndex:f||0})}),f&&(h["data-index"]=f),h}function O(){let n=e.properties||{},i=p||t,{draggable:o=!!p&&p.draggable}=n,{placeholder:r=p?void 0:t.placeholder}=n,{checked:a=p?p.checked:"checkbox"===g?!!t.value:void 0}=n,{disabled:l=i.disabled}=n,{text:u=i.text}=n,{subtext:s=i.subtext}=n,{justify:c=i.justify}=n,{checkIcon:d=void 0===i.checkIcon?{}:i.checkIcon}=n,{loading:f=i.loading}=n,{attrs:h=i.attrs||{}}=n,m={...i.style||{},...n.style},{before:$=i.before}=n,{after:v=i.after}=n,{footer:y=i.footer}=n,_=[i.className,n.className].filter(e=>!!e),b=_.length?_.join(" "):void 0;return{disabled:l,draggable:o,text:u,subtext:s,placeholder:r,justify:c,checked:a,checkIcon:d,loading:f,attrs:h,style:m,before:$,after:v,className:b,footer:y}}function M(e){if(void 0===h)return null;if(p&&Array.isArray(p.toggleIcon)){if(!1===e&&p.toggleIcon[0])return p.toggleIcon[0];if(!0===e&&p.toggleIcon[1])return p.toggleIcon[1];if(void 0===e&&p.toggleIcon[2])return p.toggleIcon[2]}let n;return n=void 0===e?"mdiCircleSmall":!0===e?"mdiChevronDown":"mdiChevronRight",_jsx("div",{style:{transform:t.rtl?"scaleX(-1)":void 0},children:I(n,1)})}function R(e){return p&&!1!==p.toggleIcon&&void 0!==h?_jsxs("div",{className:"aio-input-toggle",onClick(e){e.stopPropagation(),null==h||h.action()},children:[_jsx("div",{className:"aio-input-toggle-icon",children:M(h.state)}),!0===h.state&&_jsx("svg",{className:"aio-input-toggle-line aio-input-indent-line",children:_jsx("path",{d:`M${e.size/2} 0 L${e.size/2} ${e.height/2-12} Z`})})]}):null}function L(e,n){let{parentIndent:i,size:o,level:r,isLastChild:a,height:l}=e;if(!r)return!1;let u=o/2,s=o,c=0,d=l/2,p=l,f=[];return n===r-1?(f.push(_jsx("path",{d:`M${u} ${d} L${s*(t.rtl?-1:1)} ${d} Z`},"hl"+n)),f.push(_jsx("path",{d:`M${u} ${c} L${u} ${a?d:p} Z`},"vdl"+n))):i&&i.isLastChild||f.push(_jsx("path",{d:`M${u} ${c} L${u} ${p} Z`},"vl"+n)),_jsx("svg",{className:"aio-input-indent-line",children:f})}function S(){if(!m)return null;let{level:e}=m;return _jsxs("div",{className:"aio-input-indents",children:[GetArray(e,e=>_jsx("div",{className:"aio-input-indent",children:L(m,e)},e)),!!h&&R(m)]})}function z(){if(p)return null;let{label:e}=t;if(!e)return null;let n="aio-input-label",i="*"===e[0];i&&(n+=" aio-input-label-required");let o=i?e.slice(1,e.length):e;return _jsx("div",{className:n,children:o})}function H(){if(p)return null;let e="";if(void 0!==j.footer?e=j.footer:d&&!1!==t.showErrors&&(e=d),void 0!==e)return _jsx("div",{className:"aio-input-footer",children:e})}function G(){y.start()}function B(){return y?_jsx("div",{className:"aio-input-voice",onClick:()=>G(),children:I("mdiMicrophoneOutline",.8)}):null}useEffect(()=>{if(!("webkitSpeechRecognition"in window))return;let{lang:e="en",onChange:n,voice:o}=t;if(!o||!n||!i.hasKeyboard)return;let r=window.SpeechRecognition||window.webkitSpeechRecognition;if(!r)return;let a=new r;return a.lang=({en:"en-US",fa:"fa-IR"})[e],a.continuous=!0,a.interimResults=!1,a.onresult=e=>{let t=e.results[0][0].transcript;n&&n(t)},a.onerror=e=>{console.error("خطا در تشخیص گفتار: ",e.error)},a.onend=()=>{console.log("تشخیص گفتار پایان یافت.")},_(a),()=>{a.stop()}},[]);let j=O(),V=_jsxs(_Fragment,{children:[S(),k(),A(),z(),T("before"),C(),T("after"),P(),B(),w()]}),X=D();return"file"===g?_jsxs("label",{...X,children:[V,_jsx(InputFile,{})]}):_jsxs("div",{...X,children:[V,!!p&&"tabs"===g&&_jsx("div",{className:"aio-input-tabs-option-bar"}),H()]})};function List(){let{rootProps:e,options:t}=useContext(AICTX),{attrs:n={},size:i=36,listOptions:o={count:3,editable:!0,stop:3,decay:8},onChange:r=()=>{}}=e,{count:a=3,editable:l=!0,stop:u=3,decay:s=8}=o,c=t.optionsList.length,[d]=useState({dom:createRef(),activeIndex:0,interval:void 0,moved:!1,lastY:0,deltaY:0,so:{y:0,top:0,limit:{top:0,bottom:0}}});function p(){var e=a*i;return{height:e}}function f(e){return Math.round((a*i-i-2*e)/(2*i))}function h(e){return(a-2*e-1)*i/2}function m(){return{top:h(d.activeIndex)}}function g(e){if(e.preventDefault(),d.activeIndex>=c-1)return;d.activeIndex++;let t=h(d.activeIndex);A({top:t}),v(d.activeIndex)}function v(e){$(d.dom.current).find(".aio-input-list-option").removeClass("active"),$(d.dom.current).find(".aio-input-list-option[data-index="+e+"]").addClass("active")}function y(){if(d.activeIndex<=0)return;d.activeIndex--;let e=h(d.activeIndex);A({top:e}),v(d.activeIndex)}function _(e){l&&(38===e.keyCode?y():40===e.keyCode&&g(e))}function b(){return{top:h(-1),bottom:h(c)}}function x(e){let t=f(e);return t<0&&(t=0),t>c-1&&(t=c-1),h(t)}function C(e){if(!l)return;EventHandler("window","mousemove",w,"bind"),EventHandler("window","mouseup",T,"bind"),clearInterval(d.interval),d.moved=!1;let n=GetClient(e).y;A({transition:"unset"});let i=N();var o=f(i);v(o),A({top:i,transition:"unset"}),r(t.optionsList[o].value,o),d.so={y:n,top:i,limit:b()}}function N(){var e=parseInt($(d.dom.current).find(".aio-input-list-options").css("top"));return x(e)}function k(e){let{top:t,bottom:n}=d.so.limit;return e>t?t:e<n?n:e}function w(e){e.preventDefault(),e.stopPropagation(),console.log("move"),d.moved=!0;let t=GetClient(e).y;var n=t-d.so.y;void 0===d.lastY&&(d.lastY=t),d.deltaY=t-d.lastY,d.lastY=t,20>Math.abs(n)&&(d.deltaY=3);var i=k(d.so.top+n);let o=f(i);d.so.newTop=i,v(o),A({top:i})}function A(e){$(d.dom.current).find(".aio-input-list-options").css(e)}function T(){EventHandler("window","mousemove",w,"unbind"),EventHandler("window","mouseup",T,"unbind"),d.moved&&(d.moved=!1,P(d.deltaY,d.so.newTop))}function P(e,n=N()){s<0&&(s=0),s>99&&(s=99),s=1+s/1e3,d.interval=setInterval(()=>{let i=f(n+=e);if(v(i),Math.abs(e)<u||i<0||i>c-1){clearInterval(d.interval),i<0&&(i=0),i>c-1&&(i=c-1);let o=h(i);A({top:o,transition:"0.3s"});let a=t.optionsList[i];r(a.value,a.details);return}e/=s,A({top:n})},20)}useEffect(()=>{var t;null!==(t=e.listOptions)&&void 0!==t&&t.move&&e.listOptions.move(P)},[]),useEffect(()=>{v(d.activeIndex)});let D=t.optionsList.map((t,n)=>(t.value===e.value&&(d.activeIndex=n),_jsx(Layout,{option:t,index:n,properties:{style:{height:i},justify:!0}},n)));return _jsx("div",{...n,ref:d.dom,tabIndex:0,onKeyDown:e=>_(e),className:"aio-input-list"+(n.className?" "+n.className:""),style:{...n.style,...p()},children:_jsx("div",{className:"aio-input-list-options",style:m(),onMouseDown:e=>C(e),onTouchStart:e=>C(e),children:D})})}let AcardionContext=createContext({});export const Acardion=()=>{let{rootProps:e,options:t}=useContext(AICTX),{multiple:n,vertical:i=!0,value:o}=e;function r(e){return n?-1!==(o||[]).indexOf(e):e===o}function a(){return{rootProps:e,isOpen:r}}return _jsx(AcardionContext.Provider,{value:a(),children:_jsx("div",{className:`aio-input-acardion aio-input-scroll${i?" aio-input-acardion-vertical":" aio-input-acardion-horizontal"}`,children:t.optionsList.map((e,t)=>_jsx(AcardionItem,{option:e},t))})})};let AcardionItem=({option:e})=>{let t=!!e.details.active,[n]=useState(),i=AddToAttrs(e.attrs,{className:"aio-input-acardion-item"});return _jsxs("div",{...i,children:[_jsx(Layout,{option:e}),!!t&&_jsx(AcardionBody,{option:e})]})},AcardionBody=({option:e})=>{let{rootProps:t}=useContext(AcardionContext),{body:n=()=>{}}=t,{html:i,attrs:o}=n(e.details)||{html:""},r=AddToAttrs(o,{className:["aio-input-acardion-body"]});return _jsx("div",{...r,children:i})},TreeContext=createContext({}),Tree=()=>{let{rootProps:e,types:t}=useContext(AICTX),{onAdd:n,onRemove:i,value:o=[],onChange:r,size:a=Def("tree-size"),attrs:l}=e,[u,s]=useState({}),[c,d]=useState({}),[p]=useState(m);function f(e){d({...c,[e]:!c[e]})}function h(e){s({...u,[e]:!u[e]})}function m(){let{indent:t=24}=e;return"number"!=typeof t&&(t=12),(t=6*Math.round(t/6))<0&&(t=0),t>60&&(t=60),t}function g(e){let t=!!u[e],n=300;t?(f(e),setTimeout(()=>h(e),n)):(h(e),setTimeout(()=>f(e),0))}function $(t,n){for(let i in n)t[i]=n[i];e.onChange&&e.onChange(e.value)}function v(t){let{row:n,details:i}=t,o=[];try{o=e.getChilds?e.getChilds({row:n,details:i}):n.childs||[]}catch{o=[]}return o||[]}function y(t){let{row:n,childs:i}=t;try{e.setChilds?e.setChilds(t):n.childs=i}catch{}}async function _(e){let t;if(t="function"==typeof n?await n(e):n){if(e){let i=v({row:e.parent,details:e.parentDetails});y({row:e.parent,childs:i.concat(t),details:e.parentDetails})}else o.push(t);r&&r(o)}}async function b(t){let{index:n}=t,a;if(!(a="function"!=typeof i||await i(t)))return;let l={index:n,active:!1,toggle(){}};if(t.parent){let u=v({row:t.parent,details:t.parentDetails}).filter(n=>{let i=GetOptionProps({key:"value",rootProps:e,optionDetails:{...l,option:t.row,rootProps:e}}),o=GetOptionProps({key:"value",rootProps:e,optionDetails:{...l,option:n,rootProps:e}});return i!==o});y({row:t.parent,details:t.parentDetails,childs:u})}else o=o.filter(n=>{let i=GetOptionProps({key:"value",rootProps:e,optionDetails:{...l,option:t.row,rootProps:e}}),o=GetOptionProps({key:"value",rootProps:e,optionDetails:{...l,option:n,rootProps:e}});return i!==o});r&&r(o)}function x(){return{toggle:g,rootProps:e,mountedDic:c,openDic:u,add:_,remove:b,types:t,indent:p,size:a,change:$,getChilds:v}}useEffect(()=>{e.toggleRef&&(e.toggleRef.current=e=>g(e))},[g]),useEffect(()=>{e.onToggle&&e.onToggle(u)},[u]);let C=AddToAttrs(l,{className:["aio-input-tree",e.className],style:e.style});return _jsx(TreeContext.Provider,{value:x(),children:_jsxs("div",{...C,children:[_jsx(TreeHeader,{}),_jsx(TreeBody,{rows:o,level:0})]})})},TreeHeader=()=>{let{rootProps:e,add:t}=useContext(TreeContext),{addText:n="add",onAdd:i}=e;return i?(n=("function"==typeof n?n("header"):n)||"add",_jsx("div",{className:"aio-input-tree-header",children:_jsxs("button",{onClick:()=>t(),children:[I("mdiPlusThick",.8),n]})})):null},TreeActions=e=>{let{row:t,index:n,parent:i,rowDetails:o,parentDetails:r}=e,{rootProps:a,add:l,remove:u}=useContext(TreeContext),{onAdd:s,onRemove:c,removeText:d="Remove"}=a,p=("function"==typeof a.addText?a.addText(t):a.addText)||"Add",f="function"==typeof a.actions?a.actions(t,i):a.actions;function h(){let e=[];return s&&e.push({text:p,value:"add",before:I("mdiPlusThick",.7),onClick:()=>l({parent:t,parentDetails:o})}),e=[...e,...(f||[]).map(e=>({...e,onClick(){e.onClick&&e.onClick(t,i)}}))],c&&e.push({text:d,value:"remove",before:I("mdiDelete",.7),onClick:()=>u({row:t,index:n,parent:i,parentDetails:r})}),e}let m=h();if(!m.length)return null;let g={type:"select",caret:!1,popover:{limitTo:".aio-input-tree"},className:"aio-input-tree-options-button",options:m,text:I("mdiDotsHorizontal",.7)};return _jsx(AIOInput,{...g})},TreeBody=e=>{let{rootProps:t,types:n,openDic:i,mountedDic:o,indent:r,size:a,change:l,getChilds:u,toggle:s}=useContext(TreeContext),{rows:c,level:d,parent:p,parentId:f,parentIndent:h,parentDetails:m}=e,g=void 0===f||!!i[f],$=void 0==f||o[f],{onAdd:v,onRemove:y,actions:_}=t,{optionsList:b}=GetOptions({rootProps:t,types:n,options:c,level:d,isOpen:e=>!!i[e],change:(e,t)=>l(e,t)});function x(){let e="aio-input-tree-body";return p||(e+=" aio-input-tree-root"),g&&(e+=" open"),e+=$?" mounted":" not-mounted",e+=` aio-input-tree-body-level-${d}`}return(v||y||_)&&(b=b.map(e=>{let{index:t,level:n=0,option:i}=e.details,o=0===t,r=t===c.length-1,a={index:t,level:n,isFirstChild:o,isLastChild:r},l=_jsx(TreeActions,{row:i,index:t,parent:p,rowDetails:a,parentDetails:m});return{...e,after:l}})),_jsx("div",{className:x(),children:b.map((e,t)=>{let n=c[t],o=e.value,l={level:d,index:t,isLastChild:t===b.length-1,isFirstChild:0===t},s=u({row:n,details:l}),m=!!i[o],$={row:n,option:e,parent:p,parentId:f,id:o,parentOpen:g,open:m,details:l,indent:{height:a,childsLength:s.length,size:r,parentIndent:h,...l}};return _createElement("div",{className:"aio-input-tree-row",key:o},_jsx(TreeRow,{item:$}),_jsx(TreeChilds,{item:$}))})})},TreeRow=e=>{let{openDic:t,getChilds:n,toggle:i}=useContext(TreeContext),{item:o}=e,r=n(o).length?!!t[o.id]:void 0,a;return _jsx(Layout,{indent:o.indent,option:o.option,toggle:{state:r,action:()=>i(o.id)}})},TreeChilds=e=>{let{getChilds:t}=useContext(TreeContext),{row:n,id:i,open:o,indent:r,details:a}=e.item,l=t(e.item);return o&&l&&l.length?_jsx(TreeBody,{rows:l,level:r.level+1,parent:n,parentId:i,parentIndent:r,parentDetails:a}):null},DPContext=createContext({});export function Calendar(e){let{rootProps:t,DATE:n}=useContext(AICTX),{onClose:i}=e,{multiple:o,unit:r=Def("date-unit"),jalali:a,value:l,disabled:u,size:s=12,theme:c=Def("theme"),translate:d=e=>e,onChange:p=()=>{},option:f={}}=t,[h]=useState(n.getMonths(a)),[m]=useState(n.getToday(a)),[g]=useState(n.getWeekDay(m).weekDay),[$]=useState(h[m[1]-1]),[v,y]=useState(b);function _(){let e;return o?l.length?l[l.length-1]:void 0:l}function b(){let e=_();e=e&&null!==e?e:m;let[t,i,o]=n.convertToArray(e);return{year:t,month:i,day:o}}let x=useRef(v);function C(e){"Today"===e&&("month"===r?e="This Month":"hour"===r&&(e="This Hour"));let t={Clear:"حذف","This Hour":"ساعت کنونی",Today:"امروز","This Month":"ماه جاری","Select Year":"انتخاب سال",Close:"بستن"},n;return a&&t[e]&&(n=t[e]),d(e)}function N(e){let t;if("today"===e){let[n,i,o]=m;t={year:n,month:i,day:"month"===r?1:o}}else t={...v,...e};y(t)}function k(){return{fontSize:s,background:c[1],color:c[0],stroke:c[0],cursor:!0===u?"not-allowed":void 0}}function w(){let e=_();return"string"==typeof e?n.getSplitter(e):"/"}function A(){return{changeActiveDate:N,DATE:n,translate:C,rootProps:t,activeDate:x.current,today:m,todayWeekDay:g,thisMonthString:$,months:h,onChange(e){let{year:u=1e3,month:s=1,day:c=1,hour:d=0}=e,m=[u,s,c,d],g=a?m:n.toJalali(m),$=a?n.toGregorian(m):m,{weekDay:v,index:y}="month"===r?{weekDay:"",index:0}:n.getWeekDay(m),_=e=>{if(void 0===e)return;let t=e.toString();return 1===t.length?`0${t}`:t},b="",x=w();"month"===r?b=`${u}${x}${_(s)}`:"day"===r?b=`${u}${x}${_(s)}${x}${_(c)}`:"hour"===r&&(b=`${u}${x}${_(s)}${x}${_(c)}${x}${_(d)}`);let C=h[s-1],N=a?C:n.getMonths(!0)[s-1],k=a?n.getMonths(!1)[s-1]:C,A={months:h,jalaliDateArray:g,gregorianDateArray:$,dateArray:m,weekDay:v,weekDayIndex:y,dateString:b,year:u,month:s,day:c,hour:d,monthString:C,jalaliMonthString:N,gregorianMonthString:k},T,P=0;if(o){let D=[],O=(D=l?Array.isArray(l)?[...l]:[l]:[]).indexOf(b);if(T=-1===O?[...D,b]:D.filter(e=>e!==b),"number"==typeof o)for(;T.length>o;)T=T.slice(1,T.length);O=T.length-1}else P=0,T=b;p(T,A),i&&"function"==typeof f.close&&f.close({option:void 0,index:P,rootProps:t})&&i()}}}return x.current=v,_jsx(DPContext.Provider,{value:A(),children:_jsxs("div",{className:"aio-input-date-container",style:{display:"flex",fontSize:s},children:[_jsxs("div",{className:"aio-input-date-calendar aio-input-theme-bg1 aio-input-theme-color0 aio-input-theme-stroke0",style:k(),children:[_jsx(DPHeader,{}),_jsx(DPBody,{}),_jsx(DPFooter,{})]}),_jsx(DPToday,{})]})})}function DPToday(){let{rootProps:e,translate:t,today:n,todayWeekDay:i,thisMonthString:o}=useContext(DPContext),{theme:r=Def("theme"),jalali:a,unit:l=Def("date-unit")}=e;return _jsxs("div",{className:"aio-input-date-today aio-input-theme-color1 aio-input-theme-bg0",style:{color:r[1],background:r[0]},children:[_jsx("div",{className:"aio-input-date-today-label",children:t("Today")}),"month"!==l&&_jsx("div",{className:"aio-input-date-today-weekday",children:a?i:i.slice(0,3)}),"month"!==l&&_jsx("div",{className:"aio-input-date-today-day",children:n[2]}),_jsx("div",{className:"aio-input-date-today-month",children:a?o:o.slice(0,3)}),_jsx("div",{className:"aio-input-date-today-year",children:n[0]}),"hour"===l&&_jsx("div",{className:"aio-input-date-today-year",children:n[3]+":00"})]})}function DPFooter(){let{rootProps:e,changeActiveDate:t,translate:n}=useContext(DPContext),{disabled:i,onChange:o=()=>{},deSelect:r,multiple:a,now:l=!0}=e;if(i)return null;let u="aio-input-theme-color0";function s(){"function"==typeof r?r():o(a?[]:void 0)}return _jsxs("div",{className:"aio-input-date-footer",children:[!!r&&_jsx("button",{onClick:()=>s(),className:u,children:n("Clear")}),!!l&&_jsx("button",{onClick:()=>t("today"),className:u,children:n("Today")})]})}function DPBody(){let{rootProps:e,activeDate:t}=useContext(DPContext),{unit:n=Def("date-unit"),jalali:i}=e;function o(){let e="aio-input-date-body";return e+=` aio-input-date-body-${n}`,e+=` aio-input-date-${i?"rtl":"ltr"}`}return _jsxs("div",{className:o(),children:["hour"===n&&GetArray(24,e=>_jsx(DPCell,{dateArray:[t.year,t.month,t.day,e]},"cell"+e)),"day"===n&&_jsx(DPBodyDay,{}),"month"===n&&GetArray(12,e=>_jsx(DPCell,{dateArray:[t.year,e+1]},"cell"+e))]})}function DPBodyDay(){let{rootProps:e,activeDate:t,DATE:n}=useContext(DPContext),{theme:i=Def("theme"),jalali:o}=e,r=n.getWeekDay([t.year,t.month,1]).index,a=n.getMonthDaysLength([t.year,t.month]);return _jsxs(_Fragment,{children:[n.getWeekDays(o).map((e,t)=>_jsx(DPCellWeekday,{weekDay:e},"weekday"+t)),GetArray(r,e=>_jsx("div",{className:"aio-input-date-space aio-input-date-cell aio-input-theme-bg1",style:{background:i[1]}},"space"+e)),GetArray(a,e=>_jsx(DPCell,{dateArray:[t.year||0,t.month||0,e+1]},"cell"+e)),GetArray(42-(r+a),e=>_jsx("div",{className:"aio-input-date-space aio-input-date-cell aio-input-theme-bg1",style:{background:i[1]}},"endspace"+e))]})}let DPCellWeekday=e=>{let{rootProps:t,translate:n}=useContext(DPContext),{theme:i=Def("theme"),jalali:o}=t,{weekDay:r}=e;return _jsx("div",{className:"aio-input-date-weekday aio-input-date-cell aio-input-theme-bg1 aio-input-theme-color0",style:{background:i[1],color:i[0]},children:_jsx("span",{children:n(r.slice(0,o?1:2))})})};function DPCell(e){let{rootProps:t,translate:n,onChange:i,DATE:o}=useContext(DPContext),{disabled:r,dateAttrs:a,theme:l=Def("theme"),value:u,jalali:s,unit:c=Def("date-unit"),multiple:d}=t,{dateArray:p}=e;function f(){return d?!!u.length&&!!u.find(e=>o.isEqual(p,e)):!!u&&o.isEqual(p,u)}function h(e,t,n,i){var o="aio-input-date-cell";return n&&(o+=" aio-input-date-disabled"),e?o+=" aio-input-date-active aio-input-theme-bg0 aio-input-theme-color1":o+=" aio-input-theme-bg1 aio-input-theme-color0",t&&(o+=" today aio-input-theme-border0"),i&&(o+=" className"),o}let m=f(),g=o.isEqual(p,o.getToday(s)),$={};a&&($=($=a({dateArray:p,isToday:g,isActive:m,isMatch:e=>o.isMatch(p,e)}))||{});let v=!0===r||!0===$.disabled,y=h(m,g,v,$.className),_=v?void 0:()=>{i({year:p[0],month:p[1],day:p[2],hour:p[3]})},b={};v||(b.background=l[1]),-1!==y.indexOf("aio-input-date-active")&&(b.background=l[0],b.color=l[1]),-1!==y.indexOf("today")&&(b.border=`1px solid ${l[0]}`),b={...b,...$.style};let x;if("hour"===c)x=p[3]+":00";else if("day"===c)x=p[2];else if("month"===c){let C=o.getMonths(s);x=n(s?C[p[1]-1]:C[p[1]-1].slice(0,3))}return _jsx("div",{style:b,onClick:_,className:y,children:v?_jsx("del",{children:x}):x})}function DPHeaderItem(e){let{unit:t}=e,{rootProps:n,activeDate:i,months:o}=useContext(DPContext),{theme:r=Def("theme"),jalali:a}=n;if(!i||!i[t])return null;let l="year"===t?i.year:o[i[t]-1].substring(0,a?10:3),u={type:"button",text:l,justify:!0,caret:!1,attrs:{className:"aio-input-date-dropdown aio-input-theme-color0"},popover:{position:"fullscreen",setAttrs(e){if("modal"===e)return{style:{background:r[1],color:r[0]}}},body:e=>_jsx(DPHeaderPopup,{onClose:e.close,unit:t})}};return _jsx(AIOInput,{...u})}let DPHeaderPopup=e=>{let{onClose:t,unit:n}=e,{rootProps:i,DATE:o,translate:r,activeDate:a,changeActiveDate:l}=useContext(DPContext),{jalali:u,theme:s=Def("theme")}=i,[c]=useState(o.getMonths(u)),[d,p]=useState(10*Math.floor(a.year/10)),[f,h]=useState(a.year),[m,g]=useState(a.month);function $(e){"year"===n?(h(e),l({year:e})):(g(e),l({month:e})),t()}function v(e){p(d+10*e)}function y(){let e=[];if("year"===n)for(let t=d;t<d+10;t++){let i=t===f,o="aio-input-date-cell";i?o+=" aio-input-date-active aio-input-theme-bg0 aio-input-theme-color1":o+=" aio-input-theme-bg1 aio-input-theme-color0";let r={style:i?{background:s[0],color:s[1]}:{background:s[1],color:s[0]},className:o,onClick:()=>$(t)};e.push(_createElement("div",{...r,key:t},t))}else for(let a=1;a<=12;a++){let l=a===m,u="aio-input-date-cell";l?u+=" aio-input-date-active aio-input-theme-bg0 aio-input-theme-color1":u+=" aio-input-theme-bg1 aio-input-theme-color0";let p={style:l?{background:s[0],color:s[1]}:{background:s[1],color:s[0]},className:u,onClick:()=>$(a)};e.push(_createElement("div",{...p,key:a},c[a-1]))}return e}function _(){return"year"!==n?null:_jsxs("div",{className:"aio-input-date-popup-header",children:[_jsx(DPArrow,{type:"minus",onClick:()=>v(-1)}),_jsx("div",{className:"aio-input-date-popup-label",children:r("Select Year")}),_jsx(DPArrow,{type:"plus",onClick:()=>v(1)})]})}function b(){return _jsx("div",{className:"aio-input-date-popup-body",children:y()})}function x(){return _jsx("div",{className:"aio-input-date-popup-footer",children:_jsx("button",{className:"aio-input-theme-bg0 aio-input-theme-color0",onClick:()=>t(),children:r("Close")})})}return useEffect(()=>{h(a.year),g(a.month)},[a.year,a.month]),_jsxs("div",{className:"aio-input-date-popup"+(u?" aio-input-date-rtl":" aio-input-date-ltr"),children:[_(),b(),x()]})};function DPHeader(){let{rootProps:e,activeDate:t,changeActiveDate:n,DATE:i}=useContext(DPContext),{unit:o=Def("date-unit")}=e;function r(){if(!t||!t.year||!t.month)return null;let e=GetArray(i.getMonthDaysLength([t.year,t.month]),e=>({text:(e+1).toString(),value:e+1})),o={value:t.day,options:e,onChange:e=>n({day:e})};return _jsx(DPHeaderDropdown,{...o})}return _jsxs("div",{className:"aio-input-date-header",children:[_jsx(DPArrow,{type:"minus"}),_jsxs("div",{className:"aio-input-date-select",children:[_jsx(DPHeaderItem,{unit:"year"}),"month"!==o?_jsx(DPHeaderItem,{unit:"month"}):null,"hour"===o?r():null]}),_jsx(DPArrow,{type:"plus"})]})}function DPHeaderDropdown(e){let{rootProps:t}=useContext(DPContext),{value:n,options:i,onChange:o}=e,{theme:r=Def("theme")}=t;return _jsx(AIOInput,{value:n,options:i,onChange:o,caret:!1,type:"select",attrs:{className:"aio-input-date-dropdown aio-input-theme-bg1 aio-input-theme-color0"},option:{style:()=>({background:r[1],color:r[0]})}})}function DPArrow(e){let{rootProps:t,changeActiveDate:n,activeDate:i,DATE:o}=useContext(DPContext),{type:r,onClick:a}=e,{jalali:l,unit:u=Def("date-unit"),theme:s=Def("theme")}=t;function c(){if(a){a();return}let e=(l?-1:1)*("minus"===r?-1:1),t=[i.year,i.month,i.day];if("month"===u&&n({year:i.year+e}),"day"===u){let s=[];n({year:(s=1===t[1]&&-1===e?[t[0]-1,12]:12===t[1]&&1===e?[t[0]+1,1]:[t[0],t[1]+e])[0],month:s[1]})}if("hour"===u){let c=o.getNextTime(t,864e5*e,l);n({year:c[0],month:c[1],day:c[2]})}}function d(){return I("minus"===r?"mdiChevronLeft":"mdiChevronRight",1,{color:s[0],className:"aio-input-theme-color0"})}return _jsx("div",{className:"aio-input-date-arrow",onClick:()=>c(),children:d()})}let AITableContext=createContext({});function Table(){let{rootProps,DATE}=useContext(AICTX),{paging,getValue={},value,onChange=()=>{},onAdd,onRemove,excel,onSwap,onSearch,rowAttrs,onChangeSort,className,style}=rootProps,[dom]=useState(createRef()),[searchValue,setSearchValue]=useState(""),[columns,setColumns]=useState([]),[searchColumns,setSearchColumns]=useState([]),[excelColumns,setExcelColumns]=useState([]),[temp]=useState({}),[DragRows]=useState(!!onSwap&&new DragClass({callback(e,t){if(!1===DragRows)return;let{dragIndex:n}=e,{dropIndex:i,rows:o}=t,r=DragRows.reOrder(o,n,i),a=o[n],l=o[i];"function"==typeof onSwap?onSwap(r,a,l):onChange(r)}})),[sorts,setSorts]=useState([]);function getColumns(){let{columns:e=[]}=rootProps;e="function"==typeof e?e():e;let t=[],n=[],i=e.map(e=>{let{id:i="aitc"+Math.round(1e6*Math.random()),sort:o,search:r,excel:a}=e,l={...e,_id:i};return r&&t.push(l),a&&n.push(l),l});return setColumns(i),setSearchColumns(t),setExcelColumns(n),i}function getSorts(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n],{_id:o,input:r}=i,a=!0===i.sort?{}:i.sort;if(!a)continue;let{active:l=!1,dir:u="dec"}=a,s;s=a.getValue?a.getValue:e=>{let t=getDynamics({value:i.value,row:e,column:i});return r&&"date"===r.type&&(t=DATE.getTime(t)),t};let c;c=r&&-1!==["number","date","range"].indexOf(r.type)?"number":a.type||"string";let d={dir:u,title:a.title||i.title,sortId:o,active:l,type:c,getValue:s};t.push(d)}setSorts(t)}function getDynamics(p){let{value,row,column,def,rowIndex}=p;if(paging){let{number,size}=paging;rowIndex&&(rowIndex+=(number-1)*size)}let type=typeof value;if("string"===type){let result=value,param={row,column:column,rowIndex:rowIndex};if(getValue[value])result=getValue[value](param);else if(-1!==value.indexOf("row."))try{eval(`result = ${value}`)}catch{result=""}return void 0===result?def:result}return"undefined"===type?def:"function"===type?value({row,column,rowIndex}):void 0===value?def:value}function add(){"function"==typeof onAdd?onAdd():onChange([{...onAdd},...value])}function remove(e,t){let n=()=>onChange(value.filter(t=>t._id!==e._id));"function"==typeof onRemove?onRemove({row:e,action:n,rowIndex:t}):n()}function exportToExcel(){let e=[];if("function"==typeof rootProps.excel)e=rootProps.excel(value);else for(let t=0;t<value.length;t++){let n=value[t],i={};for(let o=0;o<excelColumns.length;o++){let r=excelColumns[o],{excel:a,value:l}=r,u="";if(!0===a)u="string"==typeof r.title?r.title:"untitle";else{if("string"!=typeof a)continue;u=a}i[u]=getDynamics({value:l,row:n,column:r,rowIndex:t})}e.push(i)}ExportToExcel(e,{promptText:"string"==typeof excel?excel:"Inter Excel File Name"})}function getSearchedRows(e){return!0===onSearch&&searchColumns.length&&searchValue?AIOInputSearch(e,searchValue,(e,t)=>{let n="";for(let i=0;i<searchColumns.length;i++){let o=searchColumns[i],r=getDynamics({value:o.value,row:e,def:"",column:o,rowIndex:t});r&&(n+=r+" ")}return n}):e}function sortRows(e,t){return e?t&&t.length?e.sort((e,n)=>{for(let i=0;i<t.length;i++){let{dir:o,getValue:r}=t[i];if(!r)break;let a=r(e),l=r(n);if(a<l)return -1*("dec"===o?-1:1);if(a>l)return 1*("dec"===o?-1:1);if(i===t.length-1)break}return 0}):e:[]}function getSortedRows(e){if(temp.isInitSortExecuted||onChangeSort)return e;let t=sorts.filter(e=>!1!==e.active);if(!t.length||!e.length)return e;temp.isInitSortExecuted=!0;let n=sortRows(e,t);return onChange(n),n}function getRows(){let e=getSearchedRows(value),t=getSortedRows(e),n=paging&&!paging.serverSide?t.slice((paging.number-1)*paging.size,paging.number*paging.size):t;return{rows:value,searchedRows:e,sortedRows:t,pagedRows:n}}function getCellStyle(e){let t=getDynamics({value:e.width}),n=getDynamics({value:e.minWidth});return{width:t||void 0,flex:t?void 0:1,minWidth:n}}function getCellAttrs(e){let{row:t,rowIndex:n,column:i,type:o}=e,{cellAttrs:r,titleAttrs:a}=i,l=getDynamics({value:"title"===o?a:r,column:i,def:{},row:t,rowIndex:n}),u=getDynamics({value:i.justify,def:!1});return l=AddToAttrs(l,{className:`aio-input-table-${o}`+(u?` aio-input-table-${o}-justify`:""),style:getCellStyle(i)}),"title"===o&&(l.title=getDynamics({value:i.title,def:""})),{...l}}function getRowAttrs(e,t){let n=rowAttrs?rowAttrs({row:e,rowIndex:t}):{},i=AddToAttrs(n,{className:"aio-input-table-row"});return!1!==DragRows&&(i={...i,...DragRows.getDragAttrs({dragIndex:t}),...DragRows.getDropAttrs({dropIndex:t,rows:value})}),i}function search(e){!0===onSearch?setSearchValue(e):"function"==typeof onSearch&&onSearch(e)}function getContext(e){return{ROWS:e,rootProps,columns,sorts,setSorts,sortRows,excelColumns,getCellAttrs,getRowAttrs,add,remove,search,exportToExcel,getDynamics}}useEffect(()=>{let e;getSorts(getColumns())},[]);let ROWS=getRows(),attrs=AddToAttrs(rootProps.attrs,{className:["aio-input aio-input-table",className],style:rootProps.style,attrs:{ref:dom}});return _jsx(AITableContext.Provider,{value:getContext(ROWS),children:_jsxs("div",{...attrs,children:[_jsx(TableToolbar,{}),_jsxs("div",{className:"aio-input-table-unit aio-input-scroll",children:[_jsx(TableHeader,{}),_jsx(TableRows,{})]}),paging?_jsx(TablePaging,{}):""]})})}function TableGap(e){let{rootProps:t}=useContext(AITableContext),{rowGap:n,columnGap:i}=t,{dir:o}=e,r;return r="h"===o?{height:n}:{width:i},_jsx("div",{className:`aio-input-table-border-${o}`,style:r})}function TablePaging(){let{ROWS:e,rootProps:t}=useContext(AITableContext),[n]=useState({timeout:void 0,start:void 0,end:void 0,pages:0});function i(i){if("function"!=typeof t.onChangePaging)return alert("aio-input error => in type table you set paging but forget to set onChangePaging function prop to aio input"),{number:0,size:0};let{number:o,size:r=20,length:a=0,sizes:l=[1,5,10,15,20,30,50,70,100],serverSide:u}=i;u||(a=e.sortedRows.length),-1===l.indexOf(r)&&(r=l[0]);let s=Math.ceil(a/r),c=(o=(o=o>s?s:o)<1?1:o)-3,d=o+3;return n.start=c,n.end=d,n.pages=s,{...i,length:a,number:o,size:r,sizes:l}}let[o,r]=useState(i(t.paging||{size:0,number:0}));function a(e){let a=i({...o,...e});r(a),t.onChangePaging&&(a.serverSide?(clearTimeout(n.timeout),n.timeout=setTimeout(()=>{t.onChangePaging&&t.onChangePaging(a)},800)):t.onChangePaging(a))}useEffect(()=>{t.paging&&r(i(t.paging))},[(t.paging||{size:0,number:0,length:0}).size,(t.paging||{size:0,number:0,length:0}).number,(t.paging||{size:0,number:0,length:0}).length]);let{number:l,size:u,sizes:s}=o,c=[],d=!0;for(let p=n.start;p<=n.end;p++)if(p<1||p>n.pages)c.push(_jsx("button",{className:"aio-input-table-paging-button aio-input-table-paging-button-hidden",children:p},p));else{let f;d?(f=1,d=!1):f=p===Math.min(n.end,n.pages)?n.pages:p,c.push(_jsx("button",{className:"aio-input-table-paging-button"+(f===l?" active":""),onClick:()=>a({number:f}),children:f},f))}function h(){if(!s||!s.length)return null;let e={attrs:{className:"aio-input-table-paging-button aio-input-table-paging-size"},type:"select",value:u,options:s,option:{text:"option",value:"option"},onChange:e=>a({size:e}),popover:{fitHorizontal:!0}};return _jsx(AIOInput,{...e})}return _jsxs("div",{className:"aio-input-table-paging",children:[c,h()]})}function TableRows(){let{ROWS:e,rootProps:t}=useContext(AITableContext),{rowTemplate:n,rowAfter:i=()=>null,rowBefore:o=()=>null,rowsTemplate:r,placeholder:a="there is not any items"}=t,l=e.pagedRows||[],u;if(r)u=r(l);else if(l.length)u=l.map((e,t)=>{let{id:r="ailr"+Math.round(1e7*Math.random())}=e;e._id=void 0===e._id?r:e._id;let a=t===l.length-1,u;return u=n?n({row:e,rowIndex:t,isLast:a}):_jsx(TableRow,{row:e,rowIndex:t,isLast:a},e._id),_jsxs(Fragment,{children:[o({row:e,rowIndex:t}),u,i({row:e,rowIndex:t})]},e._id)});else{if(!a)return null;u=_jsx("div",{style:{width:"100%",textAlign:"center",padding:12,boxSizing:"border-box"},children:a})}return _jsx("div",{className:"aio-input-table-rows",children:u})}function TableToolbar(){let{add:e,exportToExcel:t,sorts:n,sortRows:i,setSorts:o,search:r,rootProps:a,excelColumns:l}=useContext(AITableContext),{toolbarAttrs:u,toolbar:s,onAdd:c,onSearch:d,onChangeSort:p,onChange:f=()=>{},value:h,addText:m}=a;if(u=AddToAttrs(u,{className:"aio-input-table-toolbar"}),!c&&!s&&!d&&!n.length&&!l.length)return null;function g(e,t){$(n.map(n=>n.sortId===e?{...n,...t}:n))}async function $(e){if(p)!1!==await p(e)&&o(e);else{o(e);let t=e.filter(e=>!1!==e.active);t.length&&f(i(h,t))}}function v(){if(!n.length)return null;let e={popover:{header:{attrs:{className:"aio-input-table-toolbar-popover-header"},title:"Sort",onClose:!1},pageSelector:".aio-input-table"},caret:!1,type:"select",options:n,option:{text:"option.title",checked:"!!option.active",close:()=>!1,value:"option.sortId",after({option:e}){let{dir:t="dec",sortId:n}=e;return _jsx("div",{onClick(e){e.stopPropagation(),g(n,{dir:"dec"===t?"inc":"dec"})},children:I("dec"===t?"mdiArrowDown":"mdiArrowUp",.8)})}},attrs:{className:"aio-input-table-toolbar-button"},text:I("mdiSort",.7),onSwap:(e,t,n)=>$(e),onChange:(e,t)=>g(e,{active:!t.checked})};return _createElement(AIOInput,{...e,key:"sortbutton"})}function y(){let{addText:e}=a;return a.addText?"function"==typeof e?e(h):e:I("mdiPlusThick",.8)}return _jsxs(_Fragment,{children:[_jsxs("div",{...u,children:[s&&_jsx("div",{className:"aio-input-table-toolbar-content",children:"function"==typeof s?s():s}),_jsx("div",{className:"aio-input-table-search",children:!!d&&_jsx(AIOInput,{type:"text",onChange:e=>r(e),after:I("mdiMagnify",.7)})}),v(),!!l.length&&_jsx("div",{className:"aio-input-table-toolbar-button",onClick:()=>t(),children:I("mdiFileExcel",.8)}),!!c&&_jsx("div",{className:"aio-input-table-toolbar-button",onClick:()=>e(),children:y()})]}),_jsx(TableGap,{dir:"h"})]})}function TableHeader(){let{rootProps:e,columns:t}=useContext(AITableContext),{headerAttrs:n,onRemove:i}=e;n=AddToAttrs(n,{className:"aio-input-table-header"});let o=t.map((e,n)=>_jsx(TableTitle,{column:e,isLast:n===t.length-1},e._id)),r=i?_jsxs(_Fragment,{children:[_jsx(TableGap,{dir:"v"}),_jsx("div",{className:"aio-input-table-remove-title"})]}):null;return _jsxs("div",{...n,children:[o,r,_jsx(TableGap,{dir:"h"})]})}function TableTitle(e){let{column:t,isLast:n}=e,{getCellAttrs:i}=useContext(AITableContext),o=i({column:t,type:"title"});return _jsxs(_Fragment,{children:[_jsx("div",{...o,children:o.title}),!n&&_jsx(TableGap,{dir:"v"})]})}function TableRow(e){let{row:t,isLast:n,rowIndex:i}=e,{remove:o,rootProps:r,columns:a,getRowAttrs:l}=useContext(AITableContext);function u(){return a.map((e,n)=>{let o=t._id+" "+e._id;return _jsx(TableCell,{isLast:n===a.length-1,row:t,rowIndex:i,column:e},o)})}let{onRemove:s}=r;return _jsxs(_Fragment,{children:[_jsxs("div",{...l(t,i),children:[u(),s?_jsxs(_Fragment,{children:[_jsx(TableGap,{dir:"v"}),_jsx("button",{className:"aio-input-table-remove",onClick:()=>o(t,i),children:I("mdiClose",.8)})]}):null]},t._id),_jsx(TableGap,{dir:"h"})]})}let TableCell=p=>{let{row,rowIndex,column,isLast}=p,{getCellAttrs,rootProps,getDynamics}=useContext(AITableContext),{onChange=()=>{},value=[]}=rootProps;function setCell(row,column,cellNewValue){column.input&&column.input.onChange?column.input.onChange({value:cellNewValue,row,column}):(row=JSON.parse(JSON.stringify(row)),eval(`${column.value} = cellNewValue`),onChange(value.map(e=>e._id!==row._id?e:row)))}let contentProps={row,rowIndex,column,onChange:column.input?e=>setCell(row,column,e):void 0},key=row._id+" "+column._id;return _jsxs(Fragment,{children:[_jsx("div",{...getCellAttrs({row,rowIndex,column,type:"cell"}),children:_createElement(TableCellContent,{...contentProps,key:key})}),!isLast&&_jsx(TableGap,{dir:"v"})]},key)};function TableCellContent(e){let{row:t,column:n,rowIndex:i,onChange:o}=e,{getDynamics:r}=useContext(AITableContext),a=r({value:n.template,row:t,rowIndex:i,column:n});if(void 0!==a)return a;let l=r({value:n.input,row:t,rowIndex:i,column:n}),u=r({value:n.value,row:t,rowIndex:i,column:n});if(!l)return u;l.justify=l.justify||r({value:n.justify,row:t,rowIndex:i,column:n});let s={type:"text"};for(let c in l){let d=c,p=l[d];-1!==["onChange","onClick"].indexOf(d)?s[d]=p:s[d]=r({value:p,row:t,rowIndex:i,column:n})}return _createElement(AIOInput,{...{...s,value:u,onChange:o,type:l.type},key:t._id+" "+n._id})}function AIOInputSearch(e,t,n){if(!t)return e;function i(e,t){for(let n=0;n<e.length;n++)if(-1===t.indexOf(e[n]))return!1;return!0}let o=t.split(" ");return e.filter((e,t)=>i(o,n?n(e,t):e))}let RangeContext=createContext({}),Range=()=>{let{rootProps:e}=useContext(AICTX),{start:t=0,end:n=360,min:i=t,max:o=n,step:r=1,reverse:a,round:l,vertical:u,multiple:s,text:c,onChange:d,size:p=Def("range-size"),disabled:f,className:h,labels:m=[],rotate:g=0}=e,[v]=useState({dom:createRef(),start:0,index:!1});function y(e){Array.isArray(e)||(e=[e||0]);for(let n=0;n<e.length;n++){let a=e[n]||0;(a=+(a=Math.round((a-t)/r)*r+t).toFixed(GetPrecisionCount(r)))<i&&(a=i),a>o&&(a=o),e[n]=a}return e}let _=y(e.value),b=useRef(_);b.current=_;let[x,C]=useState(N());function N(){if(!Array.isArray(f))return{};let e={};for(let t=0;t<f.length;t++)e["a"+f[t]]=!0;return e}function k(e){return"point"===e?l?100:0:"label"===e?l?116:14:"scale"===e?l?100:14:0}function w(e){d&&(e=y(e),d(s?e:e[0]))}function A(e){if(!0===f||!1!==v.index)return;let t=b.current,n;(!((n=l?q(e.centerAngle):Z(e[u?"yp":"xp"]))<t[t.length-1])||!(n>t[0]))&&(n<t[0]?M(-1):M(1))}function T(e){for(let t=0;t<e.length;t++)if(B(e[t]))return!1;return!0}useEffect(()=>{C(N())},[JSON.stringify(f)]),useEffect(()=>{d&&(clearTimeout(v.timeOut),v.timeOut=setTimeout(()=>{new Swip({reverseX:!!a,reverseY:!!a&&!!u,dom:()=>$(v.dom.current),start(e){let{event:t}=e;if(null!==t.target){let n=$(t.target);if(HasClass(n,"ai-range-point")){let i=n.attr("data-index")||"0";v.index=+i}else v.index=!1;v.start=[...b.current]}return[0,0]},move(e){let{change:t,mousePosition:n}=e;t&&R({dx:t.dx,dy:t.dy,deltaCenterAngle:t.deltaCenterAngle,centerAngle:n.centerAngle})},onClick:function(e){A(e.mousePosition)}})},100))},[R]);let P=(e,t={})=>{let{half:n=!1,range:i=p/(n?2:1)}=t,o=i*e/100,{min:r,max:a}=t;return void 0!==r&&o<r&&(o=r),void 0!==a&&o>a&&(o=a),o},D=(e,t)=>{let[n,i,o,r,a]=e.split(" "),l=1,u=0,s=!1,c="#000",d=!0;try{let f=+n;isNaN(f)&&(f=1),l=f;let h=+i;isNaN(h)&&(h=0);let m=p/2-l/2;(u="offset"===t?m-h:h)>m&&(u=m),u<l/2&&(u=l/2),s="1"===r,d="1"===a,c=o}catch{}return{thickness:l,radius:u,color:c,roundCap:s,full:d}},O=e=>{let[t,n,i,o]=e.split(" "),r=1,a=0,l=!1,u="#000";try{let s=+t;isNaN(s)&&(s=1),r=s;let c=+n;isNaN(c)&&(c=0);(a=p/2-r/2-c)>p-r/2&&(a=p-r/2),a<r/2&&(a=r/2),l="1"===o,u=i}catch{}return{thickness:r,offset:a,color:u,roundCap:l}};function M(e){let t=[...b.current],n=JSON.stringify(t);for(t=S(t,e*r);!T(t)&&JSON.stringify(t)!==n;)n=JSON.stringify(t),t=S(t,e*r);w(t)}function R(e){if(!0===f)return;let t=z(e);w(t)}function L(e){let i=b.current,o,r;return o=0===e?t:i[e-1],r=e===i.length-1?n:i[e+1],{before:o,after:r}}function S(e,i,o){let r=e.map(e=>e+i);return r[0]<t||r[r.length-1]>n?o?b.current:e:r}function z(e){let{dx:i,dy:o,deltaCenterAngle:a,centerAngle:s}=e,c=[...v.start],d=v.index;1===c.length&&!1===d&&(d=0);let p;if(!1===d){let f;if(l){let h=a*(n-t)/360;f=h=Math.round(h/r)*r}else f=Math.round(Z(K(u?o:i))/r)*r;let m=S(c,f,!0);p=T(m)?m:b.current}else{let{before:g,after:y}=L(d),_;if(l)_=Math.round(q(s)/r)*r;else{let x=Math.round(Z(K(u?o:i))/r)*r;_=c[d]+x}_>y&&(_=y),_<g&&(_=g),B(_)&&(_=b.current[d]),c[d]=_,p=c}return p}function H(){return u?a?"bottom":"top":a?"right":"left"}function G(){return u?"left":"top"}function B(e){return!!x[`a${e}`]}function j(){let e="ai-range";return l?e+=" ai-range-round":e+=` ai-range-${u?"vertical":"horizontal"}`,h&&(e+=" "+h),a&&(e+=" ai-range-reverse"),e}function V(){let{style:t}=e,n;return{...n=l?{width:p,height:p}:u?{width:p}:{height:p},...t}}function X(){let{attrs:t={}}=e,n=V();return AddToAttrs(t,{className:j(),style:n,attrs:{ref:v.dom}})}function E(){return _jsxs("div",{...X(),children:[_jsx(RangeGroove,{}),void 0!==c&&_jsx("div",{className:"ai-range-text",children:"function"==typeof c?c():c},"rangetext"),!l&&_jsxs(Fragment,{children:[_jsx(RangeRanges,{}),_jsx(RangeFills,{})]},"rangefill"),_jsx(RangeSvg,{}),m.map((e,t)=>_jsx(RangeLabel,{label:e},t)),_.map((e,t)=>_jsx(RangeValueContainer,{index:t,itemValue:e},"rangecontainervalue"+t))]})}function F(e){let i=l=l||1,o=(1-i)*(n-t)/i;return e>n+o/2&&(e=t-o+e-n),e}function q(e){let i=360*(l||1),o=360-i;a&&(e=180-e),e-=g,e-=o/2,e-=90;let r=(e=U(e))*(n-t)/i;return F(r)}function Y(e,i){let o=360*l,r=360-o,u=e*o/(n-t);return u+=90,u+=r/2,u+=g,u+=i||0,a?u=180-u:u}function U(e){return(e%=360)<0?e=360+e:e}function W(e){return 100*(e-t)/(n-t)}function Z(e){return e*(n-t)/100}function K(e){return 100*e/$(v.dom.current)[u?"height":"width"]()}function J(){return{getXPByValue:W,rootProps:e,fixAngle:U,getAngleByValue:Y,dom:v.dom,getCircleByStr:D,getRectByStr:O,isValueDisabled:B,value:b.current,getSide:H,getOffset:G,getDefaultOffset:k,sbp:P}}return _jsx(RangeContext.Provider,{value:J(),children:E()})},RangeGroove=()=>{let{rootProps:e}=useContext(RangeContext),t=AddToAttrs(e.grooveAttrs,{className:"ai-range-groove"});return e.round?null:_jsx("div",{...t})},RangeSvg=()=>{let{rootProps:e,value:t}=useContext(RangeContext),{round:n,ranges:i=[],circles:o=[],size:r=Def("range-size"),end:a=360}=e;if(!n||!(i||[0]).length&&!o.length)return null;let l=[_jsx(RangeCircles,{}),_jsx(RangeRanges,{})];return _jsx("svg",{style:{position:"absolute",left:0,top:0},width:r,height:r,children:l})},RangeCircles=()=>{let{rootProps:e,getCircleByStr:t}=useContext(RangeContext),{start:n=0,end:i=360,circles:o=[],size:r=Def("range-size")}=e,a=[];for(let l=0;l<o.length;l++){let u=n,s=i,{thickness:c,color:d,radius:p,roundCap:f,full:h}=t(o[l],"radius"),m={thickness:c,color:d,from:u,to:s,radius:p,full:h,roundCap:f};a.push(_jsx(RangeArc,{...m}))}return _jsx(_Fragment,{children:a})},RangeFills=()=>{let{rootProps:e,value:t}=useContext(RangeContext),{start:n=0,fill:i,round:o}=e;if(o||!1===i)return null;let r=1===t.length?[n,t[0]]:[...t],a=[];for(let l=1;l<r.length;l++){let{thickness:u,style:s,className:c,color:d}=("function"==typeof i?i(l):i)||{},p=r[l-1],f=r[l],h="ai-range-fill";c&&(h+=" "+c);let m={thickness:u,color:d,from:p,to:f,className:h,style:s};a.push(_createElement(RangeRect,{...m,key:"fill"+l}))}return _jsx(_Fragment,{children:a})},RangeRanges=()=>{let{rootProps:e,getCircleByStr:t,getRectByStr:n}=useContext(RangeContext),{start:i=0,ranges:o=[],round:r}=e,a=[],l=i,u=o;for(let s=0;s<u.length;s++){let[c,d]=u[s],p=c,f;if(r){let{thickness:h,color:m,radius:g,roundCap:$}=t(d,"offset");f=_jsx(RangeArc,{thickness:h,color:m,from:l,to:p,radius:g,roundCap:$,full:!1})}else{let{thickness:v,color:y,offset:_,roundCap:b}=n(d);f=_createElement(RangeRect,{thickness:v,color:y,from:l,to:p,offset:_,roundCap:b,className:"ai-range-range",key:"range"+s})}a.push(f),l=p}return _jsx(_Fragment,{children:a})},RangeValueContainer=e=>{let{rootProps:t,isValueDisabled:n,fixAngle:i,getAngleByValue:o,getXPByValue:r,dom:a,getSide:l}=useContext(RangeContext),{itemValue:u,index:s}=e,{round:c}=t,d=i(o(u));function p(){let e;return e=c?{transform:`rotate(${d}deg)`}:{[l()]:r(u)+"%"},{className:"ai-range-value-container",draggable:!1,style:e}}let f={value:u,index:s,disabled:n(u),angle:d,parentDom:a};return _jsxs("div",{...p(),children:[_createElement(RangeHandle,{...f,key:"handle"})," ",_createElement(RangePoint,{...f,key:"point"})]})},RangeRect=({thickness:e,color:t,from:n,to:i,className:o,style:r,offset:a,roundCap:l})=>{let{getXPByValue:u,rootProps:s,getSide:c}=useContext(RangeContext),{vertical:d}=s,p=u(n),f={[d?"height":"width"]:u(i)-p+"%"},h={[d?"width":"height"]:e},m={[c()]:p+"%"},g=a?{[d?"left":"top"]:a}:{},$=l?{borderRadius:"100%"}:{},v={background:t};return _jsx("div",{className:o,style:{...f,...h,...m,...g,...$,...v,...r}})},RangeArc=({thickness:e,color:t,from:n,to:i,radius:o,full:r,roundCap:a})=>{let{fixAngle:l,getAngleByValue:u,rootProps:s}=useContext(RangeContext),{size:c=Def("range-size"),reverse:d}=s,p,f,h=c/2,m=c/2;if(r)p=0,f=360;else{let g=l(u(n)+90),$=l(u(i)+90);0===$&&($=360),p=g,f=$,d&&(f=g,p=$)}return _jsx("path",{d:svgArc(h,m,o,p,f),stroke:t,strokeWidth:e,fill:"transparent",strokeLinecap:a?"round":void 0},`from${n}to${i}`)},RangePoint=e=>{let{rootProps:t,getOffset:n,sbp:i}=useContext(RangeContext),[o]=useState({dom:createRef()}),{value:r,disabled:a,angle:l,index:u,parentDom:s}=e;if(!1===t.point)return null;let{round:c,size:d=Def("range-size")}=t,{attrs:p={},html:f=r,offset:h=0}=(t.point||(()=>{}))(r,{disabled:a,angle:l,value:r,index:u})||{},m=getEventAttrs("onMouseDown",()=>{let e=$(s.current).find("ai-range-value-container");e.css({zIndex:10}),e.eq(u).css({zIndex:100})}),g,v={...p.style};g=c?{left:d/2+h,transform:`rotate(${-l}deg)`}:{[n()]:h};let y={ref:o.dom,className:"ai-range-point-container",style:g,draggable:!1},_=AddToAttrs(p,{className:["ai-range-point"],style:v,attrs:{draggable:!1,"data-index":u,...m}});return _createElement("div",{...y,key:"rangepoint"+u},_jsx("div",{..._,children:f}))},RangeHandle=e=>{let{rootProps:t,sbp:n}=useContext(RangeContext),{value:i,angle:o,disabled:r,index:a}=e,{handle:l=()=>{},round:u}=t;if(!1===l||!u)return null;if(l&&"function"!=typeof l)return alert(`aio-input error => in type round, handle props should be a function,
        handle type = (value:number,{disabled:boolean,angle:number})=>{attrs:any}`),null;let{sharp:s=!1,thickness:c=10,size:d=90,color:p="#000",offset:f=0}=l(i,{angle:o,disabled:r,value:i})||{},h=n(d,{half:!0}),m=n(c,{half:!0});function g(){return s?{[h<0?"borderRight":"borderLeft"]:`${Math.abs(h)}px solid ${p}`,borderTop:`${m/2}px solid transparent`,borderBottom:`${m/2}px solid transparent`,left:f}:{width:h,height:m,left:f,background:p}}let $=AddToAttrs({},{className:"aio-input-handle",style:g(),attrs:{draggable:!1}});return _createElement("div",{...$,key:"rangehandle"+a})},RangeLabel=e=>{let{dom:t,rootProps:n}=useContext(RangeContext),{label:i}=e,{zIndex:o,dynamic:r,step:a,list:l=[]}=i,{round:u,start:s=0,end:c=360,reverse:d,vertical:p}=n,[f]=useState(h);function h(){return v(!0)}function m(){let e=[];if(a){let{start:t=s,end:n=c}=i;for(let o=t;o<=n;o+=a)e.push(o)}for(let r=0;r<l.length;r++)-1===e.indexOf(l[r])&&e.push(l[r]);return e}function g(){if(u||!i.autoHide||p)return;let e=$(t.current).find(".ai-range-label");if(!e.length)return;let n=e.eq(0),o="yes"===n.attr("data-rotated")?"height":"width",r=n.offset().left+(d?0:n[o]());for(let a=1;a<e.length;a++){let l=e.eq(a),s="yes"===l.attr("data-rotated")?"height":"width";l.css({display:"flex"});let c=l.offset().left,f=l[s](),h=c+f;d?h>r-5?l.css({display:"none"}):r=c:c<r+5?l.css({display:"none"}):r=c+f}}function v(e){return e||r?_jsx("div",{className:"ai-range-labels",style:{zIndex:o},children:m().map(e=>_jsx(RangeLabelItem,{label:i,itemValue:e},e))}):f}return useEffect(()=>{$(window).on("resize",g)},[]),useEffect(()=>{g()}),_jsx(_Fragment,{children:v(!1)})},RangeLabelItem=e=>{let{rootProps:t,isValueDisabled:n,fixAngle:i,getAngleByValue:o,getXPByValue:r,getSide:a}=useContext(RangeContext),{label:l,itemValue:u}=e,{round:s,vertical:c,size:d=Def("range-size")}=t,p;s&&(p=i(o(u)));let f=n(u);function h(e){return s?{transform:`rotate(${p}deg)`}:{[a()]:r(u)+"%",...e}}function m(e,t){let n={};return s&&(n={...n,...t},e.fixAngle&&(n={...n,transform:`rotate(${-p}deg)`})),{width:0,height:0,...n}}function g(){let e=l.setting(u,{disabled:f,angle:p}),{offset:t=0,html:n=""}=e,i={[s||c?"left":"top"]:d/2+t},o={className:"ai-range-label-container",style:h(i),draggable:!1},r=AddToAttrs({},{className:["ai-range-label"],style:m(e,i),attrs:{draggable:!1}});return{html:n,textProps:r,containerProps:o}}let{html:$,textProps:v,containerProps:y}=g();return _jsx("div",{...y,children:_jsx("div",{...v,children:$})})};export const SideMenu=e=>{let{items:t=[],onChange:n,option:i={},type:o="normal"}=e,r="aio-input-sidemenu",a=useRef(e=>{});function l(e){let{badge:t}=e;if(t||(t=[]),Array.isArray(t)||(t=[t]),!t.length)return[];let n=[];for(let i=0;i<t.length;i++){let{text:o,color:a="red",circle:l}=t[i];n.push(_jsx("div",{className:`${r}-badge ${r}-align ${r}-badge-${a}${l?" "+r+"-badge-circle":""}`,children:o}))}return n}function u(e,t){let{items:n=[]}=e,i=l(e);return _jsxs("div",{className:`${r}-after ${r}-align`,children:[!!i.length&&i,!!n.length&&I(t?"mdiChevronDown":"mdiChevronRight",.7)]})}function s(e){let{icon:t=I("mdiCircleMedium",.6)}=e;return t?_jsx("div",{className:`${r}-before`,children:_jsx("div",{className:`${r}-icon ${r}-align`,children:t})}):null}let c={text:"option.text",value:"option.value",toggleIcon:()=>!1,after:({option:e,active:t})=>u(e,!!t),before:({option:e})=>s(e),onClick({option:e}){let{items:t=[],value:i}=e;t.length?a.current(i):e.onClick?e.onClick():n&&n(e)},className:({level:e})=>`${r}-row-level-${e}`},d={...c,...i,className(e){let t=`${r}-row-level-${e.level}`;if("function"==typeof i.className){let n=i.className(e);n&&(t+=" "+n)}return t}},p=AddToAttrs(e.attrs,{className:[r,`aio-input-sidemenu-${o}`,e.className]});return _jsx(AIOInput,{...p,className:p.className,type:"tree",size:48,toggleRef:a,value:[...t],getChilds:e=>e.row.items||[],option:d,indent:0})};export const AICard=({text:e,subtext:t,onClick:n,before:i,after:o})=>_jsxs("div",{className:"aio-input-card",children:[void 0!==i&&_jsx("div",{className:"aio-input-card-before",onClick:e=>e.stopPropagation(),children:i}),_jsxs("div",{className:"aio-input-card-body",onClick:n,children:[_jsx("div",{className:"aio-input-card-text",children:e}),void 0!==t&&_jsx("div",{className:"aio-input-card-subtext",children:t})]}),void 0!==o&&_jsx("div",{className:"aio-input-card-after",onClick:e=>e.stopPropagation(),children:o})]});export const AIPanel=({text:e,subtext:t,before:n,after:i,body:o})=>{function r(){return _jsxs("div",{className:"aio-input-panel-header",children:[_jsx("div",{className:"aio-input-panel-before",children:!!n&&n}),_jsxs("div",{className:"aio-input-panel-texts",children:[_jsx("div",{className:"aio-input-panel-text",children:e}),void 0!==t&&_jsx("div",{className:"aio-input-panel-subtext",children:t})]}),_jsx("div",{className:"aio-input-panel-after",children:!!i&&i})]})}function a(){return _jsx("div",{className:"aio-input-panel-body",children:o})}return _jsxs("div",{className:"aio-input-panel",children:[r()," ",a()]})};export const AISwitch=({colors:e=["#555","orange"],size:t=[16,2,3,48],value:n,onChange:i=()=>{}})=>{function o(){return{paddingRight:t[0]+t[1],paddingLeft:t[1],border:`${t[2]}px solid ${n?e[1]:e[0]}`}}function r(){return{width:t[3]-t[0]-t[1],height:t[0]+2*t[1]}}function a(){return{width:t[0],height:t[0],top:`calc(50% - ${t[0]/2}px)`,background:n?e[1]:e[0]}}return _jsx("div",{className:`aio-input-switch${n?" active":""}`,style:o(),onClick:()=>i(!n),children:_jsx("div",{className:"aio-input-switch-outer",style:r(),children:_jsx("div",{className:"aio-input-switch-inner",style:a()})})})};export function AIOInput_defaultProps(e){let t=new Storage("aio-input-storage");for(let n in e)t.save(n,e[n])}function getTypes(e){function t(){return -1!==["select","date","time"].indexOf(n)||-1!==["text","number","textarea"].indexOf(n)&&!!e.options||"button"===n&&!!e.popover}let{type:n,multiple:i}=e,o;return o="table"===n||"tags"===n||-1!==["radio","range","file","buttons","select","date","acardion"].indexOf(n)&&!!i,{isMultiple:o,isInput:-1!==["text","number","textarea","password"].indexOf(n),isDropdown:t(),hasOption:-1!==["text","number","textarea","color","select","radio","tabs","list","buttons","tags"].indexOf(n),hasPlaceholder:-1!==["text","number","textarea","color","select","table","image","date"].indexOf(n),hasKeyboard:-1!==["text","textarea","number","password"].indexOf(n),hasText:-1!==["checkbox","button","select"].indexOf(n),hasSearch:-1!==["table","select"].indexOf(n)}}function getDefaultProps(e,t){let n=Array.isArray(e.value)?"array":typeof e.value;return"select"===(e={...e}).type?e.multiple&&void 0===e.text&&(e.text="Select Items"):"time"===e.type?e.value||(e.value={}):"acardion"===e.type?e.deSelect=!0:"date"===e.type&&e.multiple&&(e.option={...e.option,text:"option",value:"option"}),!0===e.loading&&(e.disabled=!0),t.isMultiple?e.value?"array"!==n&&(e.value=[e.value]):e.value=[]:"tree"===e.type||"array"===n&&(e.value=e.value[0]),e}function Def(e){return({theme:[],"date-size":180,"tree-size":36,"range-size":72,"date-unit":"day"})[e]}function I(e,t,n){return new GetSvg().getIcon(e,t,n)}function GetOptions(e){let{options:t,rootProps:n,types:i,level:o,isOpen:r,change:a,defaultOptionProps:l={}}=e,{deSelect:u}=n,s=[],c={},d=i.isDropdown&&i.hasOption&&!!n.onSwap;function p(e){return"select"===n.type&&i.isMultiple?-1!==n.value.indexOf(e):"radio"===n.type?i.isMultiple?-1!==n.value.indexOf(e):n.value===e:void 0}function f(e){return"tree"===n.type?!!r&&!!r(e):i.isMultiple?-1!==n.value.indexOf(e):e===n.value}u&&"function"!=typeof u&&!0!==u&&(t=[u,...t]);for(let h=0;h<t.length;h++){let m=t[h],g={option:m,index:h,active:!1,level:o,rootProps:n,change:a?e=>{a&&a(m,e)}:void 0},$=!!n.disabled||!!n.loading||!!GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"disabled"}),v=GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"show"});if(!1===v)continue;let y=GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"value"}),_=f(y),b=GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"text"});g.active=_;let x=GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"attrs",def:{}}),C=p(y),N=GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"checked",def:C}),k={show:v,loading:n.loading,attrs:x,text:b,value:y,disabled:$,draggable:d,checkIcon:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"checkIcon"})||n.checkIcon,checked:N,toggleIcon:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,def:!0,key:"toggleIcon"}),before:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"before"}),after:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"after"}),justify:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"justify"}),subtext:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"subtext"}),onClick:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"onClick",preventFunction:!0}),className:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"className"}),style:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"style"}),tagAttrs:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"tagAttrs"}),tagBefore:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"tagBefore"}),close:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"close",def:!i.isMultiple}),tagAfter:GetOptionProps({rootProps:n,optionDetails:g,defaultOptionProps:l,key:"tagAfter"}),details:g};s.push(k),c["a"+k.value]=k}return{optionsList:s,optionsDic:c}}function GetOptionProps(p){let{rootProps,key,def,preventFunction,optionDetails,defaultOptionProps={}}=p,{option}=optionDetails,optionResult="function"!=typeof option[key]||preventFunction?option[key]:option[key](optionDetails);if(void 0!==optionResult)return optionResult;let prop=(rootProps.option||{})[key];if("string"==typeof(prop=void 0===prop?defaultOptionProps[key]:prop))try{let value;return eval("value = "+prop),value}catch{}if("function"==typeof prop&&!preventFunction){let res=prop(optionDetails);return void 0===res?def:res}return void 0!==prop?prop:def}function getTimeByUnit(e,t){let{value:n={},jalali:i,unit:o={year:!0,month:!0,day:!0}}=e;function r(){let e=new AIODate().getToday(i);return{year:e[0],month:e[1],day:e[2],hour:e[3],minute:e[4],second:e[5]}}let a=r(),l={},u;for(u in o)if(!0===o[u]){let s=n[u],c={year:1e3,month:1,day:1,hour:0,minute:0,second:0}[u],d={year:3e3,month:12,day:31,hour:23,minute:59,second:59}[u];(void 0!==s&&"number"!=typeof s||s<c||s>d)&&alert(`aio input error => in type time value.${u} should be an number between ${c} and ${d}`);let p=void 0===s||t?a[u]:s;l[u]=p}return l}function getTimeText(e){let t=getTimeByUnit(e);if(!t)return"string"==typeof e.placeholder?e.placeholder:"string"==typeof e.text?e.text:"";if(e.pattern)return new AIODate().getDateByPattern(t,e.pattern);if(void 0!==e.text)return e.text;let n=[],i=[];void 0!==t.year&&i.push(Get2Digit(t.year)),void 0!==t.month&&i.push(Get2Digit(t.month)),void 0!==t.day&&i.push(Get2Digit(t.day)),i.length&&n.push(i.join("/"));let o=[];return void 0!==t.hour&&o.push(Get2Digit(t.hour)),void 0!==t.minute&&o.push(Get2Digit(t.minute)),void 0!==t.second&&o.push(Get2Digit(t.second)),o.length&&n.push(o.join(":")),n.join(" ")}export const AIText=e=>_jsx(AIOInput,{...e,type:"text"});export const AINumber=e=>_jsx(AIOInput,{...e,type:"number"});export const AITextarea=e=>_jsx(AIOInput,{...e,type:"textarea"});export const AIPassword=e=>_jsx(AIOInput,{...e,type:"password"});export const AIColor=e=>_jsx(AIOInput,{...e,type:"color"});export const AISelect=e=>_jsx(AIOInput,{...e,type:"select"});export const AIRadio=e=>_jsx(AIOInput,{...e,type:"radio"});export const AITabs=e=>_jsx(AIOInput,{...e,type:"tabs"});export const AIButtons=e=>_jsx(AIOInput,{...e,type:"buttons"});export const AITags=e=>_jsx(AIOInput,{...e,type:"tags"});export const AITree=e=>_jsx(AIOInput,{...e,type:"tree"});export const AIImage=e=>_jsx(AIOInput,{...e,type:"image"});export const AIFile=e=>_jsx(AIOInput,{...e,type:"file"});export const AICheckbox=e=>_jsx(AIOInput,{...e,type:"checkbox"});export const AIDate=e=>_jsx(AIOInput,{...e,type:"date"});export const AITime=e=>_jsx(AIOInput,{...e,type:"time"});export const AISlider=e=>_jsx(AIOInput,{...e,type:"slider"});export const AISpinner=e=>_jsx(AIOInput,{...e,type:"spinner"});export const AIAcardion=e=>_jsx(AIOInput,{...e,type:"acardion"});export const AIList=e=>_jsx(AIOInput,{...e,type:"list"});export const AITable=e=>_jsx(AIOInput,{...e,type:"table"});export const MonthCalendar=({date:e,onClick:t=()=>{},dateAttrs:n=()=>({})})=>{let i=new AIODate,[o]=useState(i.isJalali(e)),[r]=useState(i.getMonths(o)),[a]=useState(i.getWeekDay([e[0],e[1],1]).index),[l]=useState(i.getMonthDaysLength(e));function u(){return i.getWeekDays(!0).map(e=>_jsx("div",{className:"month-calendar-weekday",children:e[0]}))}function s(){return Array(a).fill(0).map(()=>_jsx("div",{className:""}))}function c(){return Array(l).fill(0).map((t,n)=>d([e[0],e[1],n+1]))}function d(e){let i=AddToAttrs(n(e),{className:"month-calendar-day",attrs:{onClick:()=>t(e)}});return _jsx("div",{...i,children:e[2]})}return _jsxs("div",{className:"month-calendar",children:[_jsx("div",{className:"month-calendar-title",children:r[e[1]-1]}),_jsx("div",{className:"month-calendar-weekdays",children:u()}),_jsxs("div",{className:"month-calendar-days",children:[s()," ",c()]})]})};let PrismCode=({code:e,language:t="js",style:n={}})=>(useEffect(()=>{Prism.highlightAll()},[]),_jsx("div",{className:"aio-doc-code",style:n,children:_jsx("pre",{style:{height:"100%",overflow:"auto"},children:_jsx("code",{className:`language-${t}`,children:e})})}));export function Code(e,t,n){return _jsx(PrismCode,{code:e,language:t,style:n})}export const AILogin=e=>{let{renderApp:t,translate:n=()=>{},id:i,rememberTime:o,checkToken:r,splash:a,otpLength:l=4}=e,{validation:u=()=>{}}=e,[s,c]=useState(),[d]=useState(new Storage("ai-login"+i)),[p,f]=useState(y),h=useRef(p);h.current=p;let[m,g]=useState(v());function $(){return e.mode?e.mode:e.userpass?"userpass":e.otp?"otpnumber":"userpass"}function v(t){let n={userNameInput:()=>null,passwordInput:()=>null,key:"userpass",title:null,submitText:"",registerInputs:()=>null,responseUserType:!1},i=t||$();if("userpass"===n.key)n.userNameInput=()=>_jsx(AIText,{...B("userName")}),n.passwordInput=()=>_jsx(AIPassword,{...B("password"),preview:!0}),n.responseUserType=!0;else if("register"===n.key){if(n.userNameInput=()=>_jsx(AIText,{...B("userName")}),n.passwordInput=()=>_jsx(AIPassword,{...B("password"),preview:!0}),e.register&&e.registerInputs&&e.registerInputs.length){let o=(e.registerInputs||(()=>[]))(h.current)||[];n.registerInputs=()=>{let t=h.current;return _jsxs(_Fragment,{children:[_jsx(AIPassword,{...B("rePassword"),preview:!0}),o.map(n=>{let i=t.register[n.field];return _jsx(AIOInput,{rtl:e.rtl,label:e.label(n.field),...n,showErrors:!1,reportError:e=>G(n.field,e),value:i,onChange:e=>f({...t,register:{...t.register,[n.field]:e}})},n.field)})]})}}}else"otpnumber"===n.key?n.userNameInput=()=>_jsx(AIText,{...B("otpNumber"),justNumber:!0,maxLength:11}):"otpcode"===n.key&&(n.passwordInput=()=>_jsx(AIText,{...B("otpCode"),justNumber:!0,maxLength:l}),n.responseUserType=!0);return n.submitText=A(i+"Button"),n.title=_jsx("div",{className:"ai-login-title",children:A(i+"Title")}),n}function y(){let t={userName:"",password:"",rePassword:"",otpNumber:"",otpCode:"",register:{}};if(!e.register)return t;if(e.registerInputs){let n=e.registerInputs(t),i={};for(let o=0;o<n.length;o++)i[n[o].field]=n[o].defaultValue;t.register=i}return t}let[_,b]=useState({}),[x,C]=useState(!0),[N,k]=useState(!!a),[w]=useState(new AIOPopup);function A(t){let{otp:i}=e,o={registerButton:{en:"Register",fa:"ثبت نام"},userpassButton:{en:"Login",fa:"ورود"},otpnumberButton:{en:"Send Number",fa:"ارسال شماره همراه"},otpcodeButton:{en:"Login",fa:"ورود"},registerTitle:{en:"Register",fa:"ثبت نام"},userpassTitle:{en:"Login",fa:"ورود"},otpcodeTitle:{en:"OTP Code",fa:"کد یکبار مصرف"},otpnumberTitle:{en:"Phone Number",fa:"شماره همراه"},switchuserpass:{en:"login by user name",fa:"ورود با نام کاربری"},switchregister:{en:"Go To Register",fa:"ثبت نام"},switchotp:{en:"login by otp",fa:"ورود با رمز یکبار مصرف"},rePasswordMatch:{en:"Password is not match with Re password",fa:"رمز عبور با تکرار آن مطابقت ندارد"},userNameRequired:{en:"User Name is required",fa:"نام کاربری ضروری است"},passwordRequired:{en:"password is required",fa:"رمز عبور ضروری است"},rePasswordRequired:{en:"Re Password is required",fa:"تکرار رمز عبور ضروری است"},otpNumberRequired:{en:"Phone Number is required",fa:"شماره همراه ضروری است"},otpCodeLength:{en:`otp code should be ${l} digit`,fa:`کد یکبار مصرف باید ${l} رقم باشد`},registerError:{en:"Registeration failed",fa:"ثبت نام با خطا روبرو شد"},userpassError:{en:"login by userName failed",fa:"ورود با نام کاربری با خطا روبرو شد"},otpcodeError:{en:"login by otp failed",fa:"ورود با کد یکبار مصرف با خطا روبرو شد"},otpnumberError:{en:"send otp number for receive otp code failed",fa:"ارسال شماره همراه برای دریافت کد یکبار مصرف با خطا روبرو شد"}};return"fa"===n?o[t].fa:n(t)||o[t].en}function T(e){d.save("data",e),c(e)}function P(){window.location.reload()}function D(){g(v("otpcode"))}function O(e){d.save("data",e),c(e)}async function M(){return await e.getRequestOptions(h.current,m.key)}async function R(e){let t=m.key,n={userpass:T,register:P,otpnumber:D,otpcode:O}[t],{onSuccess:i}=await M(),o,r;try{r=await i(e)}catch(a){Y({type:"error",text:A(t+"Error"),subtext:a.message});return}"string"==typeof r&&(o=r);let l={userpass:"modes.userpass onSuccess props should returns string as error or {user:any,token:string} as success",register:"modes.register onSuccess props should returns string as error or true as success",otpnumber:"modes.otp.onSubmitNumber onSuccess props should returns string as error or true as success",otpcode:"modes.otp.onSubmitCode onSuccess props should returns string as error or {user:any,token:string} as success"}[t];m.responseUserType?"object"==typeof r&&r.user&&"string"==typeof r.token||(o=l):!0!==r&&(o=l),o?Y({type:"error",text:A(t+"Error"),subtext:o}):n(r)}async function L(){let{url:e,method:t,body:n,onCatch:i}=await M();axios[t](e,n).then(R).catch(e=>{e.message?Y({type:"error",text:"Error",subtext:e.message}):i(e)})}function S(e){f(y()),g(v(e))}function z(e){return{className:"ai-login-mode",onClick:()=>S(e)}}function H(){return _jsxs("div",{className:"ai-login-modes",children:[e.userpass&&"userpass"!==m.key&&_jsx("button",{...z("userpass"),children:A("switchuserpass")}),e.register&&"register"!==m.key&&_jsx("button",{...z("register"),children:A("switchregister")}),e.otp&&"otpnumber"!==m.key&&_jsx("button",{...z("otpnumber"),children:A("switchotp")})]})}function G(e,t){b({..._={..._,[e]:t}})}function B(t){let n=h.current;return{label:e.label(t),validations:e=>j(t,e),showErrors:!1,rtl:e.rtl,reportError:e=>G(t,e),value:n[t],onChange:e=>f({...n,[t]:e})}}function j(t,n){let i=h.current,{otp:o}=e;return n?"otpCode"===t&&o&&(n||"").length<l?A("otpCodeLength"):"rePassword"===t&&n!==i.password?A("rePasswordMatch"):u(t,n):A({otpCode:"",register:"",otpNumber:"otpNumberRequired",userName:"userNameRequired",password:"passwordRequired",rePassword:"rePasswordRequired"}[t])}function V(){let e=Object.keys(_).filter(e=>void 0!==_[e]).map(e=>_[e]);return _jsxs(_Fragment,{children:[_jsx("div",{className:"ai-login-errors",children:e.map((e,t)=>_jsx("div",{className:"ai-login-error",children:e},t))}),_jsx("button",{className:"ai-login-submit",disabled:!!e.length,onClick:()=>L(),children:m.submitText})]})}function X(){let{title:e,userNameInput:t,passwordInput:n,registerInputs:i}=m;return _jsxs("div",{className:"ai-login-form",children:[e,t(),n(),i(),V(),H()]})}let E=t=>_jsx("div",{className:`ai-login-${t}`,children:e[t]});function F(){d.remove("data"),window.location.reload()}async function q(){a&&setTimeout(()=>{k(!1)},a.time);let e=d.load("data",{},o),{user:t,token:n}=e,{url:i,method:l,onSuccess:u,onCatch:s}=await r(n||"");t&&n&&axios[l](i,{headers:{authorization:`Bearer ${n}`}}).then(e=>{let i;try{i=u(e)}catch(o){Y({type:"error",text:"checkToken failed",subtext:_.message});return}!0===i?c({user:t,token:n}):!1===i?F():Y({type:"error",text:"checkToken failed",subtext:"checkToken props should return string as error or true as token is valid and false as token is invalid"})}).catch(e=>{if(e.message)Y({type:"error",text:"Error",subtext:e.message});else{let t,n="";try{t=s(e)}catch(i){n=i.message}"string"==typeof t?n=t:!1===t?F():n="AILogin checkToken onCatch props should returns string as error or false as invalid token",n&&Y({type:"error",text:"checkToken failed",subtext:n})}}),C(!1)}function Y(e){w.addAlert(e)}function U(){if(x||N)return a?a.html:null;if(!s){let n=AddToAttrs(e.attrs,{className:"ai-login",style:{direction:e.rtl?"rtl":void 0}});return _jsxs("div",{...n,children:[E("before")," ",X()," ",E("after")]})}return t({token:s.token,user:s.user,logout:F})}return useEffect(()=>{q()},[]),_jsxs(_Fragment,{children:[U()," ",w.render()]})};let MAPCTX=createContext({});export const AIMap=e=>{let{zoom:t={value:14},value:n=[35.699939,51.338497],getSearchResult:i,onSearch:o,mapRef:r}=e,[a,l]=useState(null);r&&(r.current=a);let[u,s]=useState(n),c=useRef(void 0);function d(t){s(t),e.onChange&&(clearTimeout(c.current),c.current=setTimeout(()=>{e.onChange&&e.onChange(t)},600))}function p(){return _jsxs("div",{className:"marker-icon",children:[_jsx("div",{className:"marker-icon-circle"}),_jsx("div",{className:"marker-icon-arrow"})]})}function f(){return{pos:u,setMap:l,rootProps:e,move:d,getDefaultMarkerIcon:p}}return useEffect(()=>{null!==a&&a.setView(n,t.value,{animate:!1}),s(n)},[n[0]+"-"+n[1]+"-"+t.value]),_jsx(MAPCTX.Provider,{value:f(),children:_jsxs("div",{className:"ai-map",children:[!!i&&_jsx(MapHeader,{}),_jsx(MapBody,{}),_jsx(MapFooter,{})]})})};let MapBody=()=>{let{rootProps:e,pos:t,setMap:n,getDefaultMarkerIcon:i}=useContext(MAPCTX),{style:o,zoom:r={value:14},dragging:a=!0,children:l,shapes:u=[],marker:s,markers:c=[]}=e,d={width:"100%",height:"100%"};return _jsxs(MapContainer,{center:t,style:{...d,...o},zoom:r.value||14,scrollWheelZoom:r.wheel?"center":void 0,zoomControl:!1!==r.control,attributionControl:!0,dragging:a,ref:n,children:[_jsx(TileLayer,{url:"https://{s}.tile.openstreetmap.de/{z}/{x}/{y}.png"}),_jsx(MapEvents,{}),!1!==s&&_jsx(MapMarker,{pos:t,html:isValidElement(s)?s:i()},"main-marker"),c.map((e,t)=>_jsx(MapMarker,{pos:e.pos,html:e.html},`marker-${t}`)),u.map((e,t)=>_jsx(MapShape,{shape:e},t)),_jsx(MapLayers,{}),l]})},MapHeader=()=>{let{rootProps:e,move:t}=useContext(MAPCTX),{getSearchResult:n,onSearch:i}=e,[o,r]=useState(""),[a,l]=useState([]),u=useRef();function s(e){r(e),clearTimeout(u.current),u.current=setTimeout(async()=>{if(n){let t=await n(e);Array.isArray(t)&&l(t)}},1200)}return _jsx("div",{className:"ai-map-header",children:_jsx(AIOInput,{type:"text",value:o,options:a||[],before:I("mdiMagnify",.8),onChange:e=>s(e),option:{onClick({option:e}){i&&i(e)}}})})},MapLayers=()=>{let{rootProps:e}=useContext(MAPCTX),{layers:t}=e;if(!t)return null;let{position:n="topright",items:i=[]}=t;return _jsx(LayersControl,{position:n,children:i.map((e,t)=>{let{shapes:n=[],markers:i=[],active:o=!0}=e;return _jsxs(LayersControl.Overlay,{name:e.name,checked:o,children:[i.length?i.map((e,t)=>_jsx(MapMarker,{pos:e.pos,html:e.html},t)):null,n.length?n.map((e,t)=>_jsx(MapShape,{shape:e},"shape"+t)):null]},t)})})},MapShape=({shape:e})=>{let{style:t={},type:n}=e,{stroke:i={},fill:o={}}=t,{width:r=4,dash:a,color:l="orange"}=i,{color:u="orange",opacity:s=.3}=o,c={fillColor:u,color:l,fillOpacity:s,weight:r,dashArray:a};if("circle"===n){let{center:d,radius:p=100}=e;return _jsx(Circle,{center:d,pathOptions:c,radius:p})}return"rect"===n?_jsx(Rectangle,{bounds:e.points,pathOptions:c}):"polyline"===n?_jsx(Polyline,{positions:e.points,pathOptions:c}):null},MapFooter=()=>{let{rootProps:e,pos:t}=useContext(MAPCTX),{submitText:n="Submit",onSubmit:i,footer:o}=e;return i||o?_jsxs("div",{className:"ai-map-footer",children:[!!i&&_jsx("button",{type:"button",onClick:()=>i(t),children:n}),_jsx("div",{className:"ai-map-footer-html",children:o||null})]}):null},MapMarker=({pos:e,html:t})=>{let{getDefaultMarkerIcon:n}=useContext(MAPCTX);function i(e){return divIcon({html:JSXToHTML(e),className:"",iconSize:[32,32],iconAnchor:[16,32]})}t=t||n();let o={position:e};return t&&(o.icon=i(t)),_jsx(Marker,{...o,animate:!1})};function MapEvents(){let{rootProps:e,move:t}=useContext(MAPCTX);return useMapEvents({click:()=>e.onClick?e.onClick():void 0,move(n){if(!1===e.dragging)return;let{lat:i,lng:o}=n.target.getCenter();t([i,o])},zoom(t){e.onChangeZoom&&e.onChangeZoom(t.target._zoom)},locationfound(e){console.log("location found:",e)}}),null}export const AIApp=e=>{let[t,n]=useState();function i(){if(e.bottomMenu.value){let t=e.bottomMenu.options.find(t=>!1!==t.show&&t.value===e.bottomMenu.value);t&&n(t.value)}let i=e.bottomMenu.options.filter(e=>!1!==e.show);i.length&&n(i[0].value)}function o(){return{bottomMenuValue:t||""}}function r(){if(!e.header)return null;let t=e.header(o());return!1===t?null:_jsx("div",{className:"ai-app-header",children:t})}function a(){return _jsx("div",{className:"ai-app-body",children:e.body({bottomMenuValue:t||""})})}function l(){return _jsx(AIBottomMenu,{options:e.bottomMenu.options,value:t||"",onChange:e=>n(e)})}useEffect(()=>{i()},[e.bottomMenu.value]);let u=AddToAttrs(e.attrs,{className:"ai-app"});return _jsxs("div",{...u,children:[r(),a(),l(),!!e.children&&e.children]})};let AIBottomMenu=({options:e,value:t,onChange:n})=>{function i(e){if(!1===e.show)return null;let i=e.value===t;return _jsxs("div",{className:`ai-app-bottom-menu-option${i?" active":""}`,onClick:()=>n(e.value),children:[!!e.before&&e.before,_jsxs("div",{className:"ai-app-bottom-menu-option-body",children:[void 0!==e.text&&e.text,void 0===e.text&&_jsxs(_Fragment,{children:[_jsx("div",{className:"ai-app-bottom-menu-uptext",children:e.uptext}),_jsx("div",{className:"ai-app-bottom-menu-subtext",children:e.subtext})]})]}),!!e.after&&e.after]},e.value)}return _jsx("div",{className:"ai-app-bottom-menu",children:e.map((e,t)=>i(e))})};export const Mask=e=>{let[t]=useState(createRef()),[n,i]=useState(e.value||""),[o,r]=useState(l(e.value||"")),a=useRef(o);function l(t){let n=[],i=t;for(let o of e.pattern)if("number"===o[0]||"text"===o[0]||"select"===o[0]){let r=+o[1],a=i.slice(0,r);n.push(a),i=i.slice(r,i.length)}else i=i.slice(o[1],i.length);return n}function u(n,o,a){let l=-1;console.log(n);let u="";for(let s=0;s<e.pattern.length;s++){let c=e.pattern[s];if("number"===c[0]||"text"===c[0]||"select"===c[0]){l++;let d=+c[1],p=n[l],f=d-p.length;if(f){let h="number"===c[0]?"0":"x";for(let m=0;m<f;m++)p=h+p;n[l]=p}else if(a===s){let g=$(t.current).find(".aio-input"),v=g.length;++o>v&&(o=0);let y=g.eq(o).find("input");y.length&&y.focus().select()}u+=p}else u+=c[0]}i(u),e.onChange(u),r(n)}function s(e,t,n){u(a.current.map((n,i)=>t===i?e:n),t,n)}function c(){let t=0;return e.pattern.map((e,n)=>{let i=e[0],o=t;if("text"===i||"number"===i){let r=+e[1];return t++,_jsx(AIText,{style:{width:10*r},placeholder:Array(r).fill("x").join(""),maxLength:r,justNumber:"number"===i,value:a.current[o],onChange:e=>s(e,o,n)})}if("select"!==i)return _jsx("div",{className:"aio-input-mask-gap",children:e[2]||e[0]});{let l=e[2];return t++,_jsx(AISelect,{style:{width:"fit-content"},options:l,option:{text:"option",value:"option"},value:a.current[o],onChange:e=>s(e,o,n)})}})}return a.current=o,useEffect(()=>{i(e.value||""),r(l(e.value||""))},[e.value]),_jsx("div",{className:"example",children:_jsx("div",{className:"aio-input-mask",ref:t,title:n,children:c()})})};