import React,{createRef,useContext,createContext,useState,useEffect,useRef,Fragment}from"react";import{mdiChevronDown,mdiLoading,mdiAttachment,mdiClose,mdiCircleMedium,mdiMagnify,mdiPlusThick,mdiImage,mdiEye,mdiEyeOff,mdiDotsHorizontal,mdiChevronRight,mdiChevronLeft,mdiArrowDown,mdiArrowUp,mdiFileExcel,mdiSort,mdiDelete,mdiCrosshairsGps,mdiCircleSmall,mdiCircle}from"@mdi/js";import{Icon}from"@mdi/react";import $ from"jquery";import Axios from"axios";import AIOPopup from"aio-popup";import{Get2Digit,AIODate,GetClient,EventHandler,Swip,DragClass,AddToAttrs,Storage,ExportToExcel,getEventAttrs,svgArc,JSXToHTML,HasClass,FilePreview,DownloadFile,ParseString,GetPrecisionCount}from"aio-utils";import"./index.css";import{jsx as _jsx}from"react/jsx-runtime";import{jsxs as _jsxs}from"react/jsx-runtime";import{Fragment as _Fragment}from"react/jsx-runtime";import{createElement as _createElement}from"react";function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==typeof t?t:String(t)}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}let AICTX=createContext({}),AIOInput=e=>{let t=e.type,n=e.round,i=e.value;if("spinner"===t)t="range",n&&"number"==typeof n||(n=1);else if("slider"===t)t="range",n=0;else if("range"===t)return null;return"form"===t&&(i={...i}),_jsx(AIOINPUT,{...{...e,type:t,round:n,value:i}})};export default AIOInput;function AIOINPUT(e){let[t]=useState(getTypes(e)),[n]=useState(new AIODate),{type:i,value:o,onChange:r,attrs:a={},rtl:l}=e=getDefaultProps(e,t),[s]=useState(createRef()),[u]=useState("aiobutton"+Math.round(1e7*Math.random())),[d]=useState(c);function c(){if(!t.isDropdown)return!1;let n="aio-input-popover";return n+=` aio-input-popover-${l?"rtl":"ltr"}`,t.hasOption&&(n+=" aio-input-dropdown"),"time"===i&&(n+=" aio-input-time-popover"),t=>{let i={...e.popover||{}},{type:o,multiple:r}=e,{body:a,limitTo:l,header:s,setAttrs:d=()=>({}),position:c="popover"}=i,p=$(t.current),f=-1!==["text","number","textarea"].indexOf(o)||"select"===o&&!!r||!!i.fitHorizontal;return{position:c,fitHorizontal:f,limitTo:l,header:s,onClose:()=>b(!1),body:({close:e})=>a?a({close:e}):"date"===o?_jsx(Calendar,{onClose:e}):"time"===o?_jsx(TimePopover,{onClose:e}):_jsx(Options,{}),pageSelector:".aio-input-backdrop."+u,getTarget:()=>p,setAttrs(e){let t=d(e);if("modal"===e&&AddToAttrs(t,{className:n}),"backdrop"===e)return AddToAttrs(t,{className:"aio-input-backdrop "+u})}}}}let[p]=useState(f(AIOPopup));function f(t){return new t({rtl:e.rtl})}let[h,m]=useState(!!e.open),[g,y]=useState(!1);function v(e){y(void 0===e?!g:e)}let[_]=useState(new DragClass({className:"aio-input-option",onChange(t,n,i){"function"==typeof e.onSwap&&e.onSwap(t,n,i)}}));function b(e){!!e!=!!p.getModals().length&&(m(!!e),e?p.addModal(e):(p.removeModal(),setTimeout(()=>$(s.current).focus(),0)))}function x(t,n){"checkbox"===i?r&&r(!o,t):!1!==d?b(d(n)):"function"==typeof e.onClick?e.onClick(t):a.onClick&&a.onClick()}function C(n){let{attrs:a={},onClick:l,close:s}=n;if(l)l(n.object,n.details);else if(a.onClick)a.onClick(n);else if(r){if(t.isInput);else if("tree"===i);else if("file"===i);else if(t.isMultiple){let{multiple:u}=e,d;for(d=-1===o.indexOf(n.value)?o.concat(n.value):o.filter(e=>e!==n.value);"number"==typeof u&&d.length>u;)d=d.slice(1,d.length);r(d)}else n.value!==e.value?r(n.value,n):!0===e.deSelect?r(void 0,n):"function"==typeof e.deSelect&&e.deSelect()}s&&b(!1)}function k(){let n=[];if("date"===i){if(!e.multiple)return{optionsList:[],optionsDic:{}};n=[...e.value]}else n="function"==typeof e.options?e.options():e.options?e.options:[];return GetOptions({rootProps:e,types:t,options:n})}function N(){return{options:k(),rootProps:{...e,value:o},datauniqid:u,touch:"ontouchstart"in document.documentElement,DragOptions:_,open:h,click:x,optionClick:C,types:t,showPassword:g,setShowPassword:v,DATE:n}}function w(){let{round:t,vertical:n}=e;return t?"aio-input-range-round":n?"aio-input-range-vertical":"aio-input-range-horizontal"}let P={spinner:()=>null,slider:()=>null,acardion:()=>_jsx(Acardion,{}),tree:()=>_jsx(Tree,{}),tags:()=>_jsx(Layout,{properties:{text:_jsx(Tags,{})}}),list:()=>_jsx(List,{}),file:()=>_jsx(File,{}),select:()=>_jsx(Select,{}),table:()=>_jsx(Table,{}),form:()=>_jsx(Form,{}),checkbox:()=>_jsx(Layout,{}),button:()=>_jsx(Layout,{}),range:()=>_jsx(Layout,{properties:{text:_jsx(Range,{}),className:w()}}),radio:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),tabs:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),buttons:()=>_jsx(Layout,{properties:{text:_jsx(Options,{})}}),date:()=>_jsx(DateInput,{}),time:()=>_jsx(Layout,{properties:{text:getTimeText(e)}}),image:()=>_jsx(Layout,{properties:{text:_jsx(Image,{})}}),map:()=>_jsx(Layout,{properties:{text:_jsx(Map,{})}}),text:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),password:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),textarea:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),number:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}}),color:()=>_jsx(Layout,{properties:{text:_jsx(Input,{})}})};return i&&P[i]?_jsxs(AICTX.Provider,{value:N(),children:[P[i](),p.render()]},u):null}function TimePopover(e){let{DATE:t,rootProps:n}=useContext(AICTX),{jalali:i,onChange:o}=n,{onClose:r}=e,[a,l]=useState(getTimeByUnit(n)),[s]=useState(a.year?a.year-10:void 0),[u]=useState(a.year?a.year+10:void 0);function d(e){l({...a,...e})}function c(e){return i?({year:"سال",month:"ماه",day:"روز",hour:"ساعت",minute:"دقیقه",second:"ثانیه",Submit:"ثبت",Now:"اکنون"})[e]:e}function p(e){let{year:n,month:i,day:o}=a;if("year"===e&&s&&u)return Array(u-s+1).fill(0).map((e,t)=>({text:t+s,value:t+s}));if("day"===e&&o){let r=n&&i?t.getMonthDaysLength([n,i]):31;return o>r&&d({day:1}),Array(r).fill(0).map((e,t)=>({text:t+1,value:t+1}))}return"month"===e?Array(12).fill(0).map((e,t)=>({text:t+1,value:t+1})):Array("hour"===e?24:60).fill(0).map((e,t)=>({text:t,value:t}))}function f(e){if("number"!=typeof a[e])return null;let t=p(e),n={type:"list",value:a[e],options:t,size:48,width:72,onChange:t=>d({[e]:t})};return _jsxs("div",{className:"aio-input-time-popover-item",children:[_jsx("div",{className:"aio-input-time-popover-item-title",children:c(e)}),_jsx(AIOInput,{...n})]})}function h(){o&&o(a),r()}function m(){l(getTimeByUnit(n,!0))}return _jsxs("div",{className:"aio-input-time-popover-content",children:[_jsxs("div",{className:"aio-input-time-popover-body",children:[f("year")," ",f("month")," ",f("day")," ",f("hour")," ",f("minute")," ",f("second")]}),_jsxs("div",{className:"aio-input-time-popover-footer",children:[_jsx("button",{className:"aio-input-primary-button",onClick:h,children:c("Submit")}),_jsx("button",{className:"aio-input-secondary-button",onClick:m,children:c("Now")})]})]})}function Image(){let{rootProps:e}=useContext(AICTX),[t]=useState(new AIOPopup),{value:n,width:i,height:o,onChange:r,disabled:a,placeholder:l,preview:s,deSelect:u}=e,[d,c]=useState(),p=createRef();function f(e,t){try{let n=new FileReader;n.onload=function(){d!==n.result&&(c(n.result),t&&t(n.result))},n.readAsDataURL(e)}catch{}}function h(e){e.stopPropagation(),e.preventDefault(),m()}function m(){t.addModal({position:"center",header:{title:"",onClose:()=>t.removeModal()},body:()=>_jsx("div",{className:"aio-input-image-preview-popup",children:_jsx("img",{src:$(p.current).attr("src"),alt:l})})})}useEffect(()=>{n&&null!==n?"object"==typeof n?f(n):"string"==typeof n&&d!==n&&c(n):d!==n&&c("")});let g=d?_jsxs(_Fragment,{children:[_jsx("img",{ref:p,src:d,alt:l,style:{objectFit:"contain",cursor:r?void 0:"default"},width:i,height:o,onClick:r?void 0:h}),!!u&&_jsx("div",{onClick(e){e.stopPropagation(),e.preventDefault(),"function"==typeof u?u():r&&r(void 0)},className:"aio-input-image-remove",children:I(mdiClose,1)}),s&&!!r&&_jsx("div",{onClick:e=>h(e),className:"aio-input-image-preview",children:I(mdiImage,1)}),t.render()]}):_jsx("span",{className:"aio-input-image-placeholder",style:{width:i,height:o},children:l});if(!r)return g;let y={disabled:a,type:"file",justify:!0,text:g,attrs:{style:{width:"100%",height:"100%",padding:0}},onChange:e=>f(e,e=>r(e))};return _jsx(AIOInput,{...y})}function File(){return _jsxs("div",{className:"aio-input-file-container",children:[_jsx(Layout,{}),_jsx(FileItems,{})]})}function InputFile(){let{rootProps:e,types:t}=useContext(AICTX),{value:n=[],onChange:i=()=>{},disabled:o,multiple:r,inputAttrs:a}=e;function l(e){let o=e.target.files,a;if(t.isMultiple){let l=(a=[...n]).map(({name:e})=>e);for(let s=0;s<o.length;s++){let u=o[s];-1===l.indexOf(u.name)&&a.push({name:u.name,size:u.size,file:u})}if("number"==typeof r)for(;a.length>r;)a=a.slice(1,a.length)}else a=o.length?o[0]:void 0;i(a)}let s;return _jsx("input",{...{disabled:!0===o,type:"file",style:{display:"none"},multiple:t.isMultiple,onChange:e=>l(e),...a}})}function FileItems(){let{rootProps:e}=useContext(AICTX),{value:t,rtl:n}=e,i=[];if(Array.isArray(t))i=t;else{if(!t)return null;i=[t]}if(!i.length)return null;let o=i.map((e,t)=>_jsx(FileItem,{file:e,index:t},t));return _jsx("div",{className:"aio-input-files",style:{direction:n?"rtl":"ltr"},children:o})}let FileItem=e=>{let{rootProps:t,types:n}=useContext(AICTX),{onChange:i=()=>{},value:o=[]}=t,{file:r,index:a}=e;function l(e){let t=e.name||"untitle",n=e.size||0,i=20;try{let o,r,a=t.lastIndexOf("."),l=t.slice(0,a),s=t.slice(a+1,t.length);o=l.length>i?l.slice(0,Math.floor(i/2))+"..."+l.slice(l.length-Math.floor(i/2),l.length)+"."+s:t;let u=n;if(!u)return{minName:o,sizeString:!1};let d=u/1073741824,c=u/1048576,p=u/1024;return r=d>=1?d.toFixed(2)+" GB":c>=1?c.toFixed(2)+" MB":p>=1?p.toFixed(2)+" KB":u+" byte",{minName:o,sizeString:r}}catch{return{minName:"untitle",sizeString:!1}}}function s(e){let t=[];for(let n=0;n<o.length;n++)n!==e&&t.push(o[n]);i(t)}function u(){DownloadFile(r)}function d(){let e;return(t.preview&&(e=FilePreview(r,{style:{height:"100%"},height:"100%",onClick:()=>u()})),e&&null!==e)?e:_jsx("div",{className:"aio-input-file-item-icon",onClick:()=>u(),children:I(mdiAttachment,.8)})}let{minName:c,sizeString:p}=l(r),{url:f}=r,{optionsList:h}=GetOptions({rootProps:t,types:n,options:[{url:f,minName:c,sizeString:p,index:a}],defaultOptionProps:{subtext:()=>p,text:()=>c,before:()=>d(),after:()=>_jsx("div",{className:"aio-input-file-item-icon",onClick(e){e.stopPropagation(),e.preventDefault(),s(a)},children:I(mdiClose,.7)})}});return _jsx(Layout,{option:h[0]})};function Select(){let{rootProps:e,types:t,options:n}=useContext(AICTX),{value:i,hideTags:o}=e,r=Array.isArray(i)?[...i]:void 0!==i?[i]:[];function a(){if(!r.length)return;let e=n.optionsDic["a"+r[0]];if(e)return e.text}return t.isMultiple?_jsxs("div",{className:"aio-input-multiselect-container",children:[_jsx(Layout,{}),!o&&!!r.length&&_jsx(Tags,{})]}):_jsx(Layout,{properties:{text:e.text||a()}})}function DateInput(){let{rootProps:e,types:t}=useContext(AICTX),{value:n,hideTags:i}=e,o=Array.isArray(n)?[...n]:void 0!==n?[n]:[];function r(){let{value:t,unit:n=Def("date-unit"),text:i,pattern:o,jalali:r,placeholder:a}=e;if(t){i=void 0!==o?o:i;let l=new AIODate,s=l.convertToArray(t),[u,d=1,c=1,p=0]=s;s=[u,d,c,p];let f="{}",h=l.getSplitter(t);return i&&("string"==typeof i||"number"==typeof i)?f=i.toString():"month"===n?f=`{year}${h}{month}`:"day"===n?f=`{year}${h}{month}${h}{day}`:"hour"===n&&(f=`{year}${h}{month}${h}{day} - {hour} : 00`),_jsx("div",{style:{direction:"ltr"},children:l.getDateByPattern(s,f)})}return a||(r?"انتخاب تاریخ":"Select Date")}return t.isMultiple?_jsxs("div",{className:"aio-input-multiselect-container",children:[_jsx(Layout,{properties:{text:e.text||"Select Dates"}}),!i&&!!o.length&&_jsx(Tags,{})]}):_jsx(Layout,{properties:{text:r()}})}let Tags=()=>{let{rootProps:e,options:t}=useContext(AICTX),{value:n=[],rtl:i,disabled:o,onChange:r=()=>{}}=e,a=n.map((n,i)=>{let o=t.optionsDic["a"+n];return void 0===o?null:_jsx(Tag,{onClose:()=>r(e.value.filter(e=>e!==n)),attrs:o.tagAttrs,before:o.tagBefore,after:o.tagAfter,text:o.text,disabled:o.disabled},i)});return a.length?_jsx("div",{className:`aio-input-tags-container aio-input-scroll${i?" rtl":""}${o?" disabled":""}`,children:a}):null},Tag=e=>{let{attrs:t,before:n=I(mdiCircleMedium,.7),after:i,text:o,disabled:r,onClose:a=()=>{}}=e,l=r?void 0:a,s="aio-input-tag",u=AddToAttrs(t,{className:[s+" aio-input-main-bg",r?"disabled":void 0]});return _jsxs("div",{...u,children:[_jsx("div",{className:`${s}-icon`,children:n}),_jsx("div",{className:`${s}-text`,children:o}),void 0!==i&&_jsx("div",{className:`${s}-icon`,children:i}),_jsx("div",{className:`${s}-icon`,onClick:l,children:I(mdiClose,.7)})]})};function Input(){let{rootProps:e,types:t,showPassword:n,options:i}=useContext(AICTX),{type:o}=e,{min:r,max:a,swip:l,onChange:s,blurChange:u,maxLength:d=1/0,justNumber:c,filter:p=[],disabled:f,placeholder:h,inputAttrs:m,spin:g=!0,justify:y}=e,[v]=useState(createRef()),[_]=useState({atimeout:void 0,btimeout:void 0,clicked:!1}),[b]=useState(`ac${Math.round(1e5*Math.random())}`),[x,C]=useState(e.value||""),k=useRef(x);function N(){"number"===o&&l&&new Swip({speedY:l,reverseY:!0,minY:r,maxY:a,dom:()=>$(v.current),start(){let e=+k.current;return[0,e=isNaN(e)?0:e]},move(e){let{y:t}=e.change||{y:0};void 0!==r&&t<r&&(t=r),void 0!==a&&t>a&&(t=a),D(t,s)}})}function w(){let t=e.value;return"number"===o&&!isNaN(+t)&&(t=+t,"number"==typeof r&&t<r?t=r:"number"==typeof a&&t>a&&(t=a)),t}function P(){clearTimeout(_.atimeout),_.atimeout=setTimeout(()=>{let e=w();e!==x&&C(e)},500)}function T(e){try{e=e.toString();let t="";for(let n=0;n<e.length;n++){let i={"۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"};t+=i[e[n]]||e[n]}e=t}catch{}return e}function D(n,i){if(t.hasKeyboard&&n){if(n=T(n),("text"===o||"textarea"===o||"password"===o)&&c){let r=(n=n.toString())[n.length-1];(" "===r||isNaN(+r))&&(Array.isArray(c)?-1===c.indexOf(r)&&(n=n.slice(0,n.length-1)):n=n.slice(0,n.length-1))}if(("text"===o||"textarea"===o||"password"===o)&&p.length){let a=(n=n.toString())[n.length-1];for(let l=0;l<p.length;l++){let s=p[l].toString();if("symbol"===s){if(/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/.test(a)){n=n.slice(0,n.length-1);break}}else if("number"===s){if(!isNaN(+a)){n=n.slice(0,n.length-1);break}}else if("string"===s){if(isNaN(+a)){n=n.slice(0,n.length-1);break}}else if(s===a){n=n.slice(0,n.length-1);break}}}("text"===o||"textarea"===o||"password"===o)&&n.toString().length>d&&(n=n.toString().slice(0,d));try{"number"===o&&n.toString().length>d&&(n=+n.toString().slice(0,d))}catch{}}"number"===e.type&&n&&!isNaN(+n)&&(n=+n),C(n),!u&&i&&(clearTimeout(_.btimeout),_.btimeout=setTimeout(()=>i(n),500))}function A(){!_.clicked&&(_.clicked=!0,$(v.current).focus().select())}function O(e){_.clicked=!1,u&&e&&e(x)}function M(){let t={...AddToAttrs(m,{className:g?void 0:"no-spin",style:y?{textAlign:"center"}:void 0}),value:x,type:o,ref:v,disabled:f,placeholder:h,list:e.options?b:void 0,onClick:e=>A(),onChange:s?e=>D(e.target.value,s):void 0,onBlur:()=>O(s)};return"password"===o&&n&&(t={...t,type:"text",style:{...t.style,textAlign:"center"}}),!0===c&&(t.pattern="d*",t.inputMode="numeric"),t}k.current=x,useEffect(()=>{N()},[]),useEffect(()=>{P()},[e.value]);let L=M();return L.onChange?"color"===o?_jsxs("label",{style:{width:"100%",height:"100%",background:x},children:[_jsx("input",{...L,style:{opacity:0},opacity:!0,rgba:!0,cmyk:!0,hsla:!0}),!!i.optionsList.length&&_jsx("datalist",{id:b,children:i.optionsList.map(e=>_jsx("option",{value:e.value}))})]}):"textarea"===o?_jsx("textarea",{...L}):_jsx("input",{...L}):x}let Formcontext=createContext({}),Form=()=>{let{rootProps}=useContext(AICTX),{node,lang,onChange,attrs,style,className,footer,showErrors=!0}=rootProps,[errors]=useState({}),[dom]=useState(getDom);function getDom(){return createRef()}function getErrorList(){return[...Object.keys(errors).filter(e=>!!errors[e]).map(e=>errors[e]||"")]}function getError(e,t){let{validations:n,label:i}=t;if(!n.length)return"";let o={value:e,title:i||"",lang,validations:n};return new AIOValidation(o).validate()}function setError(e,t){let n=errors={...errors,[e]:t},i={},o;for(o in n)n[o]&&(i[o]=n[o]);errors=i}function getValueByField(p){let{field,def,functional,value=rootProps.value||{},node,formNodeValue}=p,a;if(functional&&"function"==typeof field)a=field({model:value,node,value:formNodeValue});else if("string"==typeof field){if(-1!==field.indexOf("value.")||-1!==field.indexOf("data.")){let data={...rootProps.data};try{eval(`a = ${field}`)}catch{}}else a=field}else a=field;return void 0===a?def:a}function setValueByField(e={},t,n){try{t=t.replace(/\[/g,".").replace(/\]/g,"")}catch{}let i=t.split("."),o=e;for(let r=0;r<i.length-1;r++){let a=i[r];"value"!==a&&(void 0===o[a]&&(isNaN(parseFloat(i[r+1]))?o[a]={}:o[a]=[]),o=o[a])}return o[i[i.length-1]]=n,e}let setValue=(e,t,n)=>{let{value:i={}}=rootProps;if(!e){alert("aio-input error => in type form there is an form item missing field property");return}let o=setValueByField(i,e,t),r;void 0!==n&&(r=getError(t,n)),setError(e,r),onChange&&onChange({...o},{errors:getErrorList(),newformNodeValue:t})};function getContext(){return{rootProps,setValue,setError,getError,getValueByField}}let p=AddToAttrs(attrs,{className:["aio-input-form",className],style});function appendErrors(e){if("string"==typeof showErrors){let t=$(showErrors);if(e.length){let n="<ul>",i="</ul>",o="";for(let r of e)o+=`<li>${r}</li>`;t.html(n+o+i)}else t.html("")}}return useEffect(()=>{let e=$(dom.current).find(".aio-input-form-footer");if(e.length){let t=e.find("button");if(t.length){console.log("ok");let n=getErrorList()||[];n.length?(t.attr({disabled:"disabled"}),appendErrors(n)):(t.removeAttr("disabled"),appendErrors([]))}}}),_jsx(Formcontext.Provider,{value:getContext(),children:_jsxs("form",{...p,ref:dom,children:[!!node&&_jsx(FormNode,{node:node,isRoot:!0}),!!footer&&_jsx("article",{className:"aio-input-form-footer",children:footer})]})})},FormNode=e=>{let{setError:t}=useContext(Formcontext),{node:n,parentType:i,isRoot:o}=e,{html:r,childs:a,dir:l="v",input:s,field:u,flex:d,size:c,show:p,className:f,style:h}=n;if(!1===p)return null;function m(){let e;s&&(e=_jsx(FormInput,{node:n,setError:e=>t(u,e)})),r&&(e=r),a&&(e=a.map((e,t)=>_jsx(FormNode,{node:e,parentType:"h"===l?"row":"column"},t)));let i={className:g,style:{...$,...h}};return o?_jsx("section",{...i,children:e}):a?_jsx("fieldset",{...i,children:e}):_jsx("article",{...i,children:e})}let g="aio-input-form-item";f&&(g+=" "+f),a&&"h"===l?g+=" aio-input-form-item-row":a&&"v"===l&&(g+=" aio-input-form-item-column");let $={};return d?$.flex=d:c&&("row"===i?$.width=c:"column"===i&&($.height=c)),_jsx(_Fragment,{children:m()})},FormInput=e=>{let{rootProps:t,getError:n,getValueByField:i,setValue:o}=useContext(Formcontext),{rtl:r,disabled:a,showErrors:l=!0}=t,{node:s,setError:u}=e,{input:d,label:c="",field:p="",validations:f=[]}=s,h=!1;if("string"==typeof c&&"*"===c[0]&&(h=!0,c=c.slice(1,c.length)),!d||!p)return null;let m={validations:f,label:c};function g(e,t){let n={rtl:r,value:y,type:e.type,attrs:{},inputAttrs:{},disabled:!1,point:e=>({html:e})},l;for(l in e){let s=-1!==["options","columns"].indexOf(l);n[l]=i({field:e[l],functional:s,node:t,formNodeValue:y})}n.onChange=async t=>{let n=!0;e.onChange&&(n=await e.onChange(t)!==!1),!0===n&&o(p,t,m)},n.value=y;let{attrs:u={}}=e;for(let d in u)n.attrs[d]=i({field:u[d],node:t});if(a&&(n.disabled=!0),-1!==["text","number","password","textarea"].indexOf(e.type)){let{inputAttrs:c={}}=e;for(let f in n.inputAttrs={},c)n.inputAttrs[f]=i({field:c[f],node:t})}let h=[n.className];v&&h.push("has-error");let g=AddToAttrs(n.attrs,{className:v?"has-error":void 0});return n.attrs=g,n}function $(e){if(e.multiple)return[]}let y=i({field:p,def:d?$(d):void 0,node:s}),v=n(y,m);u(v);let _=g(d,s);function b(){return"string"!=typeof c?null:_jsxs("section",{className:"aio-input-form-label",children:[c," ",!!h&&_jsx("div",{className:"aio-input-form-label-star",children:"*"})]})}return _jsxs("section",{className:"aio-input-form-input",children:[b(),_jsx(AIOInput,{..._}),v&&!0===l&&_jsx("div",{className:"aio-input-form-error",children:v})]})};function Options(){let{rootProps:e,types:t,options:n}=useContext(AICTX),[i,o]=useState("");function r(n){return"tabs"===e.type||"buttons"===e.type||t.isInput||!e.search||""===i&&n.length<10?null:_jsxs("div",{className:"aio-input-search",children:[_jsx("input",{type:"text",value:i,placeholder:e.search,onChange:e=>o(e.target.value)}),_jsx("div",{className:"aio-input-search-icon",onClick(){o("")},children:I(i?mdiClose:mdiMagnify,.8)})]})}function a(e){return e.map((e,t)=>i&&(void 0===e.text||""===e.text||null===e.text||-1===e.text.indexOf(i))?null:_jsx(Layout,{key:t,option:e,index:t,searchValue:i}))}if(!n.optionsList.length)return null;let l=a(n.optionsList),s=`aio-input-options aio-input-scroll aio-input-${e.type}-options`;return t.isDropdown&&(s+=" aio-input-dropdown-options"),_jsxs(_Fragment,{children:[r(n.optionsList),_jsx("div",{className:s,children:l})]})}let Layout=e=>{let{rootProps:t,datauniqid:n,types:i,touch:o,DragOptions:r,click:a,optionClick:l,open:s,showPassword:u,setShowPassword:d}=useContext(AICTX),{option:c,index:p,toggle:f,indent:h}=e,{type:m,rtl:g}=t,[$]=useState(createRef());function y(){let e;if(void 0!==c?(e=`aio-input-option aio-input-${m}-option`,i.isMultiple&&(e+=` aio-input-${m}-multiple-option`),i.isDropdown&&(e+=" aio-input-dropdown-option"),!0===c.active&&(e+=" active","tabs"===m&&(e+=" aio-input-main-color"),"buttons"===m&&(e+=" aio-input-main-bg"))):(e=`aio-input aio-input-${m}${o?" aio-input-touch":""}`,i.isInput&&(e+=" aio-input-input"),t.justify&&(e+=" aio-input-justify"),g&&(e+=" aio-input-rtl")),h&&(e+=` aio-input-indent-${h.size}`),"tree"===m){let r=t.size||Def("tree-size");(r=12*Math.round(r/12))<24&&(r=24),r>120&&(r=120),e+=` aio-input-size-${r}`}return!0===M.disabled&&(e+=" disabled"),M.className&&(e+=" "+M.className),e+=" "+n}function v(e){let t=`aio-input-${e}`;return c?t+=` aio-input-${m}-option-${e}`:t+=` aio-input-${m}-${e}`,t}function _(){let{text:e,placeholder:t,subtext:n,justify:o}=M;if(void 0===e&&void 0!==t&&(e=_jsx("div",{className:"aio-input-placeholder",children:t})),void 0===e)return _jsx("div",{className:"flex-1"});{let r=e=>({className:`${v(e)}${o&&!i.isInput?" aio-input-value-justify":""}`});return n?_jsxs("div",{className:`aio-input-content aio-input-${m}-content${o&&!i.isInput?" aio-input-content-justify":""}`,children:[_jsx("div",{...r("value"),children:e}),_jsx("div",{...r("subtext"),children:n})]}):_jsx("div",{...r("value"),children:e})}}function b(){return M.draggable?_jsx("svg",{viewBox:"8 4 10 13",role:"presentation",style:{width:12,height:"1.8rem"},children:_jsx("path",{d:"M9,3H11V5H9V3M13,3H15V5H13V3M9,7H11V9H9V7M13,7H15V9H13V7M9,11H11V13H9V11M13,11H15V13H13V11M9,15H11V17H9V15M13,15H15V17H13V15M9,19H11V21H9V19M13,19H15V21H13V19Z",style:{fill:"currentcolor"}})}):null}function x(){if(!i.isDropdown||c||i.isInput&&!t.options)return null;let{caret:e}=t;return!1===e?null:_jsx("div",{className:"aio-input-caret",children:void 0===e?I(mdiChevronDown,.8):e})}function C(){let{checkIcon:e,checked:n}=M;if(void 0===n)return null;let{multiple:i}=t;return Array.isArray(e)?e[n?1:0]:i||"radio"!==m?_jsx("div",{className:"aio-input-check-0 aio-input-main-color"+(n?" checked":""),style:{...e,background:"none"},children:n&&_jsx("div",{className:"aio-input-main-bg"})}):_jsx("div",{className:"aio-input-check-out aio-input-main-color"+(n?" checked":""),style:{...e,background:"none"},children:n&&_jsx("div",{className:"aio-input-check-in aio-input-main-bg",style:{background:e.background}})})}function k(e){let n;if("after"===e&&"password"===m&&t.preview)n=_jsx("div",{className:"align-v",onClick:()=>d(),children:I(u?mdiEyeOff:mdiEye,.8)});else{let i=M[e];n="function"==typeof i?i():i}return void 0===n?null:_jsx("div",{className:v(e),children:n})}function N(){let{loading:e}=M,t;return e?(t=!0===e?I(mdiLoading,.8,{spin:.8}):e,_jsx("div",{className:v("loading"),children:t})):null}function w(){let{attrs:n,disabled:i,draggable:o,style:u}=M,d;s&&!c&&-1!==["text","number","textarea"].indexOf(m)&&(d=1e5);let f;i||(f=void 0===c?e=>{e.stopPropagation(),a(e,$)}:t=>{t.stopPropagation(),t.preventDefault(),(e.properties||{}).onClick?e.properties.onClick():l(c)});let h={...n=AddToAttrs(n,{className:y(),style:{...u,zIndex:d}}),onClick:f,ref:$,disabled:i},g="function"==typeof t.options?t.options():t.options||[];return o&&(h={...h,...r.getAttrs(g,p||0)}),p&&(h["data-index"]=p),h}function P(){let n=e.properties||{},i=c||t,{draggable:o=!!c&&c.draggable}=n,{placeholder:r=c?void 0:t.placeholder}=n,{checked:a=c?c.checked:"checkbox"===m?!!t.value:void 0}=n,{disabled:l=i.disabled}=n,{text:s=i.text}=n,{subtext:u=i.subtext}=n,{justify:d=i.justify}=n,{checkIcon:p=void 0===i.checkIcon?{}:i.checkIcon}=n,{loading:f=i.loading}=n,{attrs:h=i.attrs||{}}=n,g={...i.style||{},...n.style},{before:$=i.before}=n,{after:y=i.after}=n,v=[i.className,n.className].filter(e=>!!e),_=v.length?v.join(" "):void 0;return{disabled:l,draggable:o,text:s,subtext:u,placeholder:r,justify:d,checked:a,checkIcon:p,loading:f,attrs:h,style:g,before:$,after:y,className:_}}function T(e){if(void 0===f)return null;if(c&&Array.isArray(c.toggleIcon)){if(!1===e&&c.toggleIcon[0])return c.toggleIcon[0];if(!0===e&&c.toggleIcon[1])return c.toggleIcon[1];if(void 0===e&&c.toggleIcon[2])return c.toggleIcon[2]}let n;return n=void 0===e?mdiCircleSmall:!0===e?mdiChevronDown:mdiChevronRight,_jsx("div",{style:{transform:t.rtl?"scaleX(-1)":void 0},children:I(n,1)})}function D(e){return c&&!1!==c.toggleIcon&&void 0!==f?_jsxs("div",{className:"aio-input-toggle",onClick(e){e.stopPropagation(),c.details.toggle&&c.details.toggle()},children:[_jsx("div",{className:"aio-input-toggle-icon",children:T(f.open)}),!0===f.open&&_jsx("svg",{className:"aio-input-toggle-line aio-input-indent-line",children:_jsx("path",{d:`M${e.size/2} 0 L${e.size/2} ${e.height/2-12} Z`})})]}):null}function A(e,n){let{parentIndent:i,size:o,level:r,isLastChild:a,height:l}=e;if(!r)return!1;let s=o/2,u=o,d=0,c=l/2,p=l,f=[];return n===r-1?(f.push(_jsx("path",{d:`M${s} ${c} L${u*(t.rtl?-1:1)} ${c} Z`},"hl"+n)),f.push(_jsx("path",{d:`M${s} ${d} L${s} ${a?c:p} Z`},"vdl"+n))):i&&i.isLastChild||f.push(_jsx("path",{d:`M${s} ${d} L${s} ${p} Z`},"vl"+n)),_jsx("svg",{className:"aio-input-indent-line",children:f})}function O(){if(!h)return null;let{level:e}=h;return _jsxs("div",{className:"aio-input-indents",children:[Array(e).fill(0).map((e,t)=>_jsx("div",{className:"aio-input-indent",children:A(h,t)},t)),!!f&&D(h)]})}let M=P(),L=_jsxs(_Fragment,{children:[O(),b(),C(),k("before"),_(),k("after"),N(),x()]}),z=w();return"file"===m?_jsxs("label",{...z,children:[L,_jsx(InputFile,{})]}):_jsxs("div",{...z,children:[L,!!c&&"tabs"===m&&_jsx("div",{className:"aio-input-tabs-option-bar"})]})};function List(){let{rootProps:e,options:t}=useContext(AICTX),{attrs:n={},size:i=36,count:o=3,editable:r=!0,stop:a=3,decay:l=8,onChange:s=()=>{}}=e,u=t.optionsList.length,[d]=useState({dom:createRef(),activeIndex:0,interval:void 0,moved:!1,lastY:0,deltaY:0,so:{y:0,top:0,limit:{top:0,bottom:0}}});function c(){var e=o*i;return{height:e}}function p(e){return Math.round((o*i-i-2*e)/(2*i))}function f(e){return(o-2*e-1)*i/2}function h(){return{top:f(d.activeIndex)}}function m(){if(d.activeIndex>=u-1)return;d.activeIndex++;let e=f(d.activeIndex);w({top:e}),g(d.activeIndex)}function g(e){$(d.dom.current).find(".aio-input-list-option").removeClass("active"),$(d.dom.current).find(".aio-input-list-option[data-index="+e+"]").addClass("active")}function y(){if(d.activeIndex<=0)return;d.activeIndex--;let e=f(d.activeIndex);w({top:e}),g(d.activeIndex)}function v(e){r&&(38===e.keyCode?y():40===e.keyCode&&m())}function _(){return{top:f(-1),bottom:f(u)}}function b(e){let t=p(e);return t<0&&(t=0),t>u-1&&(t=u-1),f(t)}function x(e){if(!r)return;EventHandler("window","mousemove",N),EventHandler("window","mouseup",P),clearInterval(d.interval),d.moved=!1;let n=GetClient(e).y;w({transition:"unset"});let i=C();var o=p(i);g(o),w({top:i,transition:"unset"}),s(t.optionsList[o].value,o),d.so={y:n,top:i,limit:_()}}function C(){var e=parseInt($(d.dom.current).find(".aio-input-list-options").css("top"));return b(e)}function k(e){let{top:t,bottom:n}=d.so.limit;return e>t?t:e<n?n:e}function N(e){d.moved=!0;let t=GetClient(e).y;var n=t-d.so.y;void 0===d.lastY&&(d.lastY=t),d.deltaY=t-d.lastY,d.lastY=t,20>Math.abs(n)&&(d.deltaY=3);var i=k(d.so.top+n);let o=p(i);d.so.newTop=i,g(o),w({top:i})}function w(e){$(d.dom.current).find(".aio-input-list-options").css(e)}function P(){EventHandler("window","mousemove",N,"unbind"),EventHandler("window","mouseup",P,"unbind"),d.moved&&(d.moved=!1,T(d.deltaY,d.so.newTop))}function T(e,n=C()){l<0&&(l=0),l>99&&(l=99),l=1+l/1e3,d.interval=setInterval(()=>{let i=p(n+=e);if(g(i),Math.abs(e)<a||i<0||i>u-1){clearInterval(d.interval),i<0&&(i=0),i>u-1&&(i=u-1);let o=f(i);w({top:o,transition:"0.3s"}),s(t.optionsList[i].value,i);return}e/=l,w({top:n})},20)}useEffect(()=>{e.move&&e.move(T)},[]),useEffect(()=>{g(d.activeIndex)});let D=t.optionsList.map((t,n)=>(t.value===e.value&&(d.activeIndex=n),_jsx(Layout,{option:t,index:n,properties:{style:{height:i},justify:!0}})));return _jsx("div",{...n,ref:d.dom,tabIndex:0,onKeyDown:e=>v(e),className:"aio-input-list"+(n.className?" "+n.className:""),style:{...n.style,...c()},children:_jsx("div",{className:"aio-input-list-options",style:h(),onMouseDown:e=>x(e),onTouchStart:e=>x(e),children:D})})}let AcardionContext=createContext({});export const Acardion=()=>{let{rootProps:e,options:t}=useContext(AICTX),{multiple:n,vertical:i=!0,value:o}=e;function r(e){return n?-1!==(o||[]).indexOf(e):e===o}function a(){return{rootProps:e,isOpen:r}}return _jsx(AcardionContext.Provider,{value:a(),children:_jsx("div",{className:`aio-input-acardion aio-input-scroll${i?" aio-input-acardion-vertical":" aio-input-acardion-horizontal"}`,children:t.optionsList.map(e=>_jsx(AcardionItem,{option:e}))})})};let AcardionItem=({option:e})=>{let[t,n]=useState(!1),[i,o]=useState(e.active),[r]=useState(),a=AddToAttrs(e.attrs,{className:"aio-input-acardion-item"});function l(e){n(e)}return useEffect(()=>{l(!0)},[]),useEffect(()=>{e.active?(o(!0),l(!1),r=setTimeout(()=>{l(!0)},10)):(o(!0),l(!1),r=setTimeout(()=>{o(!1)},300))},[!!e.active]),_jsxs("div",{...a,children:[_jsx(Layout,{option:e}),!!i&&_jsx(AcardionBody,{option:e,mounted:t})]})},AcardionBody=({option:e,mounted:t})=>{let{rootProps:n}=useContext(AcardionContext),{value:i}=e,{body:o}=n,{html:r,attrs:a}=("function"==typeof o?o(i):o)||{html:""},l=AddToAttrs(a,{className:["aio-input-acardion-body",t?void 0:"not-mounted"]});return _jsx("div",{...l,children:r})},TreeContext=createContext({}),Tree=()=>{let{rootProps:e,types:t}=useContext(AICTX),{onAdd:n,onRemove:i,value:o=[],onChange:r,size:a=Def("tree-size"),attrs:l}=e,[s,u]=useState({}),[d,c]=useState({}),[p]=useState(m);function f(e){c({...d,[e]:!d[e]})}function h(e){u({...s,[e]:!s[e]})}function m(){let{indent:t=24}=e;return"number"!=typeof t&&(t=12),(t=6*Math.round(t/6))<0&&(t=0),t>60&&(t=60),t}function g(e){let t=!!s[e],n=300;t?(f(e),setTimeout(()=>h(e),n)):(h(e),setTimeout(()=>f(e),0))}function $(t,n){for(let i in n)t[i]=n[i];e.onChange&&e.onChange(e.value)}function y(t){let{row:n,details:i}=t,o=[];try{o=e.getChilds?e.getChilds({row:n,details:i}):n.childs||[]}catch{o=[]}return o||[]}function v(t){let{row:n,childs:i}=t;try{e.setChilds?e.setChilds(t):n.childs=i}catch{}}async function _(e){let t;if(t="function"==typeof n?await n(e):n){if(e){let i=y({row:e.parent,details:e.parentDetails});v({row:e.parent,childs:i.concat(t),details:e.parentDetails})}else o.push(t);r&&r(o)}}async function b(t){let{index:n}=t,a;if(!(a="function"!=typeof i||await i(t)))return;let l={mainValue:o,index:n,active:!1,toggle(){}};if(t.parent){let s=y({row:t.parent,details:t.parentDetails}).filter(n=>{let i=GetOptionProps({option:t.row,key:"value",props:e,details:l}),o=GetOptionProps({option:n,key:"value",props:e,details:l});return i!==o});v({row:t.parent,details:t.parentDetails,childs:s})}else o=o.filter(n=>{let i=GetOptionProps({option:t.row,key:"value",props:e,details:l}),o=GetOptionProps({option:n,key:"value",props:e,details:l});return i!==o});r&&r(o)}function x(){return{toggle:g,rootProps:e,mountedDic:d,openDic:s,add:_,remove:b,types:t,indent:p,size:a,change:$,getChilds:y}}let C=AddToAttrs(l,{className:["aio-input-tree",e.className],style:e.style});return _jsx(TreeContext.Provider,{value:x(),children:_jsxs("div",{...C,children:[_jsx(TreeHeader,{}),_jsx(TreeBody,{rows:o,level:0})]})})},TreeHeader=()=>{let{rootProps:e,add:t}=useContext(TreeContext),{addText:n="add",onAdd:i}=e;return i?(n=("function"==typeof n?n("header"):n)||"add",_jsx("div",{className:"aio-input-tree-header",children:_jsxs("button",{onClick:()=>t(),children:[I(mdiPlusThick,.8),n]})})):null},TreeActions=e=>{let{row:t,index:n,parent:i,rowDetails:o,parentDetails:r}=e,{rootProps:a,add:l,remove:s}=useContext(TreeContext),{onAdd:u,onRemove:d,removeText:c="Remove"}=a,p=("function"==typeof a.addText?a.addText(t):a.addText)||"Add",f="function"==typeof a.actions?a.actions(t,i):a.actions;function h(){let e=[];return u&&e.push({text:p,value:"add",before:I(mdiPlusThick,.7),onClick:()=>l({parent:t,parentDetails:o})}),e=[...e,...(f||[]).map(e=>({...e,onClick(){e.onClick&&e.onClick(t,i)}}))],d&&e.push({text:c,value:"remove",before:I(mdiDelete,.7),onClick:()=>s({row:t,index:n,parent:i,parentDetails:r})}),e}let m=h();if(!m.length)return null;let g={type:"select",caret:!1,popover:{limitTo:".aio-input-tree"},className:"aio-input-tree-options-button",options:m,text:I(mdiDotsHorizontal,.7)};return _jsx(AIOInput,{...g})},TreeBody=e=>{let{rootProps:t,types:n,openDic:i,mountedDic:o,indent:r,size:a,change:l,getChilds:s,toggle:u}=useContext(TreeContext),{rows:d,level:c,parent:p,parentId:f,parentIndent:h,parentDetails:m}=e,g=void 0===f||!!i[f],$=void 0==f||o[f],{onAdd:y,onRemove:v,actions:_}=t,b;(y||v||_)&&(b={after(e){let{index:t,level:n=0}=e,i=0===t,o=t===d.length-1,r={index:t,level:n,isFirstChild:i,isLastChild:o};return _jsx(TreeActions,{row:e.object,index:t,parent:p,rowDetails:r,parentDetails:m})}});let{optionsList:x}=GetOptions({rootProps:t,types:n,options:d,level:c,isOpen:e=>!!i[e],change:(e,t)=>l(e,t),properties:b,toggle:u});function C(){let e="aio-input-tree-body";return p||(e+=" aio-input-tree-root"),g&&(e+=" open"),e+=$?" mounted":" not-mounted",e+=` aio-input-tree-body-level-${c}`}return _jsx("div",{className:C(),children:x.map((e,t)=>{let n=d[t],o=e.value,l={level:c,index:t,isLastChild:t===x.length-1,isFirstChild:0===t},u=s({row:n,details:l}),m=!!i[o],$={row:n,option:e,parent:p,parentId:f,id:o,parentOpen:g,open:m,details:l,indent:{height:a,childsLength:u.length,size:r,parentIndent:h,...l}};return _createElement("div",{className:"aio-input-tree-row",key:o},_jsx(TreeRow,{item:$}),_jsx(TreeChilds,{item:$}))})})},TreeRow=e=>{let{openDic:t,getChilds:n}=useContext(TreeContext),{item:i}=e,o=n(i).length?!!t[i.id]:void 0,r;return _jsx(Layout,{indent:i.indent,option:i.option,toggle:{open:o}})},TreeChilds=e=>{let{getChilds:t}=useContext(TreeContext),{row:n,id:i,open:o,indent:r,details:a}=e.item,l=t(e.item);return o&&l&&l.length?_jsx(TreeBody,{rows:l,level:r.level+1,parent:n,parentId:i,parentIndent:r,parentDetails:a}):null},DPContext=createContext({});export function Calendar(e){let{rootProps:t,DATE:n}=useContext(AICTX),{onClose:i}=e,{multiple:o,unit:r=Def("date-unit"),jalali:a,value:l,disabled:s,size:u=Def("date-size"),theme:d=Def("theme"),translate:c=e=>e,onChange:p=()=>{},option:f={}}=t,[h]=useState(n.getMonths(a)),[m]=useState(n.getToday(a)),[g]=useState(n.getWeekDay(m).weekDay),[$]=useState(h[m[1]-1]),[y,v]=useState(b);function _(){let e;return o?l.length?l[l.length-1]:void 0:l}function b(){let e=_();e=e&&null!==e?e:m;let[t,i,o]=n.convertToArray(e);return{year:t,month:i,day:o}}let x=useRef(y);function C(e){"Today"===e&&("month"===r?e="This Month":"hour"===r&&(e="This Hour"));let t={Clear:"حذف","This Hour":"ساعت کنونی",Today:"امروز","This Month":"ماه جاری","Select Year":"انتخاب سال",Close:"بستن"},n;return a&&t[e]&&(n=t[e]),c(e)}function k(e){let t;if("today"===e){let[n,i,o]=m;t={year:n,month:i,day:"month"===r?1:o}}else t={...y,...e};v(t)}function N(){return{width:u,fontSize:u/17,background:d[1],color:d[0],stroke:d[0],cursor:!0===s?"not-allowed":void 0}}function w(){let e=_();return"string"==typeof e?n.getSplitter(e):"/"}function P(){return{changeActiveDate:k,DATE:n,translate:C,rootProps:t,activeDate:x.current,today:m,todayWeekDay:g,thisMonthString:$,months:h,onChange(e){let{year:t=1e3,month:s=1,day:u=1,hour:d=0}=e,c=[t,s,u,d],m=a?c:n.toJalali(c),g=a?n.toGregorian(c):c,{weekDay:$,index:y}="month"===r?{weekDay:null,index:null}:n.getWeekDay(c),v=e=>{if(void 0===e)return;let t=e.toString();return 1===t.length?`0${t}`:t},_="",b=w();"month"===r?_=`${t}${b}${v(s)}`:"day"===r?_=`${t}${b}${v(s)}${b}${v(u)}`:"hour"===r&&(_=`${t}${b}${v(s)}${b}${v(u)}${b}${v(d)}`);let x=h[s-1],C=a?x:n.getMonths(!0)[s-1],k=a?n.getMonths(!1)[s-1]:x,N={months:h,jalaliDateArray:m,gregorianDateArray:g,dateArray:c,weekDay:$,weekDayIndex:y,dateString:_,year:t,month:s,day:u,hour:d,monthString:x,jalaliMonthString:C,gregorianMonthString:k},P,T=0;if(o){let D=[],A=(D=l?Array.isArray(l)?[...l]:[l]:[]).indexOf(_);if(P=-1===A?[...D,_]:D.filter(e=>e!==_),"number"==typeof o)for(;P.length>o;)P=P.slice(1,P.length);A=P.length-1}else T=0,P=_;p(P,N),i&&"function"==typeof f.close&&f.close(f,{mainValue:P,index:T,active:!1,toggle(){}})&&i()}}}return x.current=y,_jsx(DPContext.Provider,{value:P(),children:_jsxs("div",{className:"aio-input-date-container",style:{display:"flex"},children:[_jsxs("div",{className:"aio-input-date-calendar aio-input-date-theme-bg1 aio-input-date-theme-color0 aio-input-date-theme-stroke0",style:N(),children:[_jsx(DPHeader,{}),_jsx(DPBody,{}),_jsx(DPFooter,{})]}),_jsx(DPToday,{})]})})}function DPToday(){let{rootProps:e,translate:t,today:n,todayWeekDay:i,thisMonthString:o}=useContext(DPContext),{theme:r=Def("theme"),jalali:a,unit:l=Def("date-unit"),size:s=Def("date-size")}=e;return _jsxs("div",{className:"aio-input-date-today aio-input-date-theme-color1 aio-input-date-theme-bg0",style:{width:s/2,color:r[1],background:r[0]},children:[_jsx("div",{style:{fontSize:s/13},children:t("Today")}),("day"===l||"hour"===l)&&_jsxs(_Fragment,{children:[_jsx("div",{style:{fontSize:s/11},children:a?i:i.slice(0,3)}),_jsx("div",{style:{fontSize:s/12*4,height:s/12*4},children:n[2]}),_jsx("div",{style:{fontSize:s/11},children:a?o:o.slice(0,3)})]}),"month"===l&&_jsx("div",{style:{fontSize:s/8},children:a?o:o.slice(0,3)}),_jsx("div",{style:{fontSize:s/11},children:n[0]}),"hour"===l&&_jsx("div",{style:{fontSize:s/10},children:n[3]+":00"})]})}function DPFooter(){let{rootProps:e,changeActiveDate:t,translate:n}=useContext(DPContext),{disabled:i,onChange:o=()=>{},size:r=Def("date-size"),deSelect:a,multiple:l}=e;if(i)return null;let s={padding:`${r/20}px 0`,fontFamily:"inherit"};return _jsxs("div",{className:"aio-input-date-footer",style:{fontSize:r/13},children:[!!a&&_jsx("button",{style:s,onClick:()=>"function"==typeof a?a():o(l?[]:void 0),children:n("Clear")}),_jsx("button",{style:s,onClick:()=>t("today"),children:n("Today")})]})}function DPBody(){let{rootProps:e,activeDate:t}=useContext(DPContext),{unit:n=Def("date-unit"),jalali:i,size:o=Def("date-size")}=e;function r(){var e={hour:4,day:7,month:3,year:1}[n],t={hour:6,day:7,month:4,year:1}[n],r=o/18,a=o/15,l=(o-2*r)/e,s={hour:o/7,day:l,month:o/6,year:o/7}[n],u="",d="";for(let c=1;c<=e;c++)u+=l+"px"+(c!==e?" ":"");for(let p=1;p<=t;p++)d+=s+"px"+(p!==t?" ":"");let f=i?"rtl":"ltr";return{gridTemplateColumns:u,gridTemplateRows:d,direction:f,padding:r,fontSize:a}}return _jsxs("div",{className:"aio-input-date-body",style:r(),children:["hour"===n&&Array(24).fill(0).map((e,n)=>_jsx(DPCell,{dateArray:[t.year,t.month,t.day,n]},"cell"+n)),"day"===n&&_jsx(DPBodyDay,{}),"month"===n&&Array(12).fill(0).map((e,n)=>_jsx(DPCell,{dateArray:[t.year,n+1]},"cell"+n))]})}function DPBodyDay(){let{rootProps:e,activeDate:t,DATE:n}=useContext(DPContext),{theme:i=Def("theme"),jalali:o}=e,r=n.getWeekDay([t.year,t.month,1]).index,a=n.getMonthDaysLength([t.year,t.month]);return _jsxs(_Fragment,{children:[n.getWeekDays(o).map((e,t)=>_jsx(DPCellWeekday,{weekDay:e},"weekday"+t)),Array(r).fill(0).map((e,t)=>_jsx("div",{className:"aio-input-date-space aio-input-date-cell aio-input-date-theme-bg1",style:{background:i[1]}},"space"+t)),Array(a).fill(0).map((e,n)=>_jsx(DPCell,{dateArray:[t.year||0,t.month||0,n+1]},"cell"+n)),Array(42-(r+a)).fill(0).map((e,t)=>_jsx("div",{className:"aio-input-date-space aio-input-date-cell aio-input-date-theme-bg1",style:{background:i[1]}},"endspace"+t))]})}let DPCellWeekday=e=>{let{rootProps:t,translate:n}=useContext(DPContext),{theme:i=Def("theme"),jalali:o}=t,{weekDay:r}=e;return _jsx("div",{className:"aio-input-date-weekday aio-input-date-cell aio-input-date-theme-bg1 aio-input-date-theme-color0",style:{background:i[1],color:i[0]},children:_jsx("span",{children:n(r.slice(0,o?1:2))})})};function DPCell(e){let{rootProps:t,translate:n,onChange:i,DATE:o}=useContext(DPContext),{disabled:r,dateAttrs:a,theme:l=Def("theme"),value:s,jalali:u,unit:d=Def("date-unit"),multiple:c}=t,{dateArray:p}=e;function f(){return c?!!s.length&&!!s.find(e=>o.isEqual(p,e)):!!s&&o.isEqual(p,s)}function h(e,t,n,i){var o="aio-input-date-cell";return n&&(o+=" aio-input-date-disabled"),e&&(o+=" aio-input-date-active aio-input-date-theme-bg0 aio-input-date-theme-color1"),t&&(o+=" today aio-input-date-theme-border0"),i&&(o+=" className"),o}let m=f(),g=o.isEqual(p,o.getToday(u)),$={};a&&($=($=a({dateArray:p,isToday:g,isActive:m,isMatch:e=>o.isMatch(p,e)}))||{});let y=!0===r||!0===$.disabled,v=h(m,g,y,$.className),_=y?void 0:()=>{i({year:p[0],month:p[1],day:p[2],hour:p[3]})},b={};y||(b.background=l[1]),-1!==v.indexOf("aio-input-date-active")&&(b.background=l[0],b.color=l[1]),-1!==v.indexOf("today")&&(b.border=`1px solid ${l[0]}`),b={...b,...$.style};let x;if("hour"===d)x=p[3]+":00";else if("day"===d)x=p[2];else if("month"===d){let C=o.getMonths(u);x=n(u?C[p[1]-1]:C[p[1]-1].slice(0,3))}return _jsx("div",{style:b,onClick:_,className:v,children:y?_jsx("del",{children:x}):x})}function DPHeaderItem(e){let{unit:t}=e,{rootProps:n,activeDate:i,months:o}=useContext(DPContext),{theme:r=Def("theme"),jalali:a}=n;if(!i||!i[t])return null;let l="year"===t?i.year:o[i[t]-1].substring(0,a?10:3),s={type:"button",text:l,justify:!0,caret:!1,attrs:{className:"aio-input-date-dropdown"},popover:{fitTo:".aio-input-date-calendar",setAttrs(e){if("modal"===e)return{style:{background:r[1],color:r[0]}}},body:e=>_jsx(DPHeaderPopup,{onClose:e,unit:t})}};return _jsx(AIOInput,{...s})}let DPHeaderPopup=e=>{let{onClose:t,unit:n}=e,{rootProps:i,DATE:o,translate:r,activeDate:a,changeActiveDate:l}=useContext(DPContext),{jalali:s,size:u=Def("date-size"),theme:d=Def("theme")}=i,[c]=useState(o.getMonths(s)),[p,f]=useState(10*Math.floor(a.year/10)),[h,m]=useState(a.year),[g,$]=useState(a.month);function y(e){"year"===n?(m(e),l({year:e})):($(e),l({month:e})),t()}function v(e){f(p+10*e)}function _(){let e=[];if("year"===n)for(let t=p;t<p+10;t++){let i=t===h,o="aio-input-date-cell";i?o+=" aio-input-date-active aio-input-date-theme-bg0 aio-input-date-theme-color1":o+=" aio-input-date-theme-bg1 aio-input-date-theme-color0";let r={style:i?{background:d[0],color:d[1]}:{background:d[1],color:d[0]},className:o,onClick:()=>y(t)};e.push(_createElement("div",{...r,key:t},t))}else for(let a=1;a<=12;a++){let l=a===g,s="aio-input-date-cell";l?s+=" aio-input-date-active aio-input-date-theme-bg0 aio-input-date-theme-color1":s+=" aio-input-date-theme-bg1 aio-input-date-theme-color0";let u={style:l?{background:d[0],color:d[1]}:{background:d[1],color:d[0]},className:s,onClick:()=>y(a)};e.push(_createElement("div",{...u,key:a},c[a-1].slice(0,3)))}return e}function b(){var e=3,t=4,n=u/18,i=u/15,o=(u-2*n)/e,r=u/6,a="",l="";for(let d=1;d<=e;d++)a+=o+"px"+(d!==e?" ":"");for(let c=1;c<=t;c++)l+=r+"px"+(c!==t?" ":"");let p=s?"rtl":"ltr";return{gridTemplateColumns:a,gridTemplateRows:l,direction:p,padding:n,fontSize:i}}function x(){return"year"!==n?null:_jsxs("div",{className:"aio-input-date-popup-header",children:[_jsx(DPArrow,{type:"minus",onClick:()=>v(-1)}),_jsx("div",{className:"aio-input-date-popup-label",style:{fontSize:u/15},children:r("Select Year")}),_jsx(DPArrow,{type:"plus",onClick:()=>v(1)})]})}function C(){return _jsx("div",{style:b(),className:"aio-input-date-popup-body",children:_()})}function k(){return _jsx("div",{style:b(),className:"aio-input-date-popup-footer",children:_jsx("button",{onClick:()=>t(),children:r("Close")})})}return useEffect(()=>{m(a.year),$(a.month)},[a.year,a.month]),_jsxs("div",{className:"aio-input-date-popup",children:[x(),C(),k()]})};function DPHeader(){let{rootProps:e,activeDate:t,changeActiveDate:n,DATE:i}=useContext(DPContext),{size:o=Def("date-size"),unit:r=Def("date-unit")}=e;function a(){if(!t||!t.year||!t.month)return null;let e=Array(i.getMonthDaysLength([t.year,t.month])).fill(0).map((e,t)=>({text:(t+1).toString(),value:t+1})),o={value:t.day,options:e,onChange:e=>n({day:e})};return _jsx(DPHeaderDropdown,{...o})}return _jsxs("div",{className:"aio-input-date-header",style:{height:o/4},children:[_jsx(DPArrow,{type:"minus"}),_jsxs("div",{className:"aio-input-date-select",style:{fontSize:Math.floor(o/13)},children:[_jsx(DPHeaderItem,{unit:"year"}),"month"!==r?_jsx(DPHeaderItem,{unit:"month"}):null,"hour"===r?a():null]}),_jsx(DPArrow,{type:"plus"})]})}function DPHeaderDropdown(e){let{rootProps:t}=useContext(DPContext),{value:n,options:i,onChange:o}=e,{size:r=Def("date-size"),theme:a=Def("theme")}=t;return _jsx(AIOInput,{value:n,options:i,onChange:o,caret:!1,type:"select",attrs:{className:"aio-input-date-dropdown aio-input-date-theme-bg1 aio-input-date-theme-color0"},option:{style:()=>({height:r/6,background:a[1],color:a[0]})}})}function DPArrow(e){let{rootProps:t,changeActiveDate:n,activeDate:i,DATE:o}=useContext(DPContext),{type:r,onClick:a}=e,{jalali:l,unit:s=Def("date-unit"),size:u=Def("date-size"),theme:d=Def("theme")}=t;function c(){if(a){a();return}let e=(l?-1:1)*("minus"===r?-1:1),t=[i.year,i.month,i.day];if("month"===s&&n({year:i.year+e}),"day"===s){let u=[];n({year:(u=1===t[1]&&-1===e?[t[0]-1,12]:12===t[1]&&1===e?[t[0]+1,1]:[t[0],t[1]+e])[0],month:u[1]})}if("hour"===s){let d=o.getNextTime(t,864e5*e,l);n({year:d[0],month:d[1],day:d[2]})}}function p(){return I("minus"===r?mdiChevronLeft:mdiChevronRight,1,{style:{color:d[0]},className:"aio-input-date-theme-color0"})}return _jsx("div",{className:"aio-input-date-arrow",style:{width:u/6,height:u/6},onClick:()=>c(),children:p()})}let AITableContext=createContext({});function Table(){let{rootProps,DATE}=useContext(AICTX),{paging,getValue={},value,onChange=()=>{},onAdd,onRemove,excel,onSwap,onSearch,rowAttrs,onChangeSort,className,style}=rootProps,[dom]=useState(createRef()),[searchValue,setSearchValue]=useState(""),[columns,setColumns]=useState([]),[searchColumns,setSearchColumns]=useState([]),[excelColumns,setExcelColumns]=useState([]),[temp]=useState({}),[DragRows]=useState(!!onSwap&&new DragClass({onChange(e,t,n){"function"==typeof onSwap?onSwap(e,t,n):onChange(e)},className:"aio-input-table-row"})),[sorts,setSorts]=useState([]);function getColumns(){let{columns:e=[]}=rootProps;e="function"==typeof e?e():e;let t=[],n=[],i=e.map(e=>{let{id:i="aitc"+Math.round(1e6*Math.random()),sort:o,search:r,excel:a}=e,l={...e,_id:i};return r&&t.push(l),a&&n.push(l),l});return setColumns(i),setSearchColumns(t),setExcelColumns(n),i}function getSorts(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n],{_id:o,input:r}=i,a=!0===i.sort?{}:i.sort;if(!a)continue;let{active:l=!1,dir:s="dec"}=a,u;u=a.getValue?a.getValue:e=>{let t=getDynamics({value:i.value,row:e,column:i});return r&&"date"===r.type&&(t=DATE.getTime(t)),t};let d;d=r&&-1!==["number","date","range"].indexOf(r.type)?"number":a.type||"string";let c={dir:s,title:a.title||i.title,sortId:o,active:l,type:d,getValue:u};t.push(c)}setSorts(t)}function getDynamics(p){let{value,row,column,def,rowIndex}=p;if(paging){let{number,size}=paging;rowIndex&&(rowIndex+=(number-1)*size)}let type=typeof value;if("string"===type){let result=value,param={row,column:column,rowIndex:rowIndex};if(getValue[value])result=getValue[value](param);else if(-1!==value.indexOf("row."))try{eval(`result = ${value}`)}catch{result=""}return void 0===result?def:result}return"undefined"===type?def:"function"===type?value({row,column,rowIndex}):void 0===value?def:value}function add(){"function"==typeof onAdd?onAdd():onChange([{...onAdd},...value])}function remove(e,t){let n=()=>onChange(value.filter(t=>t._id!==e._id));"function"==typeof onRemove?onRemove({row:e,action:n,rowIndex:t}):n()}function exportToExcel(){let e=[];for(let t=0;t<value.length;t++){let n=value[t],i={};for(let o=0;o<excelColumns.length;o++){let r=excelColumns[o],{excel:a,value:l}=r;"string"==typeof a&&(i[a]=getDynamics({value:l,row:n,column:r,rowIndex:t}))}e.push(i)}ExportToExcel(e,{promptText:"string"==typeof excel?excel:"Inter Excel File Name"})}function getSearchedRows(e){return!0===onSearch&&searchColumns.length&&searchValue?AIOInputSearch(e,searchValue,(e,t)=>{let n="";for(let i=0;i<searchColumns.length;i++){let o=searchColumns[i],r=getDynamics({value:o.value,row:e,def:"",column:o,rowIndex:t});r&&(n+=r+" ")}return n}):e}function sortRows(e,t){return e?t&&t.length?e.sort((e,n)=>{for(let i=0;i<t.length;i++){let{dir:o,getValue:r}=t[i];if(!r)break;let a=r(e),l=r(n);if(a<l)return -1*("dec"===o?-1:1);if(a>l)return 1*("dec"===o?-1:1);if(i===t.length-1)break}return 0}):e:[]}function getSortedRows(e){if(temp.isInitSortExecuted||onChangeSort)return e;let t=sorts.filter(e=>!1!==e.active);if(!t.length||!e.length)return e;temp.isInitSortExecuted=!0;let n=sortRows(e,t);return onChange(n),n}function getRows(){let e=getSearchedRows(value),t=getSortedRows(e),n=paging&&!paging.serverSide?t.slice((paging.number-1)*paging.size,paging.number*paging.size):t;return{rows:value,searchedRows:e,sortedRows:t,pagedRows:n}}function getCellStyle(e){let t=getDynamics({value:e.width}),n=getDynamics({value:e.minWidth});return{width:t||void 0,flex:t?void 0:1,minWidth:n}}function getCellAttrs(e){let{row:t,rowIndex:n,column:i,type:o}=e,{cellAttrs:r,titleAttrs:a}=i,l=getDynamics({value:"title"===o?a:r,column:i,def:{},row:t,rowIndex:n}),s=getDynamics({value:i.justify,def:!1});return l=AddToAttrs(l,{className:`aio-input-table-${o}`+(s?` aio-input-table-${o}-justify`:""),style:getCellStyle(i)}),"title"===o&&(l.title=getDynamics({value:i.title,def:""})),{...l}}function getRowAttrs(e,t){let n=rowAttrs?rowAttrs({row:e,rowIndex:t}):{},i=AddToAttrs(n,{className:"aio-input-table-row"});return!1!==DragRows&&(i={...i,...DragRows.getAttrs(value,t)}),i}function search(e){!0===onSearch?setSearchValue(e):"function"==typeof onSearch&&onSearch(e)}function getContext(e){return{ROWS:e,rootProps,columns,sorts,setSorts,sortRows,excelColumns,getCellAttrs,getRowAttrs,add,remove,search,exportToExcel,getDynamics}}useEffect(()=>{let e;getSorts(getColumns())},[]);let ROWS=getRows(),attrs=AddToAttrs(rootProps.attrs,{className:["aio-input aio-input-table",className],style:rootProps.style,attrs:{ref:dom}});return _jsx(AITableContext.Provider,{value:getContext(ROWS),children:_jsxs("div",{...attrs,children:[_jsx(TableToolbar,{}),_jsxs("div",{className:"aio-input-table-unit aio-input-scroll",children:[_jsx(TableHeader,{}),_jsx(TableRows,{})]}),paging?_jsx(TablePaging,{}):""]})})}function TableGap(e){let{rootProps:t}=useContext(AITableContext),{rowGap:n,columnGap:i}=t,{dir:o}=e,r;return r="h"===o?{height:n}:{width:i},_jsx("div",{className:`aio-input-table-border-${o}`,style:r})}function TablePaging(){let{ROWS:e,rootProps:t}=useContext(AITableContext),[n]=useState({timeout:void 0,start:void 0,end:void 0,pages:0});function i(i){if("function"!=typeof t.onChangePaging)return alert("aio-input error => in type table you set paging but forget to set onChangePaging function prop to aio input"),{number:0,size:0};let{number:o,size:r=20,length:a=0,sizes:l=[1,5,10,15,20,30,50,70,100],serverSide:s}=i;s||(a=e.sortedRows.length),-1===l.indexOf(r)&&(r=l[0]);let u=Math.ceil(a/r),d=(o=(o=o>u?u:o)<1?1:o)-3,c=o+3;return n.start=d,n.end=c,n.pages=u,{...i,length:a,number:o,size:r,sizes:l}}let[o,r]=useState(i(t.paging||{size:0,number:0}));function a(e){let a=i({...o,...e});r(a),t.onChangePaging&&(a.serverSide?(clearTimeout(n.timeout),n.timeout=setTimeout(()=>{t.onChangePaging&&t.onChangePaging(a)},800)):t.onChangePaging(a))}useEffect(()=>{t.paging&&r(i(t.paging))},[(t.paging||{size:0,number:0,length:0}).size,(t.paging||{size:0,number:0,length:0}).number,(t.paging||{size:0,number:0,length:0}).length]);let{number:l,size:s,sizes:u}=o,d=[],c=!0;for(let p=n.start;p<=n.end;p++)if(p<1||p>n.pages)d.push(_jsx("button",{className:"aio-input-table-paging-button aio-input-table-paging-button-hidden",children:p},p));else{let f;c?(f=1,c=!1):f=p===Math.min(n.end,n.pages)?n.pages:p,d.push(_jsx("button",{className:"aio-input-table-paging-button"+(f===l?" active":""),onClick:()=>a({number:f}),children:f},f))}function h(){if(!u||!u.length)return null;let e={attrs:{className:"aio-input-table-paging-button aio-input-table-paging-size"},type:"select",value:s,options:u,option:{text:"option",value:"option"},onChange:e=>a({size:e}),popover:{fitHorizontal:!0}};return _jsx(AIOInput,{...e})}return _jsxs("div",{className:"aio-input-table-paging",children:[d,h()]})}function TableRows(){let{ROWS:e,rootProps:t}=useContext(AITableContext),{rowTemplate:n,rowAfter:i=()=>null,rowBefore:o=()=>null,rowsTemplate:r,placeholder:a="there is not any items"}=t,l=e.pagedRows||[],s;if(r)s=r(l);else if(l.length)s=l.map((e,t)=>{let{id:r="ailr"+Math.round(1e7*Math.random())}=e;e._id=void 0===e._id?r:e._id;let a=t===l.length-1,s;return s=n?n({row:e,rowIndex:t,isLast:a}):_jsx(TableRow,{row:e,rowIndex:t,isLast:a},e._id),_jsxs(Fragment,{children:[o({row:e,rowIndex:t}),s,i({row:e,rowIndex:t})]},e._id)});else{if(!a)return null;s=_jsx("div",{style:{width:"100%",textAlign:"center",padding:12,boxSizing:"border-box"},children:a})}return _jsx("div",{className:"aio-input-table-rows",children:s})}function TableToolbar(){let{add:e,exportToExcel:t,sorts:n,sortRows:i,setSorts:o,search:r,rootProps:a,excelColumns:l}=useContext(AITableContext),{toolbarAttrs:s,toolbar:u,onAdd:d,onSearch:c,onChangeSort:p,onChange:f=()=>{},value:h,addText:m}=a;if(s=AddToAttrs(s,{className:"aio-input-table-toolbar"}),!d&&!u&&!c&&!n.length&&!l.length)return null;function g(e,t){$(n.map(n=>n.sortId===e?{...n,...t}:n))}async function $(e){if(p)!1!==await p(e)&&o(e);else{o(e);let t=e.filter(e=>!1!==e.active);t.length&&f(i(h,t))}}function y(){if(!n.length)return null;let e={popover:{header:{attrs:{className:"aio-input-table-toolbar-popover-header"},title:"Sort",onClose:!1},pageSelector:".aio-input-table"},caret:!1,type:"select",options:n,option:{text:"option.title",checked:"!!option.active",close:()=>!1,value:"option.sortId",after(e){let{dir:t="dec",sortId:n}=e;return _jsx("div",{onClick(e){e.stopPropagation(),g(n,{dir:"dec"===t?"inc":"dec"})},children:I("dec"===t?mdiArrowDown:mdiArrowUp,.8)})}},attrs:{className:"aio-input-table-toolbar-button"},text:I(mdiSort,.7),onSwap:(e,t,n)=>$(e),onChange:(e,t)=>g(e,{active:!t.checked})};return _createElement(AIOInput,{...e,key:"sortbutton"})}function v(){let{addText:e}=a;return a.addText?"function"==typeof e?e(h):e:I(mdiPlusThick,.8)}return _jsxs(_Fragment,{children:[_jsxs("div",{...s,children:[u&&_jsx("div",{className:"aio-input-table-toolbar-content",children:"function"==typeof u?u():u}),_jsx("div",{className:"aio-input-table-search",children:!!c&&_jsx(AIOInput,{type:"text",onChange:e=>r(e),after:I(mdiMagnify,.7)})}),y(),!!l.length&&_jsx("div",{className:"aio-input-table-toolbar-button",onClick:()=>t(),children:I(mdiFileExcel,.8)}),!!d&&_jsx("div",{className:"aio-input-table-toolbar-button",onClick:()=>e(),children:v()})]}),_jsx(TableGap,{dir:"h"})]})}function TableHeader(){let{rootProps:e,columns:t}=useContext(AITableContext),{headerAttrs:n,onRemove:i}=e;n=AddToAttrs(n,{className:"aio-input-table-header"});let o=t.map((e,n)=>_jsx(TableTitle,{column:e,isLast:n===t.length-1},e._id)),r=i?_jsxs(_Fragment,{children:[_jsx(TableGap,{dir:"v"}),_jsx("div",{className:"aio-input-table-remove-title"})]}):null;return _jsxs("div",{...n,children:[o,r,_jsx(TableGap,{dir:"h"})]})}function TableTitle(e){let{column:t,isLast:n}=e,{getCellAttrs:i}=useContext(AITableContext),o=i({column:t,type:"title"});return _jsxs(_Fragment,{children:[_jsx("div",{...o,children:o.title}),!n&&_jsx(TableGap,{dir:"v"})]})}function TableRow(e){let{row:t,isLast:n,rowIndex:i}=e,{remove:o,rootProps:r,columns:a,getRowAttrs:l}=useContext(AITableContext);function s(){return a.map((e,n)=>{let o=t._id+" "+e._id;return _jsx(TableCell,{isLast:n===a.length-1,row:t,rowIndex:i,column:e},o)})}let{onRemove:u}=r;return _jsxs(_Fragment,{children:[_jsxs("div",{...l(t,i),children:[s(),u?_jsxs(_Fragment,{children:[_jsx(TableGap,{dir:"v"}),_jsx("button",{className:"aio-input-table-remove",onClick:()=>o(t,i),children:I(mdiClose,.8)})]}):null]},t._id),_jsx(TableGap,{dir:"h"})]})}let TableCell=p=>{let{row,rowIndex,column,isLast}=p,{getCellAttrs,rootProps,getDynamics}=useContext(AITableContext),{onChange=()=>{},value=[]}=rootProps;function setCell(row,column,cellNewValue){column.input&&column.input.onChange?column.input.onChange({value:cellNewValue,row,column}):(row=JSON.parse(JSON.stringify(row)),eval(`${column.value} = cellNewValue`),onChange(value.map(e=>e._id!==row._id?e:row)))}let contentProps={row,rowIndex,column,onChange:column.input?e=>setCell(row,column,e):void 0},key=row._id+" "+column._id;return _jsxs(Fragment,{children:[_jsx("div",{...getCellAttrs({row,rowIndex,column,type:"cell"}),children:_createElement(TableCellContent,{...contentProps,key:key})}),!isLast&&_jsx(TableGap,{dir:"v"})]},key)};function TableCellContent(e){let{row:t,column:n,rowIndex:i,onChange:o}=e,{getDynamics:r}=useContext(AITableContext),a=r({value:n.template,row:t,rowIndex:i,column:n});if(void 0!==a)return a;let l=r({value:n.input,row:t,rowIndex:i,column:n}),s=r({value:n.value,row:t,rowIndex:i,column:n});if(!l)return s;l.justify=l.justify||r({value:n.justify,row:t,rowIndex:i,column:n});let u={type:"text"};for(let d in l){let c=d,p=l[c];-1!==["onChange","onClick"].indexOf(c)?u[c]=p:u[c]=r({value:p,row:t,rowIndex:i,column:n})}return _createElement(AIOInput,{...{...u,value:s,onChange:o,type:l.type},key:t._id+" "+n._id})}function AIOInputSearch(e,t,n){if(!t)return e;function i(e,t){for(let n=0;n<e.length;n++)if(-1===t.indexOf(e[n]))return!1;return!0}let o=t.split(" ");return e.filter((e,t)=>i(o,n?n(e,t):e))}let RangeContext=createContext({}),Range=()=>{let{rootProps:e}=useContext(AICTX),{start:t=0,end:n=360,min:i=t,max:o=n,step:r=1,reverse:a,round:l,vertical:s,multiple:u,text:d,onChange:c,size:p=Def("range-size"),disabled:f,className:h,labels:m=[],rotate:g=0}=e,[y]=useState({dom:createRef(),start:0,index:!1});function v(e){Array.isArray(e)||(e=[e||0]);for(let n=0;n<e.length;n++){let a=e[n]||0;(a=+(a=Math.round((a-t)/r)*r+t).toFixed(GetPrecisionCount(r)))<i&&(a=i),a>o&&(a=o),e[n]=a}return e}let _=v(e.value),b=useRef(_);b.current=_;let[x,C]=useState(k());function k(){if(!Array.isArray(f))return{};let e={};for(let t=0;t<f.length;t++)e["a"+f[t]]=!0;return e}function N(e){return"point"===e?l?100:0:"label"===e?l?116:14:"scale"===e?l?100:14:0}function w(e){c&&(e=v(e),c(u?e:e[0]))}function P(e){if(!0===f||!1!==y.index)return;let t=b.current,n;(!((n=l?X(e.centerAngle):W(e[s?"yp":"xp"]))<t[t.length-1])||!(n>t[0]))&&(n<t[0]?M(-1):M(1))}function T(e){for(let t=0;t<e.length;t++)if(j(e[t]))return!1;return!0}useEffect(()=>{C(k())},[JSON.stringify(f)]),useEffect(()=>{clearTimeout(y.timeOut),y.timeOut=setTimeout(()=>{new Swip({reverseX:!!a,reverseY:!!a&&!!s,dom:()=>$(y.dom.current),start(e){let{event:t}=e;if(null!==t.target){let n=$(t.target);if(HasClass(n,"ai-range-point")){let i=n.attr("data-index")||"0";y.index=+i}else y.index=!1;y.start=[...b.current]}return[0,0]},move(e){let{change:t,mousePosition:n}=e;t&&L({dx:t.dx,dy:t.dy,deltaCenterAngle:t.deltaCenterAngle,centerAngle:n.centerAngle})},onClick:function(e){P(e.mousePosition)}})},100)},[L]);let D=(e,t={})=>{let{half:n=!1,range:i=p/(n?2:1)}=t,o=i*e/100,{min:r,max:a}=t;return void 0!==r&&o<r&&(o=r),void 0!==a&&o>a&&(o=a),o},A=(e,t)=>{let[n,i,o,r,a]=e.split(" "),l=1,s=0,u=!1,d="#000",c=!0;try{let f=+n;isNaN(f)&&(f=1),l=f;let h=+i;isNaN(h)&&(h=0);let m=p/2-l/2;(s="offset"===t?m-h:h)>m&&(s=m),s<l/2&&(s=l/2),u="1"===r,c="1"===a,d=o}catch{}return{thickness:l,radius:s,color:d,roundCap:u,full:c}},O=e=>{let[t,n,i,o]=e.split(" "),r=1,a=0,l=!1,s="#000";try{let u=+t;isNaN(u)&&(u=1),r=u;let d=+n;isNaN(d)&&(d=0);(a=p/2-r/2-d)>p-r/2&&(a=p-r/2),a<r/2&&(a=r/2),l="1"===o,s=i}catch{}return{thickness:r,offset:a,color:s,roundCap:l}};function M(e){let t=[...b.current],n=JSON.stringify(t);for(t=R(t,e*r);!T(t)&&JSON.stringify(t)!==n;)n=JSON.stringify(t),t=R(t,e*r);w(t)}function L(e){if(!0===f)return;let t=S(e);w(t)}function z(e){let i=b.current,o,r;return o=0===e?t:i[e-1],r=e===i.length-1?n:i[e+1],{before:o,after:r}}function R(e,i,o){let r=e.map(e=>e+i);return r[0]<t||r[r.length-1]>n?o?b.current:e:r}function S(e){let{dx:i,dy:o,deltaCenterAngle:a,centerAngle:u}=e,d=[...y.start],c=y.index;1===d.length&&!1===c&&(c=0);let p;if(!1===c){let f;if(l){let h=a*(n-t)/360;f=h=Math.round(h/r)*r}else f=Math.round(W(Z(s?o:i))/r)*r;let m=R(d,f,!0);p=T(m)?m:b.current}else{let{before:g,after:v}=z(c),_;if(l)_=Math.round(X(u)/r)*r;else{let x=Math.round(W(Z(s?o:i))/r)*r;_=d[c]+x}_>v&&(_=v),_<g&&(_=g),j(_)&&(_=b.current[c]),d[c]=_,p=d}return p}function H(){return s?a?"bottom":"top":a?"right":"left"}function G(){return s?"left":"top"}function j(e){return!!x[`a${e}`]}function V(){let e="ai-range";return l?e+=" ai-range-round":e+=` ai-range-${s?"vertical":"horizontal"}`,h&&(e+=" "+h),a&&(e+=" ai-range-reverse"),e}function F(){let{style:t}=e,n;return{...n=l?{width:p,height:p}:s?{width:p}:{height:p},...t}}function q(){let{attrs:t={}}=e,n=F();return AddToAttrs(t,{className:V(),style:n,attrs:{ref:y.dom}})}function B(){return _jsxs("div",{...q(),children:[_jsx(RangeGroove,{}),void 0!==d&&_jsx("div",{className:"ai-range-text",children:"function"==typeof d?d():d},"rangetext"),!l&&_jsxs(Fragment,{children:[_jsx(RangeRanges,{}),_jsx(RangeFills,{})]},"rangefill"),_jsx(RangeSvg,{}),m.map((e,t)=>_jsx(RangeLabel,{label:e},t)),_.map((e,t)=>_jsx(RangeValueContainer,{index:t,itemValue:e},"rangecontainervalue"+t))]})}function K(e){let i=l=l||1,o=(1-i)*(n-t)/i;return e>n+o/2&&(e=t-o+e-n),e}function X(e){let i=360*(l||1),o=360-i;a&&(e=180-e),e-=g,e-=o/2,e-=90;let r=(e=U(e))*(n-t)/i;return K(r)}function Y(e,i){let o=360*l,r=360-o,s=e*o/(n-t);return s+=90,s+=r/2,s+=g,s+=i||0,a?s=180-s:s}function U(e){return(e%=360)<0?e=360+e:e}function E(e){return 100*(e-t)/(n-t)}function W(e){return e*(n-t)/100}function Z(e){return 100*e/$(y.dom.current)[s?"height":"width"]()}function J(){return{getXPByValue:E,rootProps:e,fixAngle:U,getAngleByValue:Y,dom:y.dom,getCircleByStr:A,getRectByStr:O,isValueDisabled:j,value:b.current,getSide:H,getOffset:G,getDefaultOffset:N,sbp:D}}return _jsx(RangeContext.Provider,{value:J(),children:B()})},RangeGroove=()=>{let{rootProps:e}=useContext(RangeContext),t=AddToAttrs(e.grooveAttrs,{className:"ai-range-groove"});return e.round?null:_jsx("div",{...t})},RangeSvg=()=>{let{rootProps:e,value:t}=useContext(RangeContext),{round:n,ranges:i=[],circles:o=[],size:r=Def("range-size"),end:a=360}=e;if(!n||!(i||[0]).length&&!o.length)return null;let l=[_jsx(RangeCircles,{}),_jsx(RangeRanges,{})];return _jsx("svg",{style:{position:"absolute",left:0,top:0},width:r,height:r,children:l})},RangeCircles=()=>{let{rootProps:e,getCircleByStr:t}=useContext(RangeContext),{start:n=0,end:i=360,circles:o=[],size:r=Def("range-size")}=e,a=[];for(let l=0;l<o.length;l++){let s=n,u=i,{thickness:d,color:c,radius:p,roundCap:f,full:h}=t(o[l],"radius"),m={thickness:d,color:c,from:s,to:u,radius:p,full:h,roundCap:f};a.push(_jsx(RangeArc,{...m}))}return _jsx(_Fragment,{children:a})},RangeFills=()=>{let{rootProps:e,value:t}=useContext(RangeContext),{start:n=0,fill:i,round:o}=e;if(o||!1===i)return null;let r=1===t.length?[n,t[0]]:[...t],a=[];for(let l=1;l<r.length;l++){let{thickness:s,style:u,className:d,color:c}=("function"==typeof i?i(l):i)||{},p=r[l-1],f=r[l],h="ai-range-fill";d&&(h+=" "+d);let m={thickness:s,color:c,from:p,to:f,className:h,style:u};a.push(_createElement(RangeRect,{...m,key:"fill"+l}))}return _jsx(_Fragment,{children:a})},RangeRanges=()=>{let{rootProps:e,getCircleByStr:t,getRectByStr:n}=useContext(RangeContext),{start:i=0,ranges:o=[],round:r}=e,a=[],l=i,s=o;for(let u=0;u<s.length;u++){let[d,c]=s[u],p=d,f;if(r){let{thickness:h,color:m,radius:g,roundCap:$}=t(c,"offset");f=_jsx(RangeArc,{thickness:h,color:m,from:l,to:p,radius:g,roundCap:$,full:!1})}else{let{thickness:y,color:v,offset:_,roundCap:b}=n(c);f=_createElement(RangeRect,{thickness:y,color:v,from:l,to:p,offset:_,roundCap:b,className:"ai-range-range",key:"range"+u})}a.push(f),l=p}return _jsx(_Fragment,{children:a})},RangeValueContainer=e=>{let{rootProps:t,isValueDisabled:n,fixAngle:i,getAngleByValue:o,getXPByValue:r,dom:a,getSide:l}=useContext(RangeContext),{itemValue:s,index:u}=e,{round:d}=t,c=i(o(s));function p(){let e;return e=d?{transform:`rotate(${c}deg)`}:{[l()]:r(s)+"%"},{className:"ai-range-value-container",draggable:!1,style:e}}let f={value:s,index:u,disabled:n(s),angle:c,parentDom:a};return _jsxs("div",{...p(),children:[_createElement(RangeHandle,{...f,key:"handle"})," ",_createElement(RangePoint,{...f,key:"point"})]})},RangeRect=({thickness:e,color:t,from:n,to:i,className:o,style:r,offset:a,roundCap:l})=>{let{getXPByValue:s,rootProps:u,getSide:d}=useContext(RangeContext),{vertical:c}=u,p=s(n),f={[c?"height":"width"]:s(i)-p+"%"},h={[c?"width":"height"]:e},m={[d()]:p+"%"},g=a?{[c?"left":"top"]:a}:{},$=l?{borderRadius:"100%"}:{},y={background:t};return _jsx("div",{className:o,style:{...f,...h,...m,...g,...$,...y,...r}})},RangeArc=({thickness:e,color:t,from:n,to:i,radius:o,full:r,roundCap:a})=>{let{fixAngle:l,getAngleByValue:s,rootProps:u}=useContext(RangeContext),{size:d=Def("range-size"),reverse:c}=u,p,f,h=d/2,m=d/2;if(r)p=0,f=360;else{let g=l(s(n)+90),$=l(s(i)+90);0===$&&($=360),p=g,f=$,c&&(f=g,p=$)}return _jsx("path",{d:svgArc(h,m,o,p,f),stroke:t,strokeWidth:e,fill:"transparent",strokeLinecap:a?"round":void 0},`from${n}to${i}`)},RangePoint=e=>{let{rootProps:t,getOffset:n,sbp:i}=useContext(RangeContext),[o]=useState({dom:createRef()}),{value:r,disabled:a,angle:l,index:s,parentDom:u}=e;if(!1===t.point)return null;let{round:d,size:c=Def("range-size")}=t,{attrs:p={},html:f=r,offset:h=0}=(t.point||(()=>{}))(r,{disabled:a,angle:l,value:r,index:s})||{},m=getEventAttrs("onMouseDown",()=>{let e=$(u.current).find("ai-range-value-container");e.css({zIndex:10}),e.eq(s).css({zIndex:100})}),g,y={...p.style};g=d?{left:c/2+h,transform:`rotate(${-l}deg)`}:{[n()]:h};let v={ref:o.dom,className:"ai-range-point-container",style:g,draggable:!1},_=AddToAttrs(p,{className:["ai-range-point"],style:y,attrs:{draggable:!1,"data-index":s,...m}});return _createElement("div",{...v,key:"rangepoint"+s},_jsx("div",{..._,children:f}))},RangeHandle=e=>{let{rootProps:t,sbp:n}=useContext(RangeContext),{value:i,angle:o,disabled:r,index:a}=e,{handle:l=()=>{},round:s}=t;if(!1===l||!s)return null;if(l&&"function"!=typeof l)return alert(`aio-input error => in type round, handle props should be a function,
        handle type = (value:number,{disabled:boolean,angle:number})=>{attrs:any}`),null;let{sharp:u=!1,thickness:d=10,size:c=90,color:p="#000",offset:f=0}=l(i,{angle:o,disabled:r,value:i})||{},h=n(c,{half:!0}),m=n(d,{half:!0});function g(){return u?{[h<0?"borderRight":"borderLeft"]:`${Math.abs(h)}px solid ${p}`,borderTop:`${m/2}px solid transparent`,borderBottom:`${m/2}px solid transparent`,left:f}:{width:h,height:m,left:f,background:p}}let $=AddToAttrs({},{className:"aio-input-handle",style:g(),attrs:{draggable:!1}});return _createElement("div",{...$,key:"rangehandle"+a})},RangeLabel=e=>{let{dom:t,rootProps:n}=useContext(RangeContext),{label:i}=e,{zIndex:o,dynamic:r,step:a,list:l=[]}=i,{round:s,start:u=0,end:d=360,reverse:c,vertical:p}=n,[f]=useState(h);function h(){return y(!0)}function m(){let e=[];if(a){let{start:t=u,end:n=d}=i;for(let o=t;o<=n;o+=a)e.push(o)}for(let r=0;r<l.length;r++)-1===e.indexOf(l[r])&&e.push(l[r]);return e}function g(){if(s||!i.autoHide||p)return;let e=$(t.current).find(".ai-range-label");if(!e.length)return;let n=e.eq(0),o="yes"===n.attr("data-rotated")?"height":"width",r=n.offset().left+(c?0:n[o]());for(let a=1;a<e.length;a++){let l=e.eq(a),u="yes"===l.attr("data-rotated")?"height":"width";l.css({display:"flex"});let d=l.offset().left,f=l[u](),h=d+f;c?h>r-5?l.css({display:"none"}):r=d:d<r+5?l.css({display:"none"}):r=d+f}}function y(e){return e||r?_jsx("div",{className:"ai-range-labels",style:{zIndex:o},children:m().map(e=>_jsx(RangeLabelItem,{label:i,itemValue:e},e))}):f}return useEffect(()=>{$(window).on("resize",g)},[]),useEffect(()=>{g()}),_jsx(_Fragment,{children:y(!1)})},RangeLabelItem=e=>{let{rootProps:t,isValueDisabled:n,fixAngle:i,getAngleByValue:o,getXPByValue:r,getSide:a}=useContext(RangeContext),{label:l,itemValue:s}=e,{round:u,vertical:d,size:c=Def("range-size")}=t,p;u&&(p=i(o(s)));let f=n(s);function h(e){return u?{transform:`rotate(${p}deg)`}:{[a()]:r(s)+"%",...e}}function m(e,t){let n={};return u&&(n={...n,...t},e.fixAngle&&(n={...n,transform:`rotate(${-p}deg)`})),{width:0,height:0,...n}}function g(){let e=l.setting(s,{disabled:f,angle:p}),{offset:t=0,html:n=""}=e,i={[u||d?"left":"top"]:c/2+t},o={className:"ai-range-label-container",style:h(i),draggable:!1},r=AddToAttrs({},{className:["ai-range-label"],style:m(e,i),attrs:{draggable:!1}});return{html:n,textProps:r,containerProps:o}}let{html:$,textProps:y,containerProps:v}=g();return _jsx("div",{...v,children:_jsx("div",{...y,children:$})})},MapContext=createContext({});function Map(){let{rootProps:e}=useContext(AICTX),{popupConfig:t,mapConfig:n={},onChange:i=()=>{},disabled:o,attrs:r,value:a}=e,[l,s]=useState(!1);return(useEffect(()=>{try{let e=document.createElement("script");e.src="https://static.neshan.org/sdk/leaflet/1.4.0/leaflet.js",e.id="aio-input-map-neshan",e.onload=()=>s(!0),document.body.appendChild(e)}catch(t){console.log(t)}},[]),l)?_jsx(MapUnit,{popupConfig:t,onChange:i,attrs:r,value:a,mapConfig:n,disabled:!0===o}):null}function MapUnit(e){let[t]=useState(new Storage("aio-input-storage").load("mapApiKeys",{map:"",service:""})),{onClose:n,mapConfig:i={},onChange:o=()=>{},disabled:r,attrs:a={},popupConfig:l}=e,{area:s,zoom:u=14,traffic:d=!1,markers:c=[],zoomControl:p=!1,maptype:f="dreamy-gold",poi:h=!0,draggable:m=!0}=i,[g,y]=useState(!1),[v,_]=useState(e.value),[b,x]=useState(""),[C,k]=useState(!1),[N]=useState(u),[w,P]=useState(!1),[T]=useState({datauniqid:"mp"+Math.round(1e7*Math.random()),markers:[],dom:createRef(),map:void 0,L:window.L,atimeout:void 0,btimeout:void 0,area:void 0,mapMarker:void 0,lastChange:void 0}),[D]=useState(new MarkerClass(()=>T,()=>i));D.updateMarkers(c),useEffect(()=>{w&&D.addMarkersToMap(v)},[JSON.stringify(D.htmls)]);let A=!!m&&!r;function O(){if(T.area&&T.area.remove(),s&&T.L&&T.map){let{color:e="dodgerblue",opacity:t=.1,radius:n=1e3,lat:i,lng:o}=s;T.area=T.L.circle([i,o],{color:e,fillColor:e,fillOpacity:t,radius:n}).addTo(T.map)}}function M(){$.ajax("http://ip-api.com/json").then(e=>{let{lat:t,lon:n}=e;S({lat:t,lng:n})},(e,t)=>console.log("Request failed.  Returned status of",t))}function L(){navigator.permissions.query({name:"geolocation"}).then(e=>{"granted"===e.state?console.log(e.state):"prompt"===e.state?console.log(e.state):"denied"===e.state&&console.log(e.state)})}async function z(e){let{lat:n,lng:i}=e;try{let o=await Axios.get(`https://api.neshan.org/v5/reverse?lat=${n}&lng=${i}`,{headers:{"Api-Key":t.service,Authorization:!1}});return 200!==o.status?"":o.data.formatted_address}catch(r){return""}}function R(){"geolocation"in navigator?(L(),navigator.geolocation.getCurrentPosition(e=>{let{latitude:t,longitude:n}=e.coords;S({lat:t,lng:n})},()=>{M()})):M()}function S(e){if(!e)return;let t=GetDistance(v,e)>.3;T.map.flyTo([e.lat,e.lng],N,{animate:t,duration:1})}function H(e){T.map.panTo(e)}async function G(e){if(!i.address)return;let{lat:t,lng:n}=e;clearTimeout(T.atimeout),(!T.lastChange||t!==T.lastChange.lat||n!==T.lastChange.lng)&&(T.lastChange={lat:t,lng:n},k(!0),T.atimeout=setTimeout(async()=>{let e=await z({lat:t,lng:n});x(e),k(!1),o({lat:t,lng:n,address:e})},1200))}function j(e){let{lat:t,lng:n}=e;o({lat:t,lng:n,address:b}),G(e)}function V(e){T.mapMarker&&T.mapMarker.setLatLng(e),clearTimeout(T.atimeout),clearTimeout(T.btimeout),T.btimeout=setTimeout(async()=>{_(e),j(e)},500)}function F(){S(e.value),O(),D.addMarkersToMap(v),G(v)}function q(){return{mapApiKeys:t,value:v,addressLoading:C,address:b,flyTo:S,goToCurrent:R,onClose:n,mapConfig:i,popupConfig:l,onChange:o}}function B(){if(g){let e={value:v,disabled:r,mapConfig:{...l,isPopup:!0},onClose:()=>y(!1),attrs:a,onChange(e){V(e)}};return _jsx(MapUnit,{...e})}return null}function K(){return _jsx(MapHeader,{})}function X(){return _jsx("div",{style:{flex:1},ref:T.dom})}function Y(){return _jsx(MapFooter,{})}function U(){let e="aio-input-map-container";return!1===i.draggable&&(e+=" not-draggable"),i.isPopup&&(e+=" aio-input-map-container-popup"),a.className&&(e+=" "+a.className),e}return useEffect(()=>{let e={key:t.map,maptype:f,poi:h,traffic:d,center:[v.lat,v.lng],zoom:N,dragging:!r,scrollWheelZoom:"center",zoomControl:p};T.map=new T.L.Map(T.dom.current,e),D.addMapMarker(v),T.map.on("click",e=>{if(!a.onClick&&o){let{lat:t,lng:n}=e.latlng;T.map.panTo({lat:t,lng:n})}}),T.map.on("move",e=>{if(!A)return;let{lat:t,lng:n}=e.target.getCenter();V({lat:t,lng:n})}),P(!0),F()},[]),useEffect(()=>{w&&O()},[JSON.stringify(s||{})]),useEffect(()=>{w&&F()},[e.value.lat,e.value.lng,u]),_jsxs(MapContext.Provider,{value:q(),children:[_jsxs("div",{className:U(),style:a.style,onClick(){l&&y(!0)},children:[K()," ",X()," ",Y()]}),B()]})}class MarkerClass{constructor(e,t){_defineProperty(this,"getHtml",void 0),_defineProperty(this,"getHtmls",void 0),_defineProperty(this,"updateMarkers",void 0),_defineProperty(this,"getIcon",void 0),_defineProperty(this,"addMapMarker",void 0),_defineProperty(this,"addMarkersToMap",void 0),_defineProperty(this,"markers",void 0),_defineProperty(this,"marker",void 0),_defineProperty(this,"htmls",void 0),this.markers=[],this.htmls=[],this.updateMarkers=e=>{this.markers=e,this.htmls=this.getHtmls()},this.getHtml=t=>{let{datauniqid:n}=e(),{size:i=20,color:o="orange",html:r,text:a,lat:l,lng:s}=t,u=.4*i,d,c=Math.round(i/25),p=`transform:translateY(-${i/2+u}px);flex-shrink:0;color:${o};width:${i}px;height:${i}px;border:${Math.ceil(i/10)}px solid;position:relative;border-radius:100%;display:flex;align-items:center;justify-content:center;`,f=`position:absolute;left:calc(50% - ${u}px);top:calc(100% - ${c}px);border-top:${u}px solid ${o};border-left:${u}px solid transparent;border-right:${u}px solid transparent;`,h="",m="";return r&&(h=JSXToHTML(r)),a&&(m=JSXToHTML(a)),`<div class='aio-input-map-marker' data-lat='${l}' data-lng='${s}' data-parent='${n}' style="${p}">${h}<div class='aio-input-map-marker-text'>${m}</div><div style="${f}"></div></div>`};let{marker:n=!0}=t();this.marker="boolean"==typeof n?n:this.getHtml(n),this.getHtmls=()=>this.markers.map(e=>this.getHtml(e)),this.getIcon=t=>"string"==typeof t&&{icon:e().L.divIcon({html:t})},this.addMarkersToMap=()=>{let e=this.marker;if(!1===e)return;let t=!0===e||void 0===e?void 0:this.getIcon(this.getHtml(e));return(e,n,i)=>i.mapMarker=i.L.marker([e,n],t).addTo(i.map)},this.addMapMarker=t=>{let n=e();if(!1===this.marker)return;let i=!0===this.marker||void 0===this.marker?void 0:this.getIcon(this.marker);n.mapMarker=n.L.marker([t.lat,t.lng],i).addTo(n.map)},this.addMarkersToMap=t=>{let n=e();if(n.map&&n.L){if(n.markers.length){for(let i=0;i<n.markers.length;i++)n.markers[i].remove();n.markers=[]}for(let o=0;o<this.htmls.length;o++){let r=this.htmls[o],a=this.getIcon(r),{lat:l=t.lat,lng:s=t.lng,popup:u=()=>""}=this.markers[o],d=u(this.markers[o]);if("string"!=typeof d)try{d=d.toString()}catch{}n.markers.push(n.L.marker([l,s],a).addTo(n.map).bindPopup(d))}}}}}function MapHeader(){let{value:e,flyTo:t,goToCurrent:n,mapApiKeys:i,mapConfig:o={},onClose:r}=useContext(MapContext),{title:a,search:l}=o,[s,u]=useState(""),[d,c]=useState([]),[p,f]=useState(!1),[h,m]=useState(!1),g=createRef(),$;async function y(t){let{lat:n,lng:o}=e;if(u(t),clearTimeout($),!t){c([]);return}$=setTimeout(async()=>{try{let e={headers:{"Api-Key":i.service,Authorization:!1}},r=`https://api.neshan.org/v1/search?term=${decodeURI(t)}&lat=${n}&lng=${o}`;f(!0);let a=await Axios.get(r,e);if(f(!1),200!==a.status)return;c(a.data.items)}catch(l){}},1e3)}function v(){return _jsx(AIOInput,{type:"text",placeholder:l,className:"aio-input-map-serach-input",value:s,attrs:{ref:g},options:d,caret:!1,before:_jsx("div",{onClick:()=>n(),className:"aio-input-map-header-current",children:I(mdiCrosshairsGps,.6)}),after(){let e,t,n,i;return p?(e=mdiLoading,t=.4,n=1):h&&d.length?(e=mdiClose,n=.8,i=()=>{y("")}):(e=mdiMagnify,n=.8),_jsx("div",{className:"aio-input-map-serach-icon",onClick:i,children:I(e,n,{spin:t})})},option:{text:"option.title",value:'option.location.x + "-" + option.location.y',close:()=>!0,subtext:"option.address",onClick:e=>t({lat:e.object.location.y,lng:e.object.location.x})},onChange:e=>y(e)})}return l||a||r?_jsxs("div",{className:"aio-input-map-header"+(d&&d.length&&h?" aio-input-map-header-open":""),children:[_jsxs("div",{className:"aio-input-map-header-title",children:[!!r&&_jsx("div",{className:"aio-input-map-header-close",onClick:()=>r(),children:I(mdiChevronRight,1)}),a||null]}),!!l&&_jsx("div",{className:"aio-input-map-search",children:v()})]}):null}function MapFooter(){let{value:e,addressLoading:t,address:n,onClose:i,onChange:o,mapConfig:r={}}=useContext(MapContext),{lat:a,lng:l}=e;function s(){if(!r.isPopup)return null;let{submitText:t="Submit"}=r;return _jsx("button",{className:"aio-input-map-submit",async onClick(){o(e),i&&i()},children:t})}function u(){return r.address?t?d():_jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[c()," ",p()]}):null}function d(){return _jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",flex:1},children:I(mdiLoading,1,{spin:.4})})}function c(){return _jsx("div",{className:"aio-input-map-address",children:n})}function p(){if(!a||!l)return null}return r.isPopup||r.address?_jsxs("div",{className:"aio-input-map-footer",children:[u()," ",s()]}):null}export const SideMenu=e=>{let{options:t=[],onChange:n}=e,i="aio-input-sidemenu";function o(e){let{badge:t}=e;if(t||(t=[]),Array.isArray(t)||(t=[t]),!t.length)return[];let n=[];for(let o=0;o<t.length;o++){let{text:r,color:a="red",circle:l}=t[o];n.push(_jsx("div",{className:`${i}-badge ${i}-align ${i}-badge-${a}${l?" "+i+"-badge-circle":""}`,children:r}))}return n}function r(e,t){let{options:n=[]}=e,r=!!t.isOpen&&t.isOpen(e.value),a=o(e);return _jsxs("div",{className:`${i}-after ${i}-align`,children:[!!a.length&&a,!!n.length&&_jsx(Icon,{path:r?mdiChevronDown:mdiChevronRight,size:.7})]})}function a(e,t){let{icon:n=_jsx(Icon,{path:mdiCircle,size:.6})}=e;return n?_jsxs("div",{className:`${i}-before`,children:[0===t.level&&_jsx("div",{className:`${i}-icon ${i}-align`,children:n}),0!==t.level&&n]}):null}return _jsx(AIOInput,{type:"tree",className:i,size:48,value:[...t],getChilds:e=>e.row.options||[],option:{text:"option.text",value:"option.value",toggleIcon:()=>!1,after:(e,t)=>r(e,t),before:(e,t)=>a(e,t),onClick(e,t){let{options:i=[]}=e;i.length?t.toggle&&t.toggle():n&&n(e.value)},className:(e,t)=>`${i}-row-level-${t.level}`},indent:0})};function GetDistance(e,t){let{lat:n,lng:i}=e,{lat:o,lng:r}=t,a=Math.PI/180;return 6371*Math.acos(Math.sin(o*a)*Math.sin(n*a)+Math.cos(o*a)*Math.cos(n*a)*Math.cos(r*a-i*a))}export class AIOValidation{constructor(e){_defineProperty(this,"contain",void 0),_defineProperty(this,"startBy",void 0),_defineProperty(this,"equal",void 0),_defineProperty(this,"less",void 0),_defineProperty(this,"greater",void 0),_defineProperty(this,"between",void 0),_defineProperty(this,"getMessage",void 0),_defineProperty(this,"translate",void 0),_defineProperty(this,"getResult",void 0),_defineProperty(this,"getValidation",void 0),_defineProperty(this,"validate",void 0),_defineProperty(this,"fnMapper",void 0),_defineProperty(this,"boolKey",void 0),_defineProperty(this,"boolDic",void 0),_defineProperty(this,"getUnit",void 0);let{lang:t="en",value:n}=e,i="string"==typeof n&&-1!==n.indexOf("/");this.boolDic=i?{more:{en:"after",fa:"بعد از"},less:{en:"before",fa:"قبل از"}}:{more:{en:"more",fa:"بیشتر"},less:{en:"less",fa:"کمتر"}},this.boolKey=e=>this.boolDic[e][t];let o=new AIODate;this.contain=(e,t)=>{let n;return n=Array.isArray(t)?-1!==t.indexOf(e):"number"===e?/\d/.test(t):"letter"===e?/[a-zA-Z]/.test(t):"uppercase"===e?/[A-Z]/.test(t):"lowercase"===e?/[a-z]/.test(t):"symbol"===e?/[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]+/.test(t):"function"==typeof e.test?e.test(t):-1!==t.indexOf(e),{result:n,unit:""}},this.startBy=(e,t)=>({result:0===t.indexOf(e),unit:""}),this.equal=(e,t)=>{let n=Array.isArray(t)?"array":typeof t,r=typeof e,a,l;return i?(a=o.isEqual(t,"number"==typeof e?e.toString():e),l=""):("array"===n||"string"===n)&&"number"===r?(a=t.length===e,l=this.getUnit(t)):(a=JSON.stringify(t)===JSON.stringify(e),l=""),{result:a,unit:l}},this.less=(e,t,n)=>{let r=Array.isArray(t)?"array":typeof t,a=typeof e,l,s="";return i?(l=o.isLess(t,"number"==typeof e?e.toString():e),s=""):"number"===a&&"number"===r?(l=t<e,s=""):("array"===r||"string"===r)&&"number"===a?(l=t.length<e,s=this.getUnit(t)):(l=!1,s=""),{result:n?l||this.equal(e,t).result:l,unit:s}},this.greater=(e,t,n)=>{let r=Array.isArray(t)?"array":typeof t,a=typeof e,l,s;return i?(l=o.isGreater(t,"number"==typeof e?e.toString():e),s=""):"number"===a&&"number"===r?(l=t>e,s=""):("array"===r||"string"===r)&&"number"===a?(l=t.length>e,s=this.getUnit(t)):(l=!1,s=""),{result:n?l||this.equal(e,t).result:l,unit:s}},this.between=(e,t,n)=>{let i=this.greater(e[0],t).result,o=this.less(e[1],t).result,r=!!i&&!!o;return{result:n?r||this.equal(e[0],t).result||this.equal(e[1],t).result:r,unit:""}},this.translate=e=>({contain:{en:"should be contain",fa:`باید شامل`},"!contain":{en:"should not be contain",fa:`نمی تواند شامل`},">":{en:`should be ${this.boolKey("more")} than`,fa:`باید ${this.boolKey("more")} از`},"!>":{en:`could not be ${this.boolKey("more")} than`,fa:`نباید ${this.boolKey("more")} از`},">=":{en:`should be ${this.boolKey("more")} than or equal`,fa:`باید ${this.boolKey("more")} یا مساوی`},"!>=":{en:`could not be ${this.boolKey("more")} than or equal`,fa:`نباید ${this.boolKey("more")} یا مساوی`},"<":{en:`should be ${this.boolKey("less")} than`,fa:`باید ${this.boolKey("less")} از`},"!<":{en:`could not be ${this.boolKey("less")} than`,fa:`نباید ${this.boolKey("less")} از`},"<=":{en:`should be ${this.boolKey("less")} than or equal`,fa:`باید ${this.boolKey("less")} یا مساوی`},"!<=":{en:`could not be ${this.boolKey("less")} than or equal`,fa:`نباید ${this.boolKey("less")} یا مساوی`},"=":{en:"should be equal",fa:`باید برابر`},"!=":{en:"cannot be equal",fa:`نمی تواند برابر`},startBy:{en:"should start by",fa:`باید در ابتدا شامل`},required:{en:"",fa:""}})[e][t],this.fnMapper=e=>({contain:"contain","!contain":"contain",startBy:"startBy","!=":"equal","=":"equal","<":"less","<=":"less","!<":"less","!<=":"less",">":"greater",">=":"greater","!>":"greater","!>=":"greater","<>":"between","<=>":"between","!<>":"between","!<=>":"between"})[e],this.getMessage=t=>{let{operator:n,target:i,unit:o,title:r,message:a}=t;return a?a:(`${r} ${this.translate(n)} ${i} ${o}`+("fa"===e.lang?" باشد":"")).trim()},this.getResult=e=>{let{target:t,message:n,title:i,value:o,operator:r}=e,a=r,l=!1,s=-1!==r.indexOf("=");0===a.indexOf("!")&&(l=!0,a=r.slice(1,r.length));let{result:u,unit:d}=(0,this[this.fnMapper(a)])(t,o,s);if(l&&u||!l&&!u)return this.getMessage({operator:r,target:t,message:n,title:i,unit:d})},this.getUnit=e=>{let n="";return Array.isArray(e)?n="fa"===t?"مورد":"items(s)":"string"==typeof e&&(n="fa"===t?"کاراکتر":"character(s)"),n},this.getValidation=()=>{let{value:n,validations:i=[]}=e;for(let o=0;o<i.length;o++){let[r,a,l]=i[o].split(","),s,u=e.title,d="";l&&("title("===l[0]&&")"===l[l.length-1]?u=l.slice(6,l.length-1):"message("===l[0]&&")"===l[l.length-1]?d=l.slice(8,l.length-1):s=ParseString(l));let c;if("required"===r){if(null==n||""===n||!1===n||0===n.length){if("en"===t)return`${u} is required`;if("fa"===t)return`وارد کردن ${u} ضروری است`}}else{let p=-1!==r.indexOf("<")&&-1!==r.indexOf(">");a=ParseString(a);let f;f=p?[a,s]:a,c=this.getResult({operator:r,target:f,title:u,message:d,value:n})}if(c)return c}},this.validate=()=>{let e;try{e=this.getValidation()}catch{e=""}return e}}}export function AIOInput_defaultProps(e){let t=new Storage("aio-input-storage");for(let n in e)t.save(n,e[n])}function getTypes(e){function t(){return -1!==["select","date","time"].indexOf(n)||-1!==["text","number","textarea"].indexOf(n)&&!!e.options||"button"===n&&!!e.popover}let{type:n,multiple:i}=e,o;return o="table"===n||"tags"===n||-1!==["radio","range","file","buttons","select","date","acardion"].indexOf(n)&&!!i,{isMultiple:o,isInput:-1!==["text","number","textarea","password"].indexOf(n),isDropdown:t(),hasOption:-1!==["text","number","textarea","color","select","radio","tabs","list","buttons","tags"].indexOf(n),hasPlaceholder:-1!==["text","number","textarea","color","select","table","image","date"].indexOf(n),hasKeyboard:-1!==["text","textarea","number","password"].indexOf(n),hasText:-1!==["checkbox","button","select"].indexOf(n),hasSearch:-1!==["table","select"].indexOf(n)}}function getDefaultProps(e,t){let n=Array.isArray(e.value)?"array":typeof e.value;return"select"===(e={...e}).type?e.multiple&&!e.text&&(e.text="Select Items"):"time"===e.type?e.value||(e.value={}):"acardion"===e.type?e.deSelect=!0:"date"===e.type?e.multiple&&(e.option={...e.option,text:"option",value:"option"}):"map"!==e.type||(e.value||(e.value={lat:35.699739,lng:51.338097}),e.value.lat||(e.value.lat=35.699739),e.value.lng||(e.value.lng=51.338097)),!0===e.loading&&(e.disabled=!0),t.isMultiple?e.value?"array"!==n&&(e.value=[e.value]):e.value=[]:"tree"===e.type||"array"===n&&(e.value=e.value[0]),e}function Def(e){return({theme:[],"date-size":180,"tree-size":36,"range-size":72,"date-unit":"day"})[e]}function I(e,t,n){return _jsx(Icon,{path:e,size:t,...n})}function GetOptions(e){let{options:t,rootProps:n,types:i,properties:o={},level:r,isOpen:a,change:l,defaultOptionProps:s,toggle:u}=e,{deSelect:d}=n,c=[],p={},f=i.isDropdown&&i.hasOption&&!!n.onSwap;function h(e){return"select"===n.type&&i.isMultiple?-1!==n.value.indexOf(e):"radio"===n.type?i.isMultiple?-1!==n.value.indexOf(e):n.value===e:void 0}function m(e){for(let t in o){let n=o[t](e);e[t]=n}return e}function g(e){return i.isMultiple?-1!==n.value.indexOf(e):e===n.value}d&&"function"!=typeof d&&!0!==d&&(t=[d,...t]);for(let $=0;$<t.length;$++){let y=t[$],v={defaultOptionProps:s,index:$,active:!1,mainValue:n.value,level:r,isOpen:a,change:l?e=>{l(y,e)}:void 0},_=!!n.disabled||!!n.loading||!!GetOptionProps({props:n,option:y,key:"disabled",details:v}),b=GetOptionProps({props:n,option:y,key:"show",details:v});if(!1===b)continue;let x=GetOptionProps({props:n,option:y,key:"value",details:v}),C=g(x),k=GetOptionProps({props:n,option:y,key:"text",details:v});v.active=C,v.toggle=u?()=>u(x):void 0;let N=GetOptionProps({props:n,option:y,key:"attrs",def:{},details:v}),w=h(x),P=GetOptionProps({props:n,option:y,key:"checked",def:w,details:v}),T={active:C,object:y,show:b,loading:n.loading,attrs:N,text:k,value:x,disabled:_,draggable:f,checkIcon:GetOptionProps({props:n,option:y,key:"checkIcon",details:v})||n.checkIcon,checked:P,toggleIcon:GetOptionProps({props:n,option:y,def:!0,key:"toggleIcon",details:v}),before:GetOptionProps({props:n,option:y,key:"before",details:v}),after:GetOptionProps({props:n,option:y,key:"after",details:v}),justify:GetOptionProps({props:n,option:y,key:"justify",details:v}),subtext:GetOptionProps({props:n,option:y,key:"subtext",details:v}),onClick:GetOptionProps({props:n,option:y,key:"onClick",preventFunction:!0,details:v}),className:GetOptionProps({props:n,option:y,key:"className",details:v}),style:GetOptionProps({props:n,option:y,key:"style",details:v}),tagAttrs:GetOptionProps({props:n,option:y,key:"tagAttrs",details:v}),tagBefore:GetOptionProps({props:n,option:y,key:"tagBefore",details:v}),close:GetOptionProps({props:n,option:y,key:"close",def:!i.isMultiple,details:v}),tagAfter:GetOptionProps({props:n,option:y,key:"tagAfter",details:v}),index:$,details:v},D=m(T);c.push(D),p["a"+D.value]=D}return{optionsList:c,optionsDic:p}}function GetOptionProps(p){let{props,option,key,def,preventFunction,details,defaultOptionProps={}}=p,optionResult="function"!=typeof option[key]||preventFunction?option[key]:option[key](option,details);if(void 0!==optionResult)return optionResult;let prop=(props.option||{})[key];if("string"==typeof(prop=void 0===prop?defaultOptionProps[key]:prop))try{let value;return eval("value = "+prop),value}catch{}if("function"==typeof prop&&!preventFunction){let res=prop(option,details);return void 0===res?def:res}return void 0!==prop?prop:def}function getTimeByUnit(e,t){let{value:n={},jalali:i,unit:o={year:!0,month:!0,day:!0}}=e;function r(){let e=new AIODate().getToday(i);return{year:e[0],month:e[1],day:e[2],hour:e[3],minute:e[4],second:e[5]}}let a=r(),l={},s;for(s in o)if(!0===o[s]){let u=n[s],d={year:1e3,month:1,day:1,hour:0,minute:0,second:0}[s],c={year:3e3,month:12,day:31,hour:23,minute:59,second:59}[s];(void 0!==u&&"number"!=typeof u||u<d||u>c)&&alert(`aio input error => in type time value.${s} should be an number between ${d} and ${c}`);let p=void 0===u||t?a[s]:u;l[s]=p}return l}function getTimeText(e){let t=getTimeByUnit(e);if(!t)return"string"==typeof e.placeholder?e.placeholder:"string"==typeof e.text?e.text:"";if(e.pattern)return new AIODate().getDateByPattern(t,e.pattern);if(void 0!==e.text)return e.text;let n=[],i=[];void 0!==t.year&&i.push(Get2Digit(t.year)),void 0!==t.month&&i.push(Get2Digit(t.month)),void 0!==t.day&&i.push(Get2Digit(t.day)),i.length&&n.push(i.join("/"));let o=[];return void 0!==t.hour&&o.push(Get2Digit(t.hour)),void 0!==t.minute&&o.push(Get2Digit(t.minute)),void 0!==t.second&&o.push(Get2Digit(t.second)),o.length&&n.push(o.join(":")),n.join(" ")}